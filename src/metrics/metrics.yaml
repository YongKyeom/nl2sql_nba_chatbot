metrics:
  - name: triple_double
    aliases:
      - "트리플더블"
      - "트리플 더블"
      - "트리블더블"  # 오타감안
      - "트리블 더블"  # 오타감안
      - "트리더"
      - "3더블"
      - "triple double"
      - "triple-double"
      - "TD"
    description_ko: "팀 경기 합계 기준으로 득점/리바운드/어시스트/스틸/블록 중 3개 이상 항목이 10 이상인 경기 횟수 지표다. 데이터가 팀 합계만 제공되므로 팀 단위로 계산한다."
    formula_ko: "한 경기에서 (pts, reb, ast, stl, blk) 중 10 이상인 항목 개수 >= 3"
    required_tables: ["game"]
    required_columns: ["game_id", "game_date", "team_abbreviation_home", "team_abbreviation_away", "pts_home", "reb_home", "ast_home", "stl_home", "blk_home", "pts_away", "reb_away", "ast_away", "stl_away", "blk_away"]
    sql_template: |
      WITH team_games AS (
        SELECT game_id, game_date, team_abbreviation_home AS team_abbreviation,
               pts_home AS pts, reb_home AS reb, ast_home AS ast, stl_home AS stl, blk_home AS blk
        FROM game
        UNION ALL
        SELECT game_id, game_date, team_abbreviation_away AS team_abbreviation,
               pts_away AS pts, reb_away AS reb, ast_away AS ast, stl_away AS stl, blk_away AS blk
        FROM game
      ),
      flags AS (
        SELECT team_abbreviation,
               (CASE WHEN pts >= 10 THEN 1 ELSE 0 END
                + CASE WHEN reb >= 10 THEN 1 ELSE 0 END
                + CASE WHEN ast >= 10 THEN 1 ELSE 0 END
                + CASE WHEN stl >= 10 THEN 1 ELSE 0 END
                + CASE WHEN blk >= 10 THEN 1 ELSE 0 END) AS double_count
        FROM team_games
      )
      SELECT team_abbreviation, SUM(CASE WHEN double_count >= 3 THEN 1 ELSE 0 END) AS triple_double_games
      FROM flags
      GROUP BY team_abbreviation
      ORDER BY triple_double_games DESC
      LIMIT {limit};
    examples:
      - question: "트리플더블 경기 수 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: double_double
    aliases:
      - "더블더블"
      - "더블 더블"
      - "2더블"
      - "double double"
      - "double-double"
      - "DD"
    description_ko: "팀 경기 합계 기준으로 득점/리바운드/어시스트/스틸/블록 중 2개 이상 항목이 10 이상인 경기 횟수 지표다. 팀 단위 데이터에 맞춰 계산한다."
    formula_ko: "한 경기에서 (pts, reb, ast, stl, blk) 중 10 이상인 항목 개수 >= 2"
    required_tables: ["game"]
    required_columns: ["game_id", "game_date", "team_abbreviation_home", "team_abbreviation_away", "pts_home", "reb_home", "ast_home", "stl_home", "blk_home", "pts_away", "reb_away", "ast_away", "stl_away", "blk_away"]
    sql_template: |
      WITH team_games AS (
        SELECT game_id, game_date, team_abbreviation_home AS team_abbreviation,
               pts_home AS pts, reb_home AS reb, ast_home AS ast, stl_home AS stl, blk_home AS blk
        FROM game
        UNION ALL
        SELECT game_id, game_date, team_abbreviation_away AS team_abbreviation,
               pts_away AS pts, reb_away AS reb, ast_away AS ast, stl_away AS stl, blk_away AS blk
        FROM game
      ),
      flags AS (
        SELECT team_abbreviation,
               (CASE WHEN pts >= 10 THEN 1 ELSE 0 END
                + CASE WHEN reb >= 10 THEN 1 ELSE 0 END
                + CASE WHEN ast >= 10 THEN 1 ELSE 0 END
                + CASE WHEN stl >= 10 THEN 1 ELSE 0 END
                + CASE WHEN blk >= 10 THEN 1 ELSE 0 END) AS double_count
        FROM team_games
      )
      SELECT team_abbreviation, SUM(CASE WHEN double_count >= 2 THEN 1 ELSE 0 END) AS double_double_games
      FROM flags
      GROUP BY team_abbreviation
      ORDER BY double_double_games DESC
      LIMIT {limit};
    examples:
      - question: "더블더블 경기 수 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: ts_pct
    aliases:
      - "TS%"
      - "TS"
      - "ts%"
      - "true shooting"
      - "true shooting%"
      - "트루슈팅"
      - "트루 슈팅"
      - "트루슈팅%"
    description_ko: "팀 경기 합계 기준의 트루 슈팅 비율이다. 2점/3점/자유투 효율을 하나의 비율로 요약한다."
    formula_ko: "TS% = PTS / (2 * (FGA + 0.44 * FTA))"
    required_tables: ["game"]
    required_columns: ["team_abbreviation_home", "team_abbreviation_away", "pts_home", "pts_away", "fga_home", "fga_away", "fta_home", "fta_away"]
    sql_template: |
      WITH team_games AS (
        SELECT team_abbreviation_home AS team_abbreviation, pts_home AS pts, fga_home AS fga, fta_home AS fta
        FROM game
        UNION ALL
        SELECT team_abbreviation_away AS team_abbreviation, pts_away AS pts, fga_away AS fga, fta_away AS fta
        FROM game
      )
      SELECT team_abbreviation,
             AVG(pts / (2.0 * (fga + 0.44 * fta))) AS ts_pct
      FROM team_games
      WHERE fga > 0
      GROUP BY team_abbreviation
      ORDER BY ts_pct DESC
      LIMIT {limit};
    examples:
      - question: "팀 TS% 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 5
      min_minutes: null

  - name: efg_pct
    aliases:
      - "eFG%"
      - "eFG"
      - "efg%"
      - "effective fg"
      - "effective fg%"
      - "유효 야투"
      - "유효 야투율"
      - "유효 야투률"
      - "이펙티브 필드골"
    description_ko: "팀 경기 합계 기준의 유효 야투율이다. 3점 슛 가치를 가중치로 반영한다."
    formula_ko: "eFG% = (FGM + 0.5 * FG3M) / FGA"
    required_tables: ["game"]
    required_columns: ["team_abbreviation_home", "team_abbreviation_away", "fgm_home", "fgm_away", "fg3m_home", "fg3m_away", "fga_home", "fga_away"]
    sql_template: |
      WITH team_games AS (
        SELECT team_abbreviation_home AS team_abbreviation, fgm_home AS fgm, fg3m_home AS fg3m, fga_home AS fga
        FROM game
        UNION ALL
        SELECT team_abbreviation_away AS team_abbreviation, fgm_away AS fgm, fg3m_away AS fg3m, fga_away AS fga
        FROM game
      )
      SELECT team_abbreviation,
             AVG((fgm + 0.5 * fg3m) / fga) AS efg_pct
      FROM team_games
      WHERE fga > 0
      GROUP BY team_abbreviation
      ORDER BY efg_pct DESC
      LIMIT {limit};
    examples:
      - question: "팀 eFG% 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 5
      min_minutes: null

  - name: win_pct
    aliases:
      - "승률"
      - "승률%"
      - "승률 순위"
      - "팀 승률"
      - "win percentage"
      - "win pct"
      - "win%"
    description_ko: "시즌 기준 팀 승률이다. 승수와 패수를 기준으로 계산한다."
    formula_ko: "WIN% = W / (W + L)"
    required_tables: ["game"]
    required_columns: ["season_id", "season_type", "team_abbreviation_home", "team_name_home", "wl_home", "team_abbreviation_away", "team_name_away", "wl_away"]
    sql_template: |
      WITH team_games AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, wl_home AS wl
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season' {team_filter_home}
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, wl_away AS wl
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season' {team_filter_away}
      )
      SELECT team_name,
             team_abbreviation,
             '{season_year}' AS season_year,
             SUM(CASE WHEN wl = 'W' THEN 1 ELSE 0 END) AS w,
             SUM(CASE WHEN wl = 'L' THEN 1 ELSE 0 END) AS l,
             ROUND(1.0 * SUM(CASE WHEN wl = 'W' THEN 1 ELSE 0 END) / COUNT(*), 3) AS pct
      FROM team_games
      GROUP BY team_abbreviation, team_name
      ORDER BY pct DESC
      LIMIT {limit};
    examples:
      - question: "2022-23 시즌 팀 승률 상위 10팀 보여줘"
        params:
          season_id: "22022"
          season_year: "2022-23"
          limit: 10
    cut_rules:
      min_games: 10
      min_minutes: null

  - name: team_win_pct_by_season
    aliases:
      - "시즌 성적"
      - "시즌별 성적"
      - "시즌별 승률"
      - "시즌별 성적 비교"
      - "시즌별 성적 비교분석"
      - "시즌별 성적 분석"
      - "시즌별 승률 비교"
      - "season by season"
      - "season-by-season"
      - "seasonal record"
      - "season comparison"
      - "team season record"
    description_ko: "특정 팀의 시즌별 승률/승패를 비교한다."
    formula_ko: "시즌별 W/L 및 WIN% 집계"
    required_tables: ["game"]
    required_columns: ["season_id", "season_type", "team_abbreviation_home", "team_name_home", "wl_home", "team_abbreviation_away", "team_name_away", "wl_away"]
    sql_template: |
      WITH team_games AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, wl_home AS wl
        FROM game
        WHERE season_type = 'Regular Season'
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, wl_away AS wl
        FROM game
        WHERE season_type = 'Regular Season'
      ),
      filtered AS (
        SELECT season_id, team_abbreviation, team_name, wl
        FROM team_games
        WHERE team_abbreviation = '{team_abbreviation}'
      )
      SELECT team_name,
             team_abbreviation,
             printf('%d-%02d', CAST(SUBSTR(season_id, 2, 4) AS INT), (CAST(SUBSTR(season_id, 2, 4) AS INT) + 1) % 100) AS season_year,
             SUM(CASE WHEN wl = 'W' THEN 1 ELSE 0 END) AS w,
             SUM(CASE WHEN wl = 'L' THEN 1 ELSE 0 END) AS l,
             ROUND(1.0 * SUM(CASE WHEN wl = 'W' THEN 1 ELSE 0 END) / COUNT(*), 3) AS pct
      FROM filtered
      GROUP BY season_id, team_abbreviation, team_name
      ORDER BY season_id DESC
      LIMIT {limit};
    examples:
      - question: "GSW 시즌별 승률/성적을 비교해줘"
        params:
          team_abbreviation: "GSW"
          limit: 200
    cut_rules:
      min_games: 10
      min_minutes: null

  - name: point_diff
    aliases:
      - "득실차"
      - "득실 차"
      - "평균 득실차"
      - "평균 득실 차"
      - "점수차"
      - "점수 차"
      - "point differential"
      - "point diff"
      - "score diff"
    description_ko: "팀 경기 합계 기준 평균 득실차다. 득점에서 실점을 뺀 값을 경기 단위로 평균낸다."
    formula_ko: "AVG(PTS_FOR - PTS_AGAINST)"
    required_tables: ["game"]
    required_columns: ["season_id", "team_abbreviation_home", "team_abbreviation_away", "pts_home", "pts_away"]
    sql_template: |
      WITH team_games AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation, pts_home AS pts_for, pts_away AS pts_against
        FROM game
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation, pts_away AS pts_for, pts_home AS pts_against
        FROM game
      )
      SELECT team_abbreviation, AVG(pts_for - pts_against) AS avg_point_diff
      FROM team_games
      WHERE season_id = '{season_id}'
      GROUP BY team_abbreviation
      ORDER BY avg_point_diff DESC
      LIMIT {limit};
    examples:
      - question: "2022-23 시즌 평균 득실차 상위 10팀 보여줘"
        params:
          season_id: "22022"
          limit: 10
    cut_rules:
      min_games: 5
      min_minutes: null

  - name: last_n_games
    aliases:
      - "최근 N경기"
      - "최근 경기"
      - "최근 경기 결과"
      - "최근 5경기"
      - "최근 10경기"
      - "last n games"
      - "last games"
      - "recent games"
    description_ko: "특정 팀의 최근 N경기 결과와 득실 데이터를 조회한다. 멀티턴에서 N 값만 변경해 재사용하기 좋다."
    formula_ko: "최근 날짜 기준으로 N건 정렬"
    required_tables: ["game"]
    required_columns: ["game_date", "team_abbreviation_home", "team_abbreviation_away", "matchup_home", "matchup_away", "wl_home", "wl_away", "pts_home", "pts_away"]
    sql_template: |
      WITH team_games AS (
        SELECT game_date, team_abbreviation_home AS team_abbreviation, matchup_home AS matchup, wl_home AS wl,
               pts_home AS pts, pts_away AS opp_pts
        FROM game
        UNION ALL
        SELECT game_date, team_abbreviation_away AS team_abbreviation, matchup_away AS matchup, wl_away AS wl,
               pts_away AS pts, pts_home AS opp_pts
        FROM game
      )
      SELECT *
      FROM team_games
      WHERE team_abbreviation = '{team_abbreviation}'
      ORDER BY game_date DESC
      LIMIT {n};
    examples:
      - question: "GSW 최근 5경기 결과 보여줘"
        params:
          team_abbreviation: "GSW"
          n: 5
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: back_to_back
    aliases:
      - "백투백"
      - "백투백 일정"
      - "백투백 경기"
      - "연전"
      - "back-to-back"
      - "back to back"
      - "b2b"
    description_ko: "팀이 연속된 날짜에 경기를 치른 횟수다. 일정 강도를 파악할 때 사용한다."
    formula_ko: "이전 경기 날짜와의 차이가 1일인 경기 수"
    required_tables: ["game"]
    required_columns: ["game_date", "team_id_home", "team_id_away", "team_abbreviation_home", "team_abbreviation_away"]
    sql_template: |
      WITH team_games AS (
        SELECT game_date, team_id_home AS team_id, team_abbreviation_home AS team_abbreviation
        FROM game
        UNION ALL
        SELECT game_date, team_id_away AS team_id, team_abbreviation_away AS team_abbreviation
        FROM game
      ),
      ordered AS (
        SELECT team_id, team_abbreviation, date(game_date) AS game_date,
               LAG(date(game_date)) OVER (PARTITION BY team_id ORDER BY date(game_date)) AS prev_date
        FROM team_games
      )
      SELECT team_abbreviation, COUNT(*) AS back_to_back_games
      FROM ordered
      WHERE prev_date IS NOT NULL AND julianday(game_date) - julianday(prev_date) = 1
      GROUP BY team_abbreviation
      ORDER BY back_to_back_games DESC
      LIMIT {limit};
    examples:
      - question: "백투백 경기 수 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: top_scorers
    aliases:
      - "상위 득점"
      - "득점 상위"
      - "득점 TOP"
      - "득점 순위"
      - "득점 리더"
      - "득점 랭킹"
      - "points leaders"
      - "top scorers"
      - "팀 득점 상위"
      - "상위 팀 득점"
      - "상위 득점 팀"
      - "상위 득점팀"
    description_ko: "시즌 팀 평균 득점(PTS/경기) 상위 팀 목록이다. 선수 데이터가 없으므로 팀 단위로 제공한다."
    formula_ko: "팀 평균 득점 PTS/경기 기준 내림차순"
    required_tables: ["game"]
    required_columns: ["season_id", "season_type", "team_abbreviation_home", "team_name_home", "pts_home", "team_abbreviation_away", "team_name_away", "pts_away"]
    sql_template: |
      WITH team_games AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, pts_home AS pts
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season'
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, pts_away AS pts
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season'
      )
      SELECT team_name,
             team_abbreviation,
             '{season_year}' AS season_year,
             AVG(pts) AS pts_pg
      FROM team_games
      GROUP BY team_abbreviation, team_name
      ORDER BY pts_pg DESC
      LIMIT {limit};
    examples:
      - question: "2022-23 시즌 팀 득점 상위 10팀 보여줘"
        params:
          season_id: "22022"
          season_year: "2022-23"
          limit: 10
    cut_rules:
      min_games: 10
      min_minutes: null

  - name: top_rebounders
    aliases:
      - "상위 리바운드"
      - "리바운드 상위"
      - "리바운드 TOP"
      - "리바운드 순위"
      - "리바운드 리더"
      - "reb leaders"
      - "top rebounders"
      - "팀 리바운드 상위"
      - "상위 팀 리바운드"
    description_ko: "시즌 팀 평균 리바운드 상위 팀 목록이다."
    formula_ko: "팀 평균 리바운드 REB/경기 기준 내림차순"
    required_tables: ["game"]
    required_columns: ["season_id", "season_type", "team_abbreviation_home", "team_name_home", "reb_home", "team_abbreviation_away", "team_name_away", "reb_away"]
    sql_template: |
      WITH team_games AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, reb_home AS reb
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season'
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, reb_away AS reb
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season'
      )
      SELECT team_name,
             team_abbreviation,
             '{season_year}' AS season_year,
             AVG(reb) AS reb_pg
      FROM team_games
      GROUP BY team_abbreviation, team_name
      ORDER BY reb_pg DESC
      LIMIT {limit};
    examples:
      - question: "2022-23 시즌 팀 리바운드 상위 10팀 보여줘"
        params:
          season_id: "22022"
          season_year: "2022-23"
          limit: 10
    cut_rules:
      min_games: 10
      min_minutes: null

  - name: top_assisters
    aliases:
      - "상위 어시스트"
      - "어시스트 상위"
      - "어시스트 TOP"
      - "어시스트 순위"
      - "어시스트 리더"
      - "assist leaders"
      - "top assisters"
      - "팀 어시스트 상위"
      - "상위 팀 어시스트"
    description_ko: "시즌 팀 평균 어시스트 상위 팀 목록이다."
    formula_ko: "팀 평균 어시스트 AST/경기 기준 내림차순"
    required_tables: ["game"]
    required_columns: ["season_id", "season_type", "team_abbreviation_home", "team_name_home", "ast_home", "team_abbreviation_away", "team_name_away", "ast_away"]
    sql_template: |
      WITH team_games AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, ast_home AS ast
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season'
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, ast_away AS ast
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season'
      )
      SELECT team_name,
             team_abbreviation,
             '{season_year}' AS season_year,
             AVG(ast) AS ast_pg
      FROM team_games
      GROUP BY team_abbreviation, team_name
      ORDER BY ast_pg DESC
      LIMIT {limit};
    examples:
      - question: "2022-23 시즌 팀 어시스트 상위 10팀 보여줘"
        params:
          season_id: "22022"
          season_year: "2022-23"
          limit: 10
    cut_rules:
      min_games: 10
      min_minutes: null

  - name: home_away_split
    aliases:
      - "홈원정 분할"
      - "홈 원정 분할"
      - "홈원정 스플릿"
      - "home away split"
      - "home/away split"
      - "홈 원정 비교"
      - "홈원정 비교"
      - "홈/원정 비교"
    description_ko: "팀의 홈/원정 평균 득점, 리바운드, 어시스트를 비교한다."
    formula_ko: "홈/원정 구분 후 평균값 계산"
    required_tables: ["game"]
    required_columns: ["team_abbreviation_home", "team_abbreviation_away", "pts_home", "pts_away", "reb_home", "reb_away", "ast_home", "ast_away"]
    sql_template: |
      WITH team_games AS (
        SELECT team_abbreviation_home AS team_abbreviation, 'home' AS location, pts_home AS pts, reb_home AS reb, ast_home AS ast
        FROM game
        UNION ALL
        SELECT team_abbreviation_away AS team_abbreviation, 'away' AS location, pts_away AS pts, reb_away AS reb, ast_away AS ast
        FROM game
      )
      SELECT team_abbreviation, location, AVG(pts) AS avg_pts, AVG(reb) AS avg_reb, AVG(ast) AS avg_ast
      FROM team_games
      GROUP BY team_abbreviation, location
      ORDER BY team_abbreviation, location
      LIMIT {limit};
    examples:
      - question: "팀별 홈/원정 평균 득점·리바운드·어시스트 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 5
      min_minutes: null

  - name: streak
    aliases:
      - "연승"
      - "연패"
      - "연승/연패"
      - "승패 흐름"
      - "W/L 흐름"
      - "최근 흐름"
      - "streak"
    description_ko: "팀의 최근 N경기 승패 시퀀스를 문자열로 요약한다. W/L 흐름을 빠르게 파악할 때 사용한다."
    formula_ko: "최근 N경기 결과를 날짜 역순으로 나열"
    required_tables: ["game"]
    required_columns: ["game_date", "team_abbreviation_home", "team_abbreviation_away", "wl_home", "wl_away"]
    sql_template: |
      WITH team_games AS (
        SELECT game_date, team_abbreviation_home AS team_abbreviation, wl_home AS wl
        FROM game
        UNION ALL
        SELECT game_date, team_abbreviation_away AS team_abbreviation, wl_away AS wl
        FROM game
      ),
      ordered AS (
        SELECT team_abbreviation, wl
        FROM team_games
        WHERE team_abbreviation = '{team_abbreviation}'
        ORDER BY game_date DESC
        LIMIT {n}
      )
      SELECT team_abbreviation, GROUP_CONCAT(wl, '') AS recent_streak
      FROM ordered;
    examples:
      - question: "LAL 최근 10경기 승패 흐름 보여줘"
        params:
          team_abbreviation: "LAL"
          n: 10
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: close_games
    aliases:
      - "접전"
      - "접전 경기"
      - "박빙"
      - "클로즈 게임"
      - "close game"
      - "close games"
      - "5점차"
      - "5점 이하"
    description_ko: "점수차가 작은 경기 목록이다. 기본 임계값은 5점 이하로 본다."
    formula_ko: "ABS(PTS_HOME - PTS_AWAY) <= threshold"
    required_tables: ["game"]
    required_columns: ["game_id", "game_date", "team_abbreviation_home", "team_abbreviation_away", "pts_home", "pts_away"]
    sql_template: |
      SELECT game_id, game_date, team_abbreviation_home, team_abbreviation_away,
             pts_home, pts_away, ABS(pts_home - pts_away) AS point_diff
      FROM game
      WHERE ABS(pts_home - pts_away) <= {threshold}
      ORDER BY game_date DESC
      LIMIT {limit};
    examples:
      - question: "5점차 이내 접전 경기 20개 보여줘"
        params:
          threshold: 5
          limit: 20
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: blowout_games
    aliases:
      - "대승"
      - "대패"
      - "블로우아웃"
      - "blowout"
      - "20점차"
      - "20점 이상"
      - "대승 경기"
    description_ko: "점수차가 큰 경기 목록이다. 기본 임계값은 20점 이상으로 본다."
    formula_ko: "ABS(PTS_HOME - PTS_AWAY) >= threshold"
    required_tables: ["game"]
    required_columns: ["game_id", "game_date", "team_abbreviation_home", "team_abbreviation_away", "pts_home", "pts_away"]
    sql_template: |
      SELECT game_id, game_date, team_abbreviation_home, team_abbreviation_away,
             pts_home, pts_away, ABS(pts_home - pts_away) AS point_diff
      FROM game
      WHERE ABS(pts_home - pts_away) >= {threshold}
      ORDER BY game_date DESC
      LIMIT {limit};
    examples:
      - question: "20점차 이상 블로우아웃 경기 20개 보여줘"
        params:
          threshold: 20
          limit: 20
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: attendance_top_games
    aliases:
      - "관중"
      - "관중수"
      - "관중 상위"
      - "관중 순위"
      - "attendance"
      - "attendance top"
      - "관중 많은 경기"
    description_ko: "관중 수가 많은 경기 목록이다. 흥행 지표로 활용한다."
    formula_ko: "ATTENDANCE 내림차순 정렬"
    required_tables: ["game_info", "game"]
    required_columns: ["game_id", "game_date", "attendance", "team_abbreviation_home", "team_abbreviation_away"]
    sql_template: |
      SELECT gi.game_date, g.team_abbreviation_home, g.team_abbreviation_away, gi.attendance
      FROM game_info AS gi
      JOIN game AS g ON g.game_id = gi.game_id
      ORDER BY gi.attendance DESC
      LIMIT {limit};
    examples:
      - question: "관중 수 상위 10경기 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: attendance_top_teams
    aliases:
      - "관중 수 상위 팀"
      - "관중수 상위 팀"
      - "관중 상위 팀"
      - "관중 많은 팀"
      - "관중수 많은 팀"
      - "attendance teams"
      - "attendance by team"
    description_ko: "홈 경기 기준 평균 관중수가 높은 팀 목록이다."
    formula_ko: "AVG(attendance) 기준 내림차순"
    required_tables: ["game_info", "game"]
    required_columns: ["game_id", "attendance", "season_id", "team_abbreviation_home", "team_name_home"]
    sql_template: |
      WITH team_attendance AS (
        SELECT g.season_id,
               g.team_abbreviation_home AS team_abbreviation,
               g.team_name_home AS team_name,
               gi.attendance AS attendance
        FROM game_info AS gi
        JOIN game AS g ON g.game_id = gi.game_id
        WHERE gi.attendance IS NOT NULL
      )
      SELECT team_name,
             team_abbreviation,
             ROUND(AVG(attendance), 0) AS avg_attendance,
             SUM(attendance) AS total_attendance,
             COUNT(*) AS game_count
      FROM team_attendance
      WHERE season_id = '{season_id}'
      GROUP BY team_abbreviation, team_name
      ORDER BY avg_attendance DESC
      LIMIT {limit};
    examples:
      - question: "2022-23 시즌 관중 상위 10팀 보여줘"
        params:
          season_id: "22022"
          limit: 10
    cut_rules:
      min_games: 1
      min_minutes: null

  - name: points_in_paint
    aliases:
      - "페인트존 득점"
      - "페인트 득점"
      - "페인트존"
      - "points in paint"
      - "PIP"
    description_ko: "팀의 페인트존 득점 평균이다. 인사이드 지배력을 판단할 때 쓴다."
    formula_ko: "PTS_PAINT 평균"
    required_tables: ["other_stats"]
    required_columns: ["team_abbreviation_home", "team_abbreviation_away", "pts_paint_home", "pts_paint_away"]
    sql_template: |
      WITH team_stats AS (
        SELECT team_abbreviation_home AS team_abbreviation, pts_paint_home AS pts_paint
        FROM other_stats
        UNION ALL
        SELECT team_abbreviation_away AS team_abbreviation, pts_paint_away AS pts_paint
        FROM other_stats
      )
      SELECT team_abbreviation, AVG(pts_paint) AS avg_pts_paint
      FROM team_stats
      GROUP BY team_abbreviation
      ORDER BY avg_pts_paint DESC
      LIMIT {limit};
    examples:
      - question: "페인트존 득점 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 5
      min_minutes: null

  - name: fast_break_points
    aliases:
      - "속공 득점"
      - "속공 포인트"
      - "전환 득점"
      - "fast break"
      - "fast break points"
      - "FB points"
    description_ko: "팀의 속공 득점 평균이다. 전환 공격 효율을 본다."
    formula_ko: "PTS_FB 평균"
    required_tables: ["other_stats"]
    required_columns: ["team_abbreviation_home", "team_abbreviation_away", "pts_fb_home", "pts_fb_away"]
    sql_template: |
      WITH team_stats AS (
        SELECT team_abbreviation_home AS team_abbreviation, pts_fb_home AS pts_fb
        FROM other_stats
        UNION ALL
        SELECT team_abbreviation_away AS team_abbreviation, pts_fb_away AS pts_fb
        FROM other_stats
      )
      SELECT team_abbreviation, AVG(pts_fb) AS avg_fast_break_pts
      FROM team_stats
      GROUP BY team_abbreviation
      ORDER BY avg_fast_break_pts DESC
      LIMIT {limit};
    examples:
      - question: "속공 득점 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 5
      min_minutes: null

  - name: second_chance_points
    aliases:
      - "세컨찬스"
      - "세컨 찬스"
      - "세컨드찬스"
      - "세컨드 찬스"
      - "세컨드찬스 득점"
      - "second chance"
      - "second chance points"
      - "2nd chance"
    description_ko: "팀의 세컨드 찬스 득점 평균이다. 공격 리바운드 후 득점 기여를 본다."
    formula_ko: "PTS_2ND_CHANCE 평균"
    required_tables: ["other_stats"]
    required_columns: ["team_abbreviation_home", "team_abbreviation_away", "pts_2nd_chance_home", "pts_2nd_chance_away"]
    sql_template: |
      WITH team_stats AS (
        SELECT team_abbreviation_home AS team_abbreviation, pts_2nd_chance_home AS pts_2nd_chance
        FROM other_stats
        UNION ALL
        SELECT team_abbreviation_away AS team_abbreviation, pts_2nd_chance_away AS pts_2nd_chance
        FROM other_stats
      )
      SELECT team_abbreviation, AVG(pts_2nd_chance) AS avg_second_chance_pts
      FROM team_stats
      GROUP BY team_abbreviation
      ORDER BY avg_second_chance_pts DESC
      LIMIT {limit};
    examples:
      - question: "세컨찬스 득점 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 5
      min_minutes: null

  - name: turnover_points
    aliases:
      - "턴오버 득점"
      - "턴오버 후 득점"
      - "points off turnovers"
      - "포인트 오프 턴오버"
      - "POT"
    description_ko: "팀의 턴오버 이후 득점 평균이다. 상대 실수를 얼마나 득점으로 전환하는지 본다."
    formula_ko: "PTS_OFF_TO 평균"
    required_tables: ["other_stats"]
    required_columns: ["team_abbreviation_home", "team_abbreviation_away", "pts_off_to_home", "pts_off_to_away"]
    sql_template: |
      WITH team_stats AS (
        SELECT team_abbreviation_home AS team_abbreviation, pts_off_to_home AS pts_off_to
        FROM other_stats
        UNION ALL
        SELECT team_abbreviation_away AS team_abbreviation, pts_off_to_away AS pts_off_to
        FROM other_stats
      )
      SELECT team_abbreviation, AVG(pts_off_to) AS avg_turnover_pts
      FROM team_stats
      GROUP BY team_abbreviation
      ORDER BY avg_turnover_pts DESC
      LIMIT {limit};
    examples:
      - question: "턴오버 득점 상위 10팀 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: 5
      min_minutes: null

  - name: draft_first_pick_avg_tenure
    aliases:
      - "드래프트 1픽 평균 커리어"
      - "드래프트 1픽"
      - "드래프트 1순위"
      - "전체 1픽"
      - "1픽 평균 커리어"
      - "1픽 평균 경력"
      - "overall 1 pick"
      - "1st pick"
      - "top pick avg tenure"
    description_ko: "드래프트 전체 1픽 선수들의 평균 NBA 경력(시즌 수)을 계산한다. 시즌 경험치가 있는 선수만 집계한다."
    formula_ko: "AVG(season_exp)"
    required_tables: ["draft_history", "common_player_info"]
    required_columns: ["person_id", "overall_pick", "season_exp"]
    sql_template: |
      SELECT AVG(CAST(cpi.season_exp AS REAL)) AS avg_season_exp
      FROM draft_history AS dh
      JOIN common_player_info AS cpi ON cpi.person_id = dh.person_id
      WHERE dh.overall_pick = 1
      LIMIT {limit};
    examples:
      - question: "드래프트 1픽 평균 커리어(시즌 수) 알려줘"
        params:
          limit: 1
    cut_rules:
      min_games: null
      min_minutes: null

  - name: draft_picks_by_year
    aliases:
      - "연도별 드래프트"
      - "드래프트 연도"
      - "드래프트 클래스"
      - "드래프트 픽 리스트"
      - "드래프트 전체 픽"
      - "draft class"
      - "draft by year"
      - "draft picks"
    description_ko: "특정 시즌 드래프트 전체 픽 목록을 조회한다."
    formula_ko: "season 기준 정렬"
    required_tables: ["draft_history"]
    required_columns: ["season", "overall_pick", "player_name", "team_name", "team_abbreviation", "round_number", "round_pick"]
    sql_template: |
      SELECT season, overall_pick, player_name, team_name, team_abbreviation, round_number, round_pick
      FROM draft_history
      WHERE season = '{season}'
      ORDER BY overall_pick
      LIMIT {limit};
    examples:
      - question: "2018 드래프트 전체 픽 보여줘"
        params:
          season: "2018"
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null

  - name: draft_team_first_round_picks
    aliases:
      - "팀 1라운드 지명"
      - "1라 지명"
      - "1라 픽"
      - "1라운드 픽"
      - "1라운드 지명"
      - "first round picks"
      - "1st round picks"
      - "팀 1라 픽"
    description_ko: "특정 팀이 1라운드에서 지명한 선수 목록을 조회한다."
    formula_ko: "team_abbreviation + round_number=1"
    required_tables: ["draft_history"]
    required_columns: ["season", "overall_pick", "player_name", "team_abbreviation", "round_number"]
    sql_template: |
      SELECT season, overall_pick, player_name, team_abbreviation
      FROM draft_history
      WHERE team_abbreviation = '{team_abbreviation}' AND round_number = 1
      ORDER BY season DESC, overall_pick
      LIMIT {limit};
    examples:
      - question: "LAL 1라운드 지명 목록 보여줘"
        params:
          team_abbreviation: "LAL"
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null

  - name: player_profile
    aliases:
      - "선수 프로필"
      - "선수 정보"
      - "선수 소개"
      - "선수 신체정보"
      - "player profile"
      - "player bio"
      - "선수 바이오"
    description_ko: "선수의 기본 프로필(포지션, 신장, 출신 등)을 조회한다."
    formula_ko: "이름 부분 일치 검색"
    required_tables: ["common_player_info"]
    required_columns: ["display_first_last", "position", "height", "weight", "country", "school", "season_exp", "from_year", "to_year", "team_name", "team_abbreviation"]
    sql_template: |
      SELECT display_first_last, position, height, weight, country, school, season_exp, from_year, to_year, team_name, team_abbreviation
      FROM common_player_info
      WHERE display_first_last LIKE '%{player_name}%'
      LIMIT {limit};
    examples:
      - question: "Stephen Curry 선수 프로필 보여줘"
        params:
          player_name: "Stephen Curry"
          limit: 5
    cut_rules:
      min_games: null
      min_minutes: null

  - name: player_career_length
    aliases:
      - "선수 커리어 길이"
      - "커리어 길이"
      - "커리어 기간"
      - "NBA 경력"
      - "시즌 수"
      - "career length"
      - "career span"
    description_ko: "선수의 NBA 경력(시즌 수)을 조회한다."
    formula_ko: "season_exp 또는 (to_year - from_year + 1)"
    required_tables: ["common_player_info"]
    required_columns: ["display_first_last", "season_exp", "from_year", "to_year"]
    sql_template: |
      SELECT display_first_last, season_exp, from_year, to_year
      FROM common_player_info
      WHERE display_first_last LIKE '%{player_name}%'
      LIMIT {limit};
    examples:
      - question: "LeBron James 커리어 길이 알려줘"
        params:
          player_name: "LeBron James"
          limit: 5
    cut_rules:
      min_games: null
      min_minutes: null

  - name: player_combine_stats
    aliases:
      - "컴바인"
      - "컴바인 기록"
      - "신체 측정"
      - "측정치"
      - "combine stats"
      - "combine"
      - "draft combine"
    description_ko: "드래프트 컴바인 기록을 조회한다."
    formula_ko: "player_name 부분 일치 검색"
    required_tables: ["draft_combine_stats"]
    required_columns: ["player_name", "position", "height_wo_shoes", "height_w_shoes", "weight", "wingspan", "standing_reach", "body_fat_pct", "lane_agility_time", "three_quarter_sprint", "bench_press"]
    sql_template: |
      SELECT player_name, position, height_wo_shoes, height_w_shoes, weight, wingspan, standing_reach, body_fat_pct,
             lane_agility_time, three_quarter_sprint, bench_press
      FROM draft_combine_stats
      WHERE player_name LIKE '%{player_name}%'
      ORDER BY season DESC
      LIMIT {limit};
    examples:
      - question: "Zion Williamson 컴바인 기록 보여줘"
        params:
          player_name: "Zion Williamson"
          limit: 5
    cut_rules:
      min_games: null
      min_minutes: null

  - name: active_roster_by_team
    aliases:
      - "로스터"
      - "팀 로스터"
      - "현재 로스터"
      - "선수 명단"
      - "로스터 현황"
      - "active roster"
      - "active players"
    description_ko: "특정 팀의 현재 로스터(Active)를 조회한다."
    formula_ko: "rosterstatus='Active'"
    required_tables: ["common_player_info"]
    required_columns: ["display_first_last", "position", "jersey", "rosterstatus", "team_abbreviation"]
    sql_template: |
      SELECT display_first_last, position, jersey, rosterstatus
      FROM common_player_info
      WHERE team_abbreviation = '{team_abbreviation}' AND rosterstatus = 'Active'
      ORDER BY display_first_last
      LIMIT {limit};
    examples:
      - question: "GSW 현재 로스터 보여줘"
        params:
          team_abbreviation: "GSW"
          limit: 50
    cut_rules:
      min_games: null
      min_minutes: null

  - name: player_country_distribution
    aliases:
      - "국가별 선수"
      - "국적 분포"
      - "선수 국적"
      - "country distribution"
      - "country count"
      - "국가별 분포"
    description_ko: "국가별 선수 분포를 집계한다."
    formula_ko: "COUNT(*) BY country"
    required_tables: ["common_player_info"]
    required_columns: ["country"]
    sql_template: |
      SELECT country, COUNT(*) AS player_count
      FROM common_player_info
      GROUP BY country
      ORDER BY player_count DESC
      LIMIT {limit};
    examples:
      - question: "국가별 선수 수 상위 10개 보여줘"
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null

  - name: team_head_to_head
    aliases:
      - "팀 맞대결"
      - "맞대결"
      - "상대 전적"
      - "팀간 전적"
      - "vs 기록"
      - "head to head"
      - "H2H"
    description_ko: "두 팀의 맞대결 경기 목록을 조회한다. 홈/원정 구분을 포함한다."
    formula_ko: "home/away 조합 필터"
    required_tables: ["game"]
    required_columns: ["game_id", "game_date", "team_abbreviation_home", "team_abbreviation_away", "pts_home", "pts_away", "wl_home", "wl_away"]
    sql_template: |
      SELECT game_id, game_date, team_abbreviation_home, team_abbreviation_away, pts_home, pts_away, wl_home, wl_away
      FROM game
      WHERE (team_abbreviation_home = '{team_a}' AND team_abbreviation_away = '{team_b}')
         OR (team_abbreviation_home = '{team_b}' AND team_abbreviation_away = '{team_a}')
      ORDER BY game_date DESC
      LIMIT {limit};
    examples:
      - question: "GSW와 LAL 맞대결 경기 20개 보여줘"
        params:
          team_a: "GSW"
          team_b: "LAL"
          limit: 20
    cut_rules:
      min_games: null
      min_minutes: null

  - name: inactive_players_by_team
    aliases:
      - "결장 선수"
      - "결장 명단"
      - "결장자"
      - "inactive players"
      - "inactive list"
    description_ko: "특정 팀의 결장 선수 목록을 조회한다."
    formula_ko: "team_abbreviation 기준 필터"
    required_tables: ["inactive_players"]
    required_columns: ["game_id", "first_name", "last_name", "team_abbreviation", "jersey_num"]
    sql_template: |
      SELECT game_id, first_name, last_name, team_abbreviation, jersey_num
      FROM inactive_players
      WHERE team_abbreviation = '{team_abbreviation}'
      ORDER BY game_id DESC
      LIMIT {limit};
    examples:
      - question: "LAL 결장 선수 명단 최근 20건 보여줘"
        params:
          team_abbreviation: "LAL"
          limit: 20
    cut_rules:
      min_games: null
      min_minutes: null

  - name: player_head_to_head_events
    aliases:
      - "선수 맞대결 이벤트"
      - "맞대결 이벤트"
      - "플레이바이플레이 맞대결"
      - "h2h 이벤트"
      - "player head to head"
    description_ko: "플레이바이플레이에서 두 선수가 동시에 관여한 이벤트 빈도를 집계한다. 실제 경기 스탯 맞대결이 아니라 이벤트 동시 관여 빈도임에 주의한다."
    formula_ko: "player1_name/2_name 필터 후 COUNT"
    required_tables: ["play_by_play"]
    required_columns: ["player1_name", "player2_name", "player3_name", "eventnum", "game_id"]
    sql_template: |
      SELECT player1_name, player2_name, COUNT(*) AS event_count
      FROM play_by_play
      WHERE (player1_name LIKE '%{player_a}%' AND player2_name LIKE '%{player_b}%')
         OR (player1_name LIKE '%{player_b}%' AND player2_name LIKE '%{player_a}%')
      GROUP BY player1_name, player2_name
      ORDER BY event_count DESC
      LIMIT {limit};
    examples:
      - question: "Stephen Curry와 LeBron James가 함께 나온 이벤트 상위 20개 보여줘"
        params:
          player_a: "Stephen Curry"
          player_b: "LeBron James"
          limit: 20
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_001
    aliases:
      - NBA 전체 팀 목록과 약어/도시/주(state)를 표로 보여줘
    description_ko: 이 메트릭은 'NBA 전체 팀 목록과 약어/도시/주(state)를 표로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - full_name
      - abbreviation
      - city
      - state
    sql_template: SELECT full_name, abbreviation, city, state FROM team LIMIT {limit}
    examples:
      - question: NBA 전체 팀 목록과 약어/도시/주(state)를 표로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_002
    aliases:
      - '팀 약어로 팀 풀네임/닉네임/연고지를 찾아줘 (예: GSW)'
    description_ko: '이 메트릭은 ''팀 약어로 팀 풀네임/닉네임/연고지를 찾아줘 (예: GSW)'' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - full_name
      - abbreviation
      - nickname
      - city
      - state
    sql_template: SELECT full_name, nickname, city, state FROM team WHERE abbreviation = '{team_abbreviation}' LIMIT {limit}
    examples:
      - question: '팀 약어로 팀 풀네임/닉네임/연고지를 찾아줘 (예: GSW)'
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_003
    aliases:
      - 팀별 창단 연도(year_founded)와 연고지(city/state)를 정리해줘
    description_ko: 이 메트릭은 '팀별 창단 연도(year_founded)와 연고지(city/state)를 정리해줘' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: year_founded · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - full_name
      - city
      - state
      - year_founded
    sql_template: SELECT full_name, year_founded, city, state FROM team ORDER BY year_founded LIMIT {limit}
    examples:
      - question: 팀별 창단 연도(year_founded)와 연고지(city/state)를 정리해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_004
    aliases:
      - 팀별 홈 아레나 이름과 수용인원(arenacapacity)을 표로 보여줘
    description_ko: 이 메트릭은 '팀별 홈 아레나 이름과 수용인원(arenacapacity)을 표로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team, team_details 테이블을 활용해 조인 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - team
      - team_details
    required_columns:
      - id
      - full_name
      - team_id
      - arena
      - arenacapacity
    sql_template: SELECT t.full_name, td.arena, td.arenacapacity FROM team t JOIN team_details td ON t.id = td.team_id LIMIT {limit}
    examples:
      - question: 팀별 홈 아레나 이름과 수용인원(arenacapacity)을 표로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_005
    aliases:
      - 아레나 수용인원 TOP 10 팀과 (도시/아레나/수용인원) 같이 보여줘
    description_ko: 이 메트릭은 '아레나 수용인원 TOP 10 팀과 (도시/아레나/수용인원) 같이 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team, team_details 테이블을 활용해 조인 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: td.arenacapacity DESC · 제한: LIMIT {limit}'
    required_tables:
      - team
      - team_details
    required_columns:
      - id
      - full_name
      - city
      - team_id
      - arena
      - arenacapacity
    sql_template: SELECT t.full_name, td.city, td.arena, td.arenacapacity FROM team t JOIN team_details td ON t.id = td.team_id ORDER BY td.arenacapacity
      DESC LIMIT {limit};
    examples:
      - question: 아레나 수용인원 TOP 10 팀과 (도시/아레나/수용인원) 같이 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_006
    aliases:
      - 아레나 수용인원 하위 10 팀도 같이 비교해줘
    description_ko: 이 메트릭은 '아레나 수용인원 하위 10 팀도 같이 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 team, team_details 테이블을 활용해 조인 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: td.arenacapacity ASC · 제한: LIMIT {limit}'
    required_tables:
      - team
      - team_details
    required_columns:
      - id
      - full_name
      - city
      - team_id
      - arena
      - arenacapacity
    sql_template: SELECT t.full_name, td.city, td.arena, td.arenacapacity FROM team t JOIN team_details td ON t.id = td.team_id ORDER BY td.arenacapacity
      ASC LIMIT {limit};
    examples:
      - question: 아레나 수용인원 하위 10 팀도 같이 비교해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_007
    aliases:
      - 특정 팀의 구단주(owner), GM(generalmanager), 감독(headcoach) 정보를 알려줘
    description_ko: 이 메트릭은 '특정 팀의 구단주(owner), GM(generalmanager), 감독(headcoach) 정보를 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 team, team_details 테이블을 활용해 조인 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - team
      - team_details
    required_columns:
      - id
      - full_name
      - abbreviation
      - team_id
      - owner
      - generalmanager
      - headcoach
    sql_template: SELECT t.full_name, td.owner, td.generalmanager, td.headcoach FROM team t JOIN team_details td ON t.id = td.team_id WHERE t.abbreviation
      = '{team_abbreviation}' LIMIT {limit}
    examples:
      - question: 특정 팀의 구단주(owner), GM(generalmanager), 감독(headcoach) 정보를 알려줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_008
    aliases:
      - 감독(Head Coach) 목록을 팀별로 정리해줘
    description_ko: 이 메트릭은 '감독(Head Coach) 목록을 팀별로 정리해줘' 요청을 처리하기 위한 조회 정의다. 주로 team, team_details 테이블을 활용해 조인 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: t.full_name · 제한: LIMIT {limit}'
    required_tables:
      - team
      - team_details
    required_columns:
      - id
      - full_name
      - team_id
      - headcoach
    sql_template: SELECT t.full_name, td.headcoach FROM team t JOIN team_details td ON t.id = td.team_id ORDER BY t.full_name LIMIT {limit}
    examples:
      - question: 감독(Head Coach) 목록을 팀별로 정리해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_009
    aliases:
      - G-리그 제휴팀(dleagueaffiliation) 정보를 팀별로 보여줘
    description_ko: 이 메트릭은 'G-리그 제휴팀(dleagueaffiliation) 정보를 팀별로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team_details 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - team_details
    required_columns:
      - abbreviation
      - dleagueaffiliation
    sql_template: SELECT abbreviation, dleagueaffiliation FROM team_details WHERE dleagueaffiliation IS NOT NULL LIMIT {limit}
    examples:
      - question: G-리그 제휴팀(dleagueaffiliation) 정보를 팀별로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_010
    aliases:
      - 구단 SNS(트위터/인스타/페이스북) 링크를 팀별로 정리해줘
    description_ko: 이 메트릭은 '구단 SNS(트위터/인스타/페이스북) 링크를 팀별로 정리해줘' 요청을 처리하기 위한 조회 정의다. 주로 team_details 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - team_details
    required_columns:
      - abbreviation
      - facebook
      - instagram
      - twitter
    sql_template: SELECT abbreviation, facebook, instagram, twitter FROM team_details LIMIT {limit}
    examples:
      - question: 구단 SNS(트위터/인스타/페이스북) 링크를 팀별로 정리해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_011
    aliases:
      - '특정 주(state)에 속한 팀이 어떤 팀인지 알려줘 (예: California)'
    description_ko: '이 메트릭은 ''특정 주(state)에 속한 팀이 어떤 팀인지 알려줘 (예: California)'' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - full_name
      - abbreviation
      - city
      - state
    sql_template: SELECT full_name, abbreviation, city, state FROM team WHERE state = '{state}' LIMIT {limit}
    examples:
      - question: '특정 주(state)에 속한 팀이 어떤 팀인지 알려줘 (예: California)'
        params:
          limit: 200
          state: California
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_012
    aliases:
      - 도시(city)별로 팀이 몇 개 있는지 보여줘
    description_ko: 이 메트릭은 '도시(city)별로 팀이 몇 개 있는지 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: team_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - city
    sql_template: SELECT city, COUNT(*) AS team_count FROM team GROUP BY city ORDER BY team_count DESC LIMIT {limit}
    examples:
      - question: 도시(city)별로 팀이 몇 개 있는지 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_013
    aliases:
      - “LA”, “NY”처럼 같은 도시를 공유하는 팀들을 묶어서 보여줘
    description_ko: 이 메트릭은 '“LA”, “NY”처럼 같은 도시를 공유하는 팀들을 묶어서 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - abbreviation
      - city
    sql_template: WITH city_counts AS (SELECT city, COUNT(*) AS cnt FROM team GROUP BY city) SELECT t.city, GROUP_CONCAT(t.abbreviation) AS teams
      FROM team t JOIN city_counts c ON t.city = c.city WHERE c.cnt > 1 GROUP BY t.city LIMIT {limit}
    examples:
      - question: “LA”, “NY”처럼 같은 도시를 공유하는 팀들을 묶어서 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_history_001
    aliases:
      - 특정 팀의 연고지/닉네임 변경 이력을 연도별로 보여줘 (`team_history`)
    description_ko: 이 메트릭은 '특정 팀의 연고지/닉네임 변경 이력을 연도별로 보여줘 (`team_history`)' 요청을 처리하기 위한 조회 정의다. 주로 team_history, team 테이블을 활용해 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: year_founded · 제한: LIMIT {limit}'
    required_tables:
      - team_history
      - team
    required_columns:
      - team_id
      - city
      - nickname
      - year_founded
      - year_active_till
      - id
      - abbreviation
    sql_template: SELECT city, nickname, year_founded, year_active_till FROM team_history WHERE team_id = (SELECT id FROM team WHERE abbreviation
      = '{team_abbreviation}' LIMIT 1) ORDER BY year_founded LIMIT {limit}
    examples:
      - question: 특정 팀의 연고지/닉네임 변경 이력을 연도별로 보여줘 (`team_history`)
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_014
    aliases:
      - 팀별로 과거 연고지 변경이 있었는지(변경 횟수) 순위로 보여줘
    description_ko: 이 메트릭은 '팀별로 과거 연고지 변경이 있었는지(변경 횟수) 순위로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team, team_history 테이블을 활용해 조인 / 그룹 집계 / 카운트 / 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: change_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - team
      - team_history
    required_columns:
      - id
      - abbreviation
      - year_founded
      - team_id
    sql_template: SELECT t.abbreviation, COUNT(th.year_founded) - 1 AS change_count FROM team t LEFT JOIN team_history th ON t.id = th.team_id GROUP
      BY t.id ORDER BY change_count DESC LIMIT {limit}
    examples:
      - question: 팀별로 과거 연고지 변경이 있었는지(변경 횟수) 순위로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_015
    aliases:
      - 가장 오래된 팀(창단이 가장 빠른 팀) TOP 10을 보여줘
    description_ko: 이 메트릭은 '가장 오래된 팀(창단이 가장 빠른 팀) TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라
      결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: year_founded ASC · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - full_name
      - abbreviation
      - city
      - state
      - year_founded
    sql_template: SELECT full_name, abbreviation, city, state, year_founded FROM team ORDER BY year_founded ASC LIMIT {limit};
    examples:
      - question: 가장 오래된 팀(창단이 가장 빠른 팀) TOP 10을 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_016
    aliases:
      - 가장 최근에 창단된 팀 TOP 10을 보여줘
    description_ko: 이 메트릭은 '가장 최근에 창단된 팀 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며,
      NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: year_founded DESC · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - full_name
      - abbreviation
      - city
      - state
      - year_founded
    sql_template: SELECT full_name, abbreviation, city, state, year_founded FROM team ORDER BY year_founded DESC LIMIT {limit}
    examples:
      - question: 가장 최근에 창단된 팀 TOP 10을 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_017
    aliases:
      - 특정 팀의 공식 약어/팀 코드/슬러그 같은 식별 정보를 정리해줘
    description_ko: 이 메트릭은 '특정 팀의 공식 약어/팀 코드/슬러그 같은 식별 정보를 정리해줘' 요청을 처리하기 위한 조회 정의다. 주로 team 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - team
    required_columns:
      - full_name
      - abbreviation
      - nickname
      - city
    sql_template: SELECT abbreviation, nickname, city FROM team WHERE full_name = '{team_name}' LIMIT {limit}
    examples:
      - question: 특정 팀의 공식 약어/팀 코드/슬러그 같은 식별 정보를 정리해줘
        params:
          limit: 200
          team_name: Golden State Warriors
    cut_rules:
      min_games: null
      min_minutes: null
  - name: team_018
    aliases:
      - (멀티스텝) 아레나 수용인원 상위 10팀의 홈 평균 관중/승률을 같이 비교해줘
    description_ko: 이 메트릭은 '(멀티스텝) 아레나 수용인원 상위 10팀의 홈 평균 관중/승률을 같이 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 team_details, game, game_info 테이블을 활용해 조인 / cte
      / 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: arenacapacity DESC · 제한: LIMIT {limit}'
    required_tables:
      - team_details
      - game
      - game_info
    required_columns:
      - team_id
      - abbreviation
      - arenacapacity
      - team_id_home
      - game_id
      - wl_home
      - attendance
    sql_template: |-
      WITH arena_top AS (SELECT team_id, abbreviation, arenacapacity FROM team_details ORDER BY arenacapacity DESC LIMIT 10),
      home_stats AS (
        SELECT g.team_id_home AS team_id, AVG(gi.attendance) AS avg_attendance, AVG(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS win_rate
        FROM game g
        JOIN game_info gi ON g.game_id = gi.game_id
        WHERE g.team_id_home IN (SELECT team_id FROM arena_top)
        GROUP BY g.team_id_home
      )
      SELECT a.abbreviation, a.arenacapacity, COALESCE(h.avg_attendance, 0) AS avg_attendance, COALESCE(h.win_rate, 0) AS win_rate
      FROM arena_top a
      LEFT JOIN home_stats h ON a.team_id = h.team_id
      ORDER BY a.arenacapacity DESC
      LIMIT {limit}
    examples:
      - question: (멀티스텝) 아레나 수용인원 상위 10팀의 홈 평균 관중/승률을 같이 비교해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: unsupported_001
    aliases:
      - (멀티스텝) 감독 교체가 잦았던 팀(데이터상)과 시즌 성적의 관계를 살펴봐줘
    description_ko: 이 메트릭은 '(멀티스텝) 감독 교체가 잦았던 팀(데이터상)과 시즌 성적의 관계를 살펴봐줘' 요청을 처리하기 위한 조회 정의다. 주로 테이블 미지정 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables: []
    required_columns: []
    sql_template: 'SELECT ''notice: 감독 교체 관련 데이터가 스키마에 존재하지 않아 분석이 불가능합니다.'' AS notice LIMIT {limit}'
    examples:
      - question: (멀티스텝) 감독 교체가 잦았던 팀(데이터상)과 시즌 성적의 관계를 살펴봐줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_001
    aliases:
      - 특정 시즌의 전체 경기 수(정규/플레이오프)를 알려줘
    description_ko: 이 메트릭은 '특정 시즌의 전체 경기 수(정규/플레이오프)를 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가
      달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
    sql_template: SELECT '{season_year}' AS season_year, COUNT(*) AS total_games FROM game WHERE season_id = '{season_id}' LIMIT {limit}
    examples:
      - question: 특정 시즌의 전체 경기 수(정규/플레이오프)를 알려줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_002
    aliases:
      - 특정 시즌의 날짜 범위(최초 경기일 ~ 최종 경기일)를 알려줘
    description_ko: 이 메트릭은 '특정 시즌의 날짜 범위(최초 경기일 ~ 최종 경기일)를 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - game_date
      - min
    sql_template: SELECT '{season_year}' AS season_year, MIN(game_date) AS first_game_date, MAX(game_date) AS last_game_date FROM game WHERE season_id
      = '{season_id}' LIMIT {limit}
    examples:
      - question: 특정 시즌의 날짜 범위(최초 경기일 ~ 최종 경기일)를 알려줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_003
    aliases:
      - 특정 날짜(YYYY-MM-DD)의 경기 목록(홈/원정, 스코어, 승패)을 보여줘
    description_ko: 이 메트릭은 '특정 날짜(YYYY-MM-DD)의 경기 목록(홈/원정, 스코어, 승패)을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - team_name_home
      - game_id
      - game_date
      - wl_home
      - pts_home
      - team_name_away
      - wl_away
      - pts_away
    sql_template: SELECT game_id, team_name_home AS home_team, pts_home AS home_score, team_name_away AS away_team, pts_away AS away_score, wl_home
      AS home_result, wl_away AS away_result FROM game WHERE game_date = '{game_date}' LIMIT {limit}
    examples:
      - question: 특정 날짜(YYYY-MM-DD)의 경기 목록(홈/원정, 스코어, 승패)을 보여줘
        params:
          game_date: '2022-10-18'
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_004
    aliases:
      - '특정 기간(예: 2023-12-01~2023-12-31)의 경기 목록을 보여줘'
    description_ko: '이 메트릭은 ''특정 기간(예: 2023-12-01~2023-12-31)의 경기 목록을 보여줘'' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: SELECT · 정렬: game_date · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - team_name_home
      - game_id
      - game_date
      - wl_home
      - pts_home
      - team_name_away
      - wl_away
      - pts_away
    sql_template: SELECT game_id, game_date, team_name_home AS home_team, pts_home AS home_score, team_name_away AS away_team, pts_away AS away_score,
      wl_home AS home_result, wl_away AS away_result FROM game WHERE game_date BETWEEN '{start_date}' AND '{end_date}' ORDER BY game_date LIMIT
      {limit}
    examples:
      - question: '특정 기간(예: 2023-12-01~2023-12-31)의 경기 목록을 보여줘'
        params:
          end_date: '2023-06-30'
          limit: 200
          start_date: '2022-10-01'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_005
    aliases:
      - 특정 팀의 시즌 경기 일정과 결과(홈/원정, 상대, 스코어, 승패)를 표로 보여줘
    description_ko: 이 메트릭은 '특정 팀의 시즌 경기 일정과 결과(홈/원정, 상대, 스코어, 승패)를 표로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: game_date · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_name_home
      - game_id
      - game_date
      - wl_home
      - pts_home
      - team_name_away
      - wl_away
      - pts_away
    sql_template: SELECT game_id, game_date, 'Home' AS location, team_name_away AS opponent, pts_home AS team_score, pts_away AS opponent_score,
      wl_home AS result FROM game WHERE season_id = '{season_id}' AND team_name_home = '{team_name}' UNION ALL SELECT game_id, game_date, 'Away'
      AS location, team_name_home AS opponent, pts_away AS team_score, pts_home AS opponent_score, wl_away AS result FROM game WHERE season_id =
      '{season_id}' AND team_name_away = '{team_name}' ORDER BY game_date LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌 경기 일정과 결과(홈/원정, 상대, 스코어, 승패)를 표로 보여줘
        params:
          limit: 200
          season_id: '22022'
          team_name: Golden State Warriors
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_006
    aliases:
      - 특정 팀의 시즌 홈 경기만 모아서 일정/결과를 보여줘
    description_ko: 이 메트릭은 '특정 팀의 시즌 홈 경기만 모아서 일정/결과를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가
      달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: game_date · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_name_home
      - game_id
      - game_date
      - wl_home
      - pts_home
      - team_name_away
      - pts_away
    sql_template: SELECT game_id, game_date, team_name_away AS opponent, pts_home AS team_score, pts_away AS opponent_score, wl_home AS result FROM
      game WHERE season_id = '{season_id}' AND team_name_home = '{team_name}' ORDER BY game_date LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌 홈 경기만 모아서 일정/결과를 보여줘
        params:
          limit: 200
          season_id: '22022'
          team_name: Golden State Warriors
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_007
    aliases:
      - 특정 팀의 시즌 원정 경기만 모아서 일정/결과를 보여줘
    description_ko: 이 메트릭은 '특정 팀의 시즌 원정 경기만 모아서 일정/결과를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가
      달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: game_date · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_name_home
      - game_id
      - game_date
      - pts_home
      - team_name_away
      - wl_away
      - pts_away
    sql_template: SELECT game_id, game_date, team_name_home AS opponent, pts_away AS team_score, pts_home AS opponent_score, wl_away AS result FROM
      game WHERE season_id = '{season_id}' AND team_name_away = '{team_name}' ORDER BY game_date LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌 원정 경기만 모아서 일정/결과를 보여줘
        params:
          limit: 200
          season_id: '22022'
          team_name: Golden State Warriors
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_008
    aliases:
      - 시즌별로 경기 수가 가장 많은 달/가장 적은 달을 알려줘 (월별 집계)
    description_ko: 이 메트릭은 '시즌별로 경기 수가 가장 많은 달/가장 적은 달을 알려줘 (월별 집계)' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - game_date
      - min
    sql_template: WITH monthly_counts AS ( SELECT season_id, STRFTIME('%Y-%m', game_date) AS year_month, COUNT(*) AS game_count FROM game GROUP
      BY season_id, year_month ), max_min AS ( SELECT season_id, MAX(game_count) AS max_games, MIN(game_count) AS min_games FROM monthly_counts
      GROUP BY season_id ) SELECT mc_max.season_id, mc_max.year_month AS month_most_games, mc_max.game_count AS most_games, mc_min.year_month AS
      month_least_games, mc_min.game_count AS least_games FROM max_min m JOIN monthly_counts mc_max ON m.season_id = mc_max.season_id AND m.max_games
      = mc_max.game_count JOIN monthly_counts mc_min ON m.season_id = mc_min.season_id AND m.min_games = mc_min.game_count WHERE m.season_id = '{season_id}'
      LIMIT {limit}
    examples:
      - question: 시즌별로 경기 수가 가장 많은 달/가장 적은 달을 알려줘 (월별 집계)
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_009
    aliases:
      - 특정 팀의 연속 홈경기/연속 원정경기 최장 기록을 시즌별로 알려줘
    description_ko: 이 메트릭은 '특정 팀의 연속 홈경기/연속 원정경기 최장 기록을 시즌별로 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: game_date) AS rn FROM game WHERE (team_abbreviation_home = ''{team_abbreviation}'' OR team_abbreviation_away
      = ''{team_abbreviation}'') ), home_streaks AS ( SELECT season_id, game_date, rn, is_home, rn - ROW_NUMBER() OVER (PARTITION BY season_id,
      is_home ORDER BY game_date) AS grp FROM ordered_games WHERE is_home = 1 ), away_streaks AS ( SELECT season_id, game_date, rn, is_away, rn
      - ROW_NUMBER() OVER (PARTITION BY season_id, is_away ORDER BY game_date) AS grp FROM ordered_games WHERE is_away = 1 ), home_max_streak AS
      ( SELECT season_id, COUNT(*) AS home_streak_length FROM home_streaks GROUP BY season_id, grp ), away_max_streak AS ( SELECT season_id, COUNT(*)
      AS away_streak_length FROM away_streaks GROUP BY season_id, grp ), home_max AS ( SELECT season_id, MAX(home_streak_length) AS max_home_streak
      FROM home_max_streak GROUP BY season_id ), away_max AS ( SELECT season_id, MAX(away_streak_length) AS max_away_streak FROM away_max_streak
      GROUP BY season_id ) SELECT COALESCE(h.season_id, a.season_id) AS season_id, ''{season_year}'' AS season_year, COALESCE(max_home_streak, 0)
      AS max_consecutive_home_games, COALESCE(max_away_streak, 0) AS max_consecutive_away_games FROM home_max h FULL OUTER JOIN away_max a ON h.season_id
      = a.season_id ORDER BY season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - game_date
      - team_abbreviation_away
    sql_template: |-
      WITH ordered_games AS (
        SELECT
          season_id,
          game_id,
          CASE WHEN team_abbreviation_home = '{team_abbreviation}' THEN 1 ELSE 0 END AS is_home,
          CASE WHEN team_abbreviation_away = '{team_abbreviation}' THEN 1 ELSE 0 END AS is_away,
          game_date,
          ROW_NUMBER() OVER (PARTITION BY season_id ORDER BY game_date) AS rn
        FROM game
        WHERE (team_abbreviation_home = '{team_abbreviation}' OR team_abbreviation_away = '{team_abbreviation}')
      ),
      home_streaks AS (
        SELECT
          season_id,
          game_date,
          rn,
          is_home,
          rn - ROW_NUMBER() OVER (PARTITION BY season_id, is_home ORDER BY game_date) AS grp
        FROM ordered_games
        WHERE is_home = 1
      ),
      away_streaks AS (
        SELECT
          season_id,
          game_date,
          rn,
          is_away,
          rn - ROW_NUMBER() OVER (PARTITION BY season_id, is_away ORDER BY game_date) AS grp
        FROM ordered_games
        WHERE is_away = 1
      ),
      home_max_streak AS (
        SELECT
          season_id,
          COUNT(*) AS home_streak_length
        FROM home_streaks
        GROUP BY season_id, grp
      ),
      away_max_streak AS (
        SELECT
          season_id,
          COUNT(*) AS away_streak_length
        FROM away_streaks
        GROUP BY season_id, grp
      ),
      home_max AS (
        SELECT season_id, MAX(home_streak_length) AS max_home_streak FROM home_max_streak GROUP BY season_id
      ),
      away_max AS (
        SELECT season_id, MAX(away_streak_length) AS max_away_streak FROM away_max_streak GROUP BY season_id
      )
      SELECT
        COALESCE(h.season_id, a.season_id) AS season_id,
        '{season_year}' AS season_year,
        COALESCE(max_home_streak, 0) AS max_consecutive_home_games,
        COALESCE(max_away_streak, 0) AS max_consecutive_away_games
      FROM home_max h
      FULL OUTER JOIN away_max a ON h.season_id = a.season_id
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 연속 홈경기/연속 원정경기 최장 기록을 시즌별로 알려줘
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_010
    aliases:
      - 특정 시즌에서 가장 많은 “연속 승리/연속 패배”가 나온 경기 구간을 찾아줘 (팀별)
    description_ko: 이 메트릭은 '특정 시즌에서 가장 많은 “연속 승리/연속 패배”가 나온 경기 구간을 찾아줘 (팀별)' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 카운트 / 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: game_id) AS rn, ROW_NUMBER() OVER (PARTITION BY team, result ORDER BY game_id) AS rn2 FROM team_games WHERE
      result IN (''W'', ''L'') ), streak_groups AS ( SELECT season_id, team, result, COUNT(*) AS streak_length FROM win_loss_streaks GROUP BY season_id,
      team, result, rn - rn2 ), max_streaks AS ( SELECT season_id, team, result, MAX(streak_length) AS max_streak FROM streak_groups GROUP BY season_id,
      team, result ) SELECT season_id, team, result AS streak_type, max_streak FROM max_streaks WHERE season_id = ''{season_id}'' ORDER BY team,
      max_streak DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - wl_home
      - team_abbreviation_away
      - wl_away
    sql_template: |-
      WITH team_games AS (
        SELECT
          season_id,
          game_id,
          CASE WHEN team_abbreviation_home = team THEN wl_home
               WHEN team_abbreviation_away = team THEN wl_away
               ELSE NULL END AS result,
          team
        FROM game,
        (SELECT '{team_abbreviation}' AS team) t
        WHERE season_id = '{season_id}'
          AND (team_abbreviation_home = '{team_abbreviation}' OR team_abbreviation_away = '{team_abbreviation}')
      ),
      win_loss_streaks AS (
        SELECT
          season_id,
          team,
          result,
          game_id,
          ROW_NUMBER() OVER (PARTITION BY team ORDER BY game_id) AS rn,
          ROW_NUMBER() OVER (PARTITION BY team, result ORDER BY game_id) AS rn2
        FROM team_games
        WHERE result IN ('W', 'L')
      ),
      streak_groups AS (
        SELECT
          season_id,
          team,
          result,
          COUNT(*) AS streak_length
        FROM win_loss_streaks
        GROUP BY season_id, team, result, rn - rn2
      ),
      max_streaks AS (
        SELECT
          season_id,
          team,
          result,
          MAX(streak_length) AS max_streak
        FROM streak_groups
        GROUP BY season_id, team, result
      )
      SELECT
        season_id,
        team,
        result AS streak_type,
        max_streak
      FROM max_streaks
      WHERE season_id = '{season_id}'
      ORDER BY team, max_streak DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 가장 많은 “연속 승리/연속 패배”가 나온 경기 구간을 찾아줘 (팀별)
        params:
          limit: 200
          season_id: '22022'
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_011
    aliases:
      - 특정 시즌에서 ‘중립경기(있다면)’가 있는지 확인해줘
    description_ko: 이 메트릭은 '특정 시즌에서 ‘중립경기(있다면)’가 있는지 확인해줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에
      따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - matchup_home
      - team_abbreviation_away
    sql_template: |-
      SELECT
        CASE WHEN EXISTS (
          SELECT 1 FROM game WHERE season_id = '{season_id}' AND matchup_home LIKE '%vs.%' AND team_abbreviation_home != team_abbreviation_away
        ) THEN '중립경기 있음' ELSE '중립경기 없음' END AS notice
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 ‘중립경기(있다면)’가 있는지 확인해줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_012
    aliases:
      - 특정 시즌에서 가장 늦게 시작하는 경기(game_time)가 많았던 팀을 알려줘
    description_ko: 이 메트릭은 '특정 시즌에서 가장 늦게 시작하는 경기(game_time)가 많았던 팀을 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: count_max_time DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_info
    required_columns:
      - season_id
      - game_id
      - team_abbreviation_home
      - team_abbreviation_away
      - game_time
    sql_template: |-
      WITH game_times AS (
        SELECT
          g.season_id,
          g.team_abbreviation_home AS team_abbreviation,
          gi.game_time AS game_time_raw,
          CASE
            WHEN gi.game_time IS NULL OR gi.game_time = '' OR INSTR(gi.game_time, ':') = 0 THEN NULL
            ELSE CAST(SUBSTR(gi.game_time, 1, INSTR(gi.game_time, ':') - 1) AS INT) * 60
              + CAST(SUBSTR(gi.game_time, INSTR(gi.game_time, ':') + 1) AS INT)
          END AS game_time_value
        FROM game g
        JOIN game_info gi ON gi.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        UNION ALL
        SELECT
          g.season_id,
          g.team_abbreviation_away AS team_abbreviation,
          gi.game_time AS game_time_raw,
          CASE
            WHEN gi.game_time IS NULL OR gi.game_time = '' OR INSTR(gi.game_time, ':') = 0 THEN NULL
            ELSE CAST(SUBSTR(gi.game_time, 1, INSTR(gi.game_time, ':') - 1) AS INT) * 60
              + CAST(SUBSTR(gi.game_time, INSTR(gi.game_time, ':') + 1) AS INT)
          END AS game_time_value
        FROM game g
        JOIN game_info gi ON gi.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
      ),
      max_time AS (
        SELECT MAX(game_time_value) AS max_game_time_value
        FROM game_times
        WHERE game_time_value IS NOT NULL
      )
      SELECT
        gt.team_abbreviation AS team,
        COUNT(*) AS games_started_at_latest_time
      FROM game_times gt
      JOIN max_time mt ON gt.game_time_value = mt.max_game_time_value
      GROUP BY gt.team_abbreviation
      ORDER BY games_started_at_latest_time DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 가장 늦게 시작하는 경기(game_time)가 많았던 팀을 알려줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_013
    aliases:
      - 경기 시간이 가장 긴 게임(game_time 기준)이 어떤 경기인지 알려줘
    description_ko: 이 메트릭은 '경기 시간이 가장 긴 게임(game_time 기준)이 어떤 경기인지 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - game_info
    required_columns:
      - game_id
      - game_date
      - game_time
    sql_template: |-
      WITH parsed AS (
        SELECT
          game_id,
          game_date,
          game_time,
          CASE
            WHEN game_time IS NULL OR game_time = '' OR INSTR(game_time, ':') = 0 THEN NULL
            ELSE CAST(SUBSTR(game_time, 1, INSTR(game_time, ':') - 1) AS INT) * 60
              + CAST(SUBSTR(game_time, INSTR(game_time, ':') + 1) AS INT)
          END AS game_time_value
        FROM game_info
      )
      SELECT
        game_id,
        game_date,
        game_time
      FROM parsed
      WHERE game_time_value = (SELECT MAX(game_time_value) FROM parsed WHERE game_time_value IS NOT NULL)
      LIMIT {limit}
    examples:
      - question: 경기 시간이 가장 긴 게임(game_time 기준)이 어떤 경기인지 알려줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_014
    aliases:
      - 전국 중계(natl_tv_broadcaster_abbreviation)가 잡힌 경기 수를 시즌별로 보여줘
    description_ko: 이 메트릭은 '전국 중계(natl_tv_broadcaster_abbreviation)가 잡힌 경기 수를 시즌별로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, game_summary 테이블을 활용해 카운트 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_summary
    required_columns:
      - season_id
      - game_id
      - natl_tv_broadcaster_abbreviation
    sql_template: |-
      SELECT
        season_id,
        '{season_year}' AS season_year,
        COUNT(DISTINCT g.game_id) AS num_games_with_natl_tv
      FROM game g
      JOIN game_summary gs ON g.game_id = gs.game_id
      WHERE gs.natl_tv_broadcaster_abbreviation IS NOT NULL AND gs.natl_tv_broadcaster_abbreviation != ''
      GROUP BY season_id
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 전국 중계(natl_tv_broadcaster_abbreviation)가 잡힌 경기 수를 시즌별로 보여줘
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_summary_001
    aliases:
      - 중계사(natl_tv_broadcaster_abbreviation)별 경기 수 TOP 10을 보여줘
    description_ko: 이 메트릭은 '중계사(natl_tv_broadcaster_abbreviation)별 경기 수 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game_summary 테이블을 활용해 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: num_games DESC · 제한: LIMIT {limit}'
    required_tables:
      - game_summary
    required_columns:
      - game_id
      - natl_tv_broadcaster_abbreviation
    sql_template: |-
      SELECT
        natl_tv_broadcaster_abbreviation AS broadcaster,
        COUNT(DISTINCT game_id) AS num_games
      FROM game_summary
      WHERE natl_tv_broadcaster_abbreviation IS NOT NULL AND natl_tv_broadcaster_abbreviation != ''
      GROUP BY natl_tv_broadcaster_abbreviation
      ORDER BY num_games DESC
      LIMIT {limit};
    examples:
      - question: 중계사(natl_tv_broadcaster_abbreviation)별 경기 수 TOP 10을 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_015
    aliases:
      - '특정 중계사(예: ESPN)에서 중계한 경기 목록을 시즌별로 보여줘'
    description_ko: '이 메트릭은 ''특정 중계사(예: ESPN)에서 중계한 경기 목록을 시즌별로 보여줘'' 요청을 처리하기 위한 조회 정의다. 주로 game, game_summary 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: SELECT · 정렬: g.season_id, g.game_date · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_summary
    required_columns:
      - season_id
      - game_id
      - game_date
      - natl_tv_broadcaster_abbreviation
    sql_template: |-
      SELECT
        g.season_id,
        '{season_year}' AS season_year,
        g.game_id,
        g.game_date
      FROM game g
      JOIN game_summary gs ON g.game_id = gs.game_id
      WHERE gs.natl_tv_broadcaster_abbreviation = '{broadcaster}'
      ORDER BY g.season_id, g.game_date
      LIMIT {limit}
    examples:
      - question: '특정 중계사(예: ESPN)에서 중계한 경기 목록을 시즌별로 보여줘'
        params:
          broadcaster: ESPN
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_016
    aliases:
      - 특정 시즌 ‘플레이오프’ 팀 승률 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 ‘플레이오프’ 팀 승률 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에
      따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: win_rate DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - wl_home
      - season_type
    sql_template: |-
      SELECT season_id, team_abbreviation_home AS team_abbreviation, ROUND(AVG(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END), 3) AS win_rate
      FROM game
      WHERE season_id = '{season_id}' AND season_type = 'Playoffs'
      GROUP BY team_abbreviation_home
      ORDER BY win_rate DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 ‘플레이오프’ 팀 승률 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_017
    aliases:
      - 특정 팀의 정규시즌 vs 플레이오프 승률을 시즌별로 비교해줘
    description_ko: 이 메트릭은 '특정 팀의 정규시즌 vs 플레이오프 승률을 시즌별로 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id, season_type · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - wl_home
      - team_abbreviation_away
      - wl_away
      - season_type
    sql_template: |-
      WITH home_stats AS (
        SELECT season_id, season_type, team_abbreviation_home AS team_abbreviation,
               AVG(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) AS win_rate
        FROM game
        WHERE team_abbreviation_home = '{team_abbreviation}'
        GROUP BY season_id, season_type, team_abbreviation_home
      ),
      away_stats AS (
        SELECT season_id, season_type, team_abbreviation_away AS team_abbreviation,
               AVG(CASE WHEN wl_away = 'W' THEN 1 ELSE 0 END) AS win_rate
        FROM game
        WHERE team_abbreviation_away = '{team_abbreviation}'
        GROUP BY season_id, season_type, team_abbreviation_away
      ),
      combined AS (
        SELECT season_id, season_type, team_abbreviation,
               AVG(win_rate) AS win_rate
        FROM (
          SELECT * FROM home_stats
          UNION ALL
          SELECT * FROM away_stats
        )
        GROUP BY season_id, season_type, team_abbreviation
      )
      SELECT season_id, season_type, win_rate
      FROM combined
      WHERE team_abbreviation = '{team_abbreviation}'
      ORDER BY season_id, season_type
      LIMIT {limit}
    examples:
      - question: 특정 팀의 정규시즌 vs 플레이오프 승률을 시즌별로 비교해줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_018
    aliases:
      - 특정 시즌 팀별 평균 득점/평균 실점/득실차를 표로 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 평균 득점/평균 실점/득실차를 표로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: point_diff DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - pts_home
      - team_abbreviation_away
      - pts_away
    sql_template: |-
      WITH team_stats AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation,
               AVG(pts_home) AS avg_points_scored,
               AVG(pts_away) AS avg_points_allowed
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_home
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation,
               AVG(pts_away) AS avg_points_scored,
               AVG(pts_home) AS avg_points_allowed
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_away
      ),
      agg AS (
        SELECT season_id, team_abbreviation,
               AVG(avg_points_scored) AS avg_points_scored,
               AVG(avg_points_allowed) AS avg_points_allowed
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT season_id, team_abbreviation, avg_points_scored, avg_points_allowed, (avg_points_scored - avg_points_allowed) AS point_diff
      FROM agg
      ORDER BY point_diff DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 평균 득점/평균 실점/득실차를 표로 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_019
    aliases:
      - 특정 팀의 시즌별 평균 득점/평균 실점 추이를 비교해줘 (차트용)
    description_ko: 이 메트릭은 '특정 팀의 시즌별 평균 득점/평균 실점 추이를 비교해줘 (차트용)' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - pts_home
      - team_abbreviation_away
      - pts_away
    sql_template: |-
      WITH home_stats AS (
        SELECT season_id, AVG(pts_home) AS avg_points_scored, AVG(pts_away) AS avg_points_allowed
        FROM game
        WHERE team_abbreviation_home = '{team_abbreviation}'
        GROUP BY season_id
      ),
      away_stats AS (
        SELECT season_id, AVG(pts_away) AS avg_points_scored, AVG(pts_home) AS avg_points_allowed
        FROM game
        WHERE team_abbreviation_away = '{team_abbreviation}'
        GROUP BY season_id
      ),
      combined AS (
        SELECT season_id, AVG(avg_points_scored) AS avg_points_scored, AVG(avg_points_allowed) AS avg_points_allowed
        FROM (
          SELECT * FROM home_stats
          UNION ALL
          SELECT * FROM away_stats
        )
        GROUP BY season_id
      )
      SELECT season_id, avg_points_scored, avg_points_allowed
      FROM combined
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 평균 득점/평균 실점 추이를 비교해줘 (차트용)
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_020
    aliases:
      - 특정 시즌 팀별 3점 시도/성공/3점 성공률 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 3점 시도/성공/3점 성공률 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: fg3_pct DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - fg3m_home
      - fg3a_home
      - team_abbreviation_away
      - fg3m_away
      - fg3a_away
    sql_template: |-
      WITH team_stats AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation,
               SUM(fg3a_home) AS total_3pa,
               SUM(fg3m_home) AS total_3pm
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_home
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation,
               SUM(fg3a_away) AS total_3pa,
               SUM(fg3m_away) AS total_3pm
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_away
      ),
      agg AS (
        SELECT season_id, team_abbreviation,
               SUM(total_3pa) AS total_3pa,
               SUM(total_3pm) AS total_3pm,
               CASE WHEN SUM(total_3pa) > 0 THEN ROUND(CAST(SUM(total_3pm) AS FLOAT) / SUM(total_3pa), 3) ELSE 0 END AS fg3_pct
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT season_id, team_abbreviation, total_3pa, total_3pm, fg3_pct
      FROM agg
      ORDER BY fg3_pct DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 3점 시도/성공/3점 성공률 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_021
    aliases:
      - 특정 시즌 팀별 자유투 시도/성공/자유투 성공률 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 자유투 시도/성공/자유투 성공률 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: ft_pct DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - ftm_home
      - fta_home
      - team_abbreviation_away
      - ftm_away
      - fta_away
    sql_template: |-
      WITH team_stats AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation,
               SUM(fta_home) AS total_fta,
               SUM(ftm_home) AS total_ftm
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_home
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation,
               SUM(fta_away) AS total_fta,
               SUM(ftm_away) AS total_ftm
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_away
      ),
      agg AS (
        SELECT season_id, team_abbreviation,
               SUM(total_fta) AS total_fta,
               SUM(total_ftm) AS total_ftm,
               CASE WHEN SUM(total_fta) > 0 THEN ROUND(CAST(SUM(total_ftm) AS FLOAT) / SUM(total_fta), 3) ELSE 0 END AS ft_pct
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT season_id, team_abbreviation, total_fta, total_ftm, ft_pct
      FROM agg
      ORDER BY ft_pct DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 자유투 시도/성공/자유투 성공률 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_022
    aliases:
      - 특정 시즌 팀별 리바운드/어시스트/턴오버 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 리바운드/어시스트/턴오버 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: total_reb DESC, total_ast DESC, total_tov ASC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - reb_home
      - ast_home
      - tov_home
      - team_abbreviation_away
      - reb_away
      - ast_away
      - tov_away
    sql_template: |-
      WITH team_stats AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation,
               SUM(reb_home) AS total_reb,
               SUM(ast_home) AS total_ast,
               SUM(tov_home) AS total_tov
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_home
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation,
               SUM(reb_away) AS total_reb,
               SUM(ast_away) AS total_ast,
               SUM(tov_away) AS total_tov
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_away
      ),
      agg AS (
        SELECT season_id, team_abbreviation,
               SUM(total_reb) AS total_reb,
               SUM(total_ast) AS total_ast,
               SUM(total_tov) AS total_tov
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT season_id, team_abbreviation, total_reb, total_ast, total_tov
      FROM agg
      ORDER BY total_reb DESC, total_ast DESC, total_tov ASC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 리바운드/어시스트/턴오버 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_023
    aliases:
      - 특정 시즌 팀별 파울(pf) 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 파울(pf) 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: total_pf DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - pf_home
      - team_abbreviation_away
      - pf_away
    sql_template: |-
      WITH team_stats AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation, SUM(pf_home) AS total_pf
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_home
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation, SUM(pf_away) AS total_pf
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY season_id, team_abbreviation_away
      ),
      agg AS (
        SELECT season_id, team_abbreviation, SUM(total_pf) AS total_pf
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT season_id, team_abbreviation, total_pf
      FROM agg
      ORDER BY total_pf DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 파울(pf) 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_024
    aliases:
      - 특정 팀의 시즌별 3점 비중(3PA/FGA) 추이를 보여줘
    description_ko: 이 메트릭은 '특정 팀의 시즌별 3점 비중(3PA/FGA) 추이를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 합계 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라
      결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - fga_home
      - fg3a_home
      - team_abbreviation_away
      - fga_away
      - fg3a_away
    sql_template: "SELECT season_id, '{season_year}' AS season_year, team_abbreviation_home AS team_abbreviation, \n       SUM(fg3a_home)*1.0 /\
      \ NULLIF(SUM(fga_home),0) AS three_point_ratio\nFROM game\nWHERE team_abbreviation_home = '{team_abbreviation}'\nGROUP BY season_id, team_abbreviation_home\n\
      UNION ALL\nSELECT season_id, '{season_year}' AS season_year, team_abbreviation_away AS team_abbreviation, \n       SUM(fg3a_away)*1.0 / NULLIF(SUM(fga_away),0)\
      \ AS three_point_ratio\nFROM game\nWHERE team_abbreviation_away = '{team_abbreviation}'\nGROUP BY season_id, team_abbreviation_away\nORDER\
      \ BY season_id\nLIMIT {limit}"
    examples:
      - question: 특정 팀의 시즌별 3점 비중(3PA/FGA) 추이를 보여줘
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_025
    aliases:
      - 특정 팀의 시즌별 FT 비중(FTA/FGA) 추이를 보여줘
    description_ko: 이 메트릭은 '특정 팀의 시즌별 FT 비중(FTA/FGA) 추이를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 합계 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라
      결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - fga_home
      - fta_home
      - team_abbreviation_away
      - fga_away
      - fta_away
    sql_template: "SELECT season_id, '{season_year}' AS season_year, team_abbreviation_home AS team_abbreviation, \n       SUM(fta_home)*1.0 / NULLIF(SUM(fga_home),0)\
      \ AS ft_ratio\nFROM game\nWHERE team_abbreviation_home = '{team_abbreviation}'\nGROUP BY season_id, team_abbreviation_home\nUNION ALL\nSELECT\
      \ season_id, '{season_year}' AS season_year, team_abbreviation_away AS team_abbreviation, \n       SUM(fta_away)*1.0 / NULLIF(SUM(fga_away),0)\
      \ AS ft_ratio\nFROM game\nWHERE team_abbreviation_away = '{team_abbreviation}'\nGROUP BY season_id, team_abbreviation_away\nORDER BY season_id\n\
      LIMIT {limit}"
    examples:
      - question: 특정 팀의 시즌별 FT 비중(FTA/FGA) 추이를 보여줘
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_026
    aliases:
      - 특정 시즌에서 홈 팀이 이긴 비율(홈승률)을 알려줘
    description_ko: 이 메트릭은 '특정 시즌에서 홈 팀이 이긴 비율(홈승률)을 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에
      따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - wl_home
    sql_template: "SELECT season_id, '{season_year}' AS season_year, \n       CASE WHEN COUNT(*) = 0 THEN 0 ELSE SUM(CASE WHEN wl_home = 'W' THEN\
      \ 1 ELSE 0 END)*1.0/COUNT(*) END AS home_win_rate\nFROM game\nWHERE season_id = '{season_id}'\nLIMIT {limit}"
    examples:
      - question: 특정 시즌에서 홈 팀이 이긴 비율(홈승률)을 알려줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_027
    aliases:
      - 시즌별 홈승률 추이를 보여줘 (차트용)
    description_ko: 이 메트릭은 '시즌별 홈승률 추이를 보여줘 (차트용)' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가
      달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - wl_home
    sql_template: "SELECT season_id, '{season_year}' AS season_year, \n       CASE WHEN COUNT(*) = 0 THEN 0 ELSE SUM(CASE WHEN wl_home = 'W' THEN\
      \ 1 ELSE 0 END)*1.0/COUNT(*) END AS home_win_rate\nFROM game\nGROUP BY season_id\nORDER BY season_id\nLIMIT {limit}"
    examples:
      - question: 시즌별 홈승률 추이를 보여줘 (차트용)
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_028
    aliases:
      - 특정 시즌에서 원정에서 가장 강한 팀(원정 승률 상위)을 알려줘
    description_ko: 이 메트릭은 '특정 시즌에서 원정에서 가장 강한 팀(원정 승률 상위)을 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: away_win_rate DESC, wins DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_away
      - wl_away
    sql_template: |-
      WITH away_stats AS (
        SELECT team_abbreviation_away AS team_abbreviation,
               COUNT(*) AS games,
               SUM(CASE WHEN wl_away = 'W' THEN 1 ELSE 0 END) AS wins
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY team_abbreviation_away
      )
      SELECT team_abbreviation, wins*1.0 / NULLIF(games,0) AS away_win_rate
      FROM away_stats
      WHERE games > 0
      ORDER BY away_win_rate DESC, wins DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 원정에서 가장 강한 팀(원정 승률 상위)을 알려줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_029
    aliases:
      - 특정 팀의 홈/원정 평균 득점/실점 차이를 시즌별로 비교해줘
    description_ko: 이 메트릭은 '특정 팀의 홈/원정 평균 득점/실점 차이를 시즌별로 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 조인 / cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - pts_home
      - team_abbreviation_away
      - pts_away
    sql_template: "WITH home_stats AS (\n  SELECT season_id, team_abbreviation_home AS team_abbreviation,\n         AVG(pts_home) AS avg_pts_scored,\n\
      \         AVG(pts_away) AS avg_pts_allowed\n  FROM game\n  WHERE team_abbreviation_home = '{team_abbreviation}'\n  GROUP BY season_id, team_abbreviation_home\n\
      ),\naway_stats AS (\n  SELECT season_id, team_abbreviation_away AS team_abbreviation,\n         AVG(pts_away) AS avg_pts_scored,\n       \
      \  AVG(pts_home) AS avg_pts_allowed\n  FROM game\n  WHERE team_abbreviation_away = '{team_abbreviation}'\n  GROUP BY season_id, team_abbreviation_away\n\
      )\nSELECT \n  COALESCE(h.season_id, a.season_id) AS season_id,\n  '{season_year}' AS season_year,\n  '{team_abbreviation}' AS team_abbreviation,\n\
      \  h.avg_pts_scored AS home_avg_pts_scored,\n  h.avg_pts_allowed AS home_avg_pts_allowed,\n  a.avg_pts_scored AS away_avg_pts_scored,\n  a.avg_pts_allowed\
      \ AS away_avg_pts_allowed\nFROM home_stats h\nFULL OUTER JOIN away_stats a ON h.season_id = a.season_id\nORDER BY season_id\nLIMIT {limit}"
    examples:
      - question: 특정 팀의 홈/원정 평균 득점/실점 차이를 시즌별로 비교해줘
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_030
    aliases:
      - 특정 시즌에서 가장 많은 승리를 기록한 팀 TOP 10을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 가장 많은 승리를 기록한 팀 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: total_wins DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - wl_home
      - team_abbreviation_away
      - wl_away
    sql_template: "WITH home_wins AS (\n  SELECT team_abbreviation_home AS team_abbreviation, COUNT(*) AS home_wins\n  FROM game\n  WHERE season_id\
      \ = '{season_id}' AND wl_home = 'W'\n  GROUP BY team_abbreviation_home\n),\naway_wins AS (\n  SELECT team_abbreviation_away AS team_abbreviation,\
      \ COUNT(*) AS away_wins\n  FROM game\n  WHERE season_id = '{season_id}' AND wl_away = 'W'\n  GROUP BY team_abbreviation_away\n),\ntotal_wins\
      \ AS (\n  SELECT \n    COALESCE(h.team_abbreviation, a.team_abbreviation) AS team_abbreviation,\n    COALESCE(home_wins,0) + COALESCE(away_wins,0)\
      \ AS total_wins\n  FROM home_wins h\n  FULL OUTER JOIN away_wins a ON h.team_abbreviation = a.team_abbreviation\n)\nSELECT team_abbreviation,\
      \ total_wins\nFROM total_wins\nORDER BY total_wins DESC\nLIMIT {limit};"
    examples:
      - question: 특정 시즌에서 가장 많은 승리를 기록한 팀 TOP 10을 보여줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_031
    aliases:
      - 특정 시즌에서 최다 득점 경기(팀 기준) TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 최다 득점 경기(팀 기준) TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에
      따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: points DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - pts_home
      - team_abbreviation_away
      - pts_away
    sql_template: |-
      WITH home_scores AS (
        SELECT game_id, team_abbreviation_home AS team_abbreviation, pts_home AS points
        FROM game
        WHERE season_id = '{season_id}'
      ),
      away_scores AS (
        SELECT game_id, team_abbreviation_away AS team_abbreviation, pts_away AS points
        FROM game
        WHERE season_id = '{season_id}'
      ),
      all_scores AS (
        SELECT * FROM home_scores
        UNION ALL
        SELECT * FROM away_scores
      )
      SELECT game_id, team_abbreviation, points
      FROM all_scores
      ORDER BY points DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 최다 득점 경기(팀 기준) TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_032
    aliases:
      - 특정 시즌에서 최다 실점 경기(팀 기준) TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 최다 실점 경기(팀 기준) TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에
      따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: points DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - game_date
      - pts_home
      - team_abbreviation_away
      - pts_away
    sql_template: |-
      WITH combined_scores AS (
        SELECT
          game_id,
          team_abbreviation_home AS team_abbreviation,
          pts_home AS points,
          game_date
        FROM game
        WHERE season_id = '{season_id}'
        UNION ALL
        SELECT
          game_id,
          team_abbreviation_away AS team_abbreviation,
          pts_away AS points,
          game_date
        FROM game
        WHERE season_id = '{season_id}'
      )
      SELECT
        game_id,
        team_abbreviation,
        points,
        game_date,
        '{season_year}' AS season_year
      FROM combined_scores
      ORDER BY points DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 최다 실점 경기(팀 기준) TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_033
    aliases:
      - 특정 시즌에서 +/-(plus_minus) 평균이 가장 높은 팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 +/-(plus_minus) 평균이 가장 높은 팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_plus_minus DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - plus_minus_home
      - team_abbreviation_away
      - plus_minus_away
    sql_template: |-
      WITH combined_pm AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          plus_minus_home AS plus_minus
        FROM game
        WHERE season_id = '{season_id}'
        UNION ALL
        SELECT
          team_abbreviation_away AS team_abbreviation,
          plus_minus_away AS plus_minus
        FROM game
        WHERE season_id = '{season_id}'
      ), avg_pm AS (
        SELECT
          team_abbreviation,
          AVG(plus_minus) AS avg_plus_minus
        FROM combined_pm
        GROUP BY team_abbreviation
      )
      SELECT
        team_abbreviation,
        avg_plus_minus,
        '{season_year}' AS season_year
      FROM avg_pm
      ORDER BY avg_plus_minus DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 +/-(plus_minus) 평균이 가장 높은 팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_034
    aliases:
      - 특정 시즌에서 +/-(plus_minus) 변동폭이 큰 팀을 알려줘 (표준편차/범위)
    description_ko: 이 메트릭은 '특정 시즌에서 +/-(plus_minus) 변동폭이 큰 팀을 알려줘 (표준편차/범위)' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 평균 / 카운트 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG/COUNT · 정렬: stddev_plus_minus DESC, range_plus_minus DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - plus_minus_home
      - team_abbreviation_away
      - plus_minus_away
    sql_template: |-
      WITH combined_pm AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          CAST(plus_minus_home AS FLOAT) AS plus_minus
        FROM game
        WHERE season_id = '{season_id}' AND plus_minus_home IS NOT NULL
        UNION ALL
        SELECT
          team_abbreviation_away AS team_abbreviation,
          CAST(plus_minus_away AS FLOAT) AS plus_minus
        FROM game
        WHERE season_id = '{season_id}' AND plus_minus_away IS NOT NULL
      ), stats AS (
        SELECT
          team_abbreviation,
          MAX(plus_minus) - MIN(plus_minus) AS range_plus_minus,
          CASE
            WHEN COUNT(*) > 1 THEN SQRT(AVG(plus_minus * plus_minus) - AVG(plus_minus) * AVG(plus_minus))
            ELSE 0
          END AS stddev_plus_minus
        FROM combined_pm
        GROUP BY team_abbreviation
      )
      SELECT
        team_abbreviation,
        range_plus_minus,
        stddev_plus_minus,
        '{season_year}' AS season_year
      FROM stats
      ORDER BY stddev_plus_minus DESC, range_plus_minus DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 +/-(plus_minus) 변동폭이 큰 팀을 알려줘 (표준편차/범위)
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_001
    aliases:
      - 특정 시즌 팀별 1쿼터 평균 득점 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 1쿼터 평균 득점 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_pts_1q DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - season_id
      - team_abbreviation_home
      - pts_qtr1_home
      - team_abbreviation_away
      - pts_qtr1_away
    sql_template: |-
      WITH team_1q_points AS (
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_home AS team_abbreviation,
          AVG(ls.pts_qtr1_home) AS avg_pts_1q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_away AS team_abbreviation,
          AVG(ls.pts_qtr1_away) AS avg_pts_1q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_away
      ),
      team_1q_avg AS (
        SELECT
          season_id,
          team_abbreviation,
          AVG(avg_pts_1q) AS avg_pts_1q
        FROM team_1q_points
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        '{season_year}' AS season_year,
        team_abbreviation,
        avg_pts_1q
      FROM team_1q_avg
      ORDER BY avg_pts_1q DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 1쿼터 평균 득점 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_002
    aliases:
      - 특정 시즌 팀별 4쿼터 평균 득점 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 4쿼터 평균 득점 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_pts_4q DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - season_id
      - team_abbreviation_home
      - pts_qtr4_home
      - team_abbreviation_away
      - pts_qtr4_away
    sql_template: |-
      WITH team_4q_points AS (
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_home AS team_abbreviation,
          AVG(ls.pts_qtr4_home) AS avg_pts_4q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_away AS team_abbreviation,
          AVG(ls.pts_qtr4_away) AS avg_pts_4q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_away
      ),
      team_4q_avg AS (
        SELECT
          season_id,
          team_abbreviation,
          AVG(avg_pts_4q) AS avg_pts_4q
        FROM team_4q_points
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        '{season_year}' AS season_year,
        team_abbreviation,
        avg_pts_4q
      FROM team_4q_avg
      ORDER BY avg_pts_4q DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 4쿼터 평균 득점 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_003
    aliases:
      - 특정 시즌 팀별 전반(1Q+2Q) 평균 득점 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 전반(1Q+2Q) 평균 득점 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_pts_1q2q DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - season_id
      - team_abbreviation_home
      - pts_qtr1_home
      - pts_qtr2_home
      - team_abbreviation_away
      - pts_qtr1_away
      - pts_qtr2_away
    sql_template: |-
      WITH team_1q2q_points AS (
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_home AS team_abbreviation,
          AVG(ls.pts_qtr1_home + ls.pts_qtr2_home) AS avg_pts_1q2q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_away AS team_abbreviation,
          AVG(ls.pts_qtr1_away + ls.pts_qtr2_away) AS avg_pts_1q2q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_away
      ),
      team_1q2q_avg AS (
        SELECT
          season_id,
          team_abbreviation,
          AVG(avg_pts_1q2q) AS avg_pts_1q2q
        FROM team_1q2q_points
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        '{season_year}' AS season_year,
        team_abbreviation,
        avg_pts_1q2q
      FROM team_1q2q_avg
      ORDER BY avg_pts_1q2q DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 전반(1Q+2Q) 평균 득점 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_004
    aliases:
      - 특정 시즌 팀별 후반(3Q+4Q) 평균 득점 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 후반(3Q+4Q) 평균 득점 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_pts_3q4q DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - season_id
      - team_abbreviation_home
      - pts_qtr3_home
      - pts_qtr4_home
      - team_abbreviation_away
      - pts_qtr3_away
      - pts_qtr4_away
    sql_template: |-
      WITH team_3q4q_points AS (
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_home AS team_abbreviation,
          AVG(ls.pts_qtr3_home + ls.pts_qtr4_home) AS avg_pts_3q4q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_away AS team_abbreviation,
          AVG(ls.pts_qtr3_away + ls.pts_qtr4_away) AS avg_pts_3q4q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_away
      ),
      team_3q4q_avg AS (
        SELECT
          season_id,
          team_abbreviation,
          AVG(avg_pts_3q4q) AS avg_pts_3q4q
        FROM team_3q4q_points
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        '{season_year}' AS season_year,
        team_abbreviation,
        avg_pts_3q4q
      FROM team_3q4q_avg
      ORDER BY avg_pts_3q4q DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 후반(3Q+4Q) 평균 득점 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_005
    aliases:
      - 특정 시즌 팀별 3쿼터 평균 득실차(3Q 득점-실점) 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 팀별 3쿼터 평균 득실차(3Q 득점-실점) 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 평균 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_diff_3q DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - season_id
      - team_abbreviation_home
      - pts_qtr3_home
      - team_abbreviation_away
      - pts_qtr3_away
    sql_template: |-
      WITH team_3q_diff AS (
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_home AS team_abbreviation,
          AVG(ls.pts_qtr3_home - ls.pts_qtr3_away) AS avg_diff_3q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id AS season_id,
          ls.team_abbreviation_away AS team_abbreviation,
          AVG(ls.pts_qtr3_away - ls.pts_qtr3_home) AS avg_diff_3q
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.season_id, ls.team_abbreviation_away
      ),
      team_3q_diff_avg AS (
        SELECT
          season_id,
          team_abbreviation,
          AVG(avg_diff_3q) AS avg_diff_3q
        FROM team_3q_diff
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        '{season_year}' AS season_year,
        team_abbreviation,
        avg_diff_3q
      FROM team_3q_diff_avg
      ORDER BY avg_diff_3q DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 팀별 3쿼터 평균 득실차(3Q 득점-실점) 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_006
    aliases:
      - 1쿼터를 이긴 팀이 최종 승리하는 비율을 시즌별로 보여줘
    description_ko: 이 메트릭은 '1쿼터를 이긴 팀이 최종 승리하는 비율을 시즌별로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: season_id; · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - season_id
      - team_abbreviation_home
      - pts_qtr1_home
      - team_abbreviation_away
      - pts_qtr1_away
      - wl_home
      - wl_away
    sql_template: |-
      WITH first_quarter_winner AS (
        SELECT
          g.game_id,
          g.season_id,
          CASE
            WHEN ls.pts_qtr1_home > ls.pts_qtr1_away THEN g.team_abbreviation_home
            WHEN ls.pts_qtr1_home < ls.pts_qtr1_away THEN g.team_abbreviation_away
            ELSE NULL
          END AS first_qtr_winner,
          CASE
            WHEN g.wl_home = 'W' THEN g.team_abbreviation_home
            WHEN g.wl_away = 'W' THEN g.team_abbreviation_away
            ELSE NULL
          END AS final_winner
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id IS NOT NULL
      ),
      valid_games AS (
        SELECT * FROM first_quarter_winner
        WHERE first_qtr_winner IS NOT NULL AND final_winner IS NOT NULL
      ),
      season_stats AS (
        SELECT
          season_id,
          COUNT(*) AS total_games,
          SUM(CASE WHEN first_qtr_winner = final_winner THEN 1 ELSE 0 END) AS first_qtr_winner_final_winner_count
        FROM valid_games
        GROUP BY season_id
      )
      SELECT
        season_id,
        ROUND(CAST(first_qtr_winner_final_winner_count AS FLOAT) / total_games, 4) AS win_rate_1q_winner_final_winner
      FROM season_stats
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 1쿼터를 이긴 팀이 최종 승리하는 비율을 시즌별로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_007
    aliases:
      - 전반 리드 팀이 최종 승리하는 비율을 시즌별로 보여줘
    description_ko: 이 메트릭은 '전반 리드 팀이 최종 승리하는 비율을 시즌별로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: season_id; · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - season_id
      - team_abbreviation_home
      - pts_qtr1_home
      - pts_qtr2_home
      - team_abbreviation_away
      - pts_qtr1_away
      - pts_qtr2_away
      - wl_home
      - wl_away
    sql_template: |-
      WITH first_half_leader AS (
        SELECT
          g.game_id,
          g.season_id,
          CASE
            WHEN (ls.pts_qtr1_home + ls.pts_qtr2_home) > (ls.pts_qtr1_away + ls.pts_qtr2_away) THEN g.team_abbreviation_home
            WHEN (ls.pts_qtr1_home + ls.pts_qtr2_home) < (ls.pts_qtr1_away + ls.pts_qtr2_away) THEN g.team_abbreviation_away
            ELSE NULL
          END AS first_half_leader,
          CASE
            WHEN g.wl_home = 'W' THEN g.team_abbreviation_home
            WHEN g.wl_away = 'W' THEN g.team_abbreviation_away
            ELSE NULL
          END AS final_winner
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id IS NOT NULL
      ),
      valid_games AS (
        SELECT * FROM first_half_leader
        WHERE first_half_leader IS NOT NULL AND final_winner IS NOT NULL
      ),
      season_stats AS (
        SELECT
          season_id,
          COUNT(*) AS total_games,
          SUM(CASE WHEN first_half_leader = final_winner THEN 1 ELSE 0 END) AS first_half_leader_final_winner_count
        FROM valid_games
        GROUP BY season_id
      )
      SELECT
        season_id,
        ROUND(CAST(first_half_leader_final_winner_count AS FLOAT) / total_games, 4) AS win_rate_first_half_leader_final_winner
      FROM season_stats
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 전반 리드 팀이 최종 승리하는 비율을 시즌별로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_008
    aliases:
      - 전반에 지고도 이긴(역전승) 경기가 가장 많은 팀 TOP 10을 보여줘
    description_ko: 이 메트릭은 '전반에 지고도 이긴(역전승) 경기가 가장 많은 팀 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: total_comeback_wins DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - pts_qtr1_home
      - pts_qtr2_home
      - team_abbreviation_away
      - pts_qtr1_away
      - pts_qtr2_away
    sql_template: |-
      WITH pre_final AS (
        SELECT
          g.game_id,
          g.season_id,
          g.team_abbreviation_home,
          g.team_abbreviation_away,
          (ls.pts_qtr1_home + ls.pts_qtr2_home) AS first_half_pts_home,
          (ls.pts_qtr1_away + ls.pts_qtr2_away) AS first_half_pts_away,
          g.wl_home,
          g.wl_away
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
      ),
      team_comebacks AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          COUNT(CASE WHEN first_half_pts_home < first_half_pts_away AND wl_home = 'W' THEN 1 END) AS comeback_wins
        FROM pre_final
        GROUP BY team_abbreviation_home
        UNION ALL
        SELECT
          team_abbreviation_away AS team_abbreviation,
          COUNT(CASE WHEN first_half_pts_away < first_half_pts_home AND wl_away = 'W' THEN 1 END) AS comeback_wins
        FROM pre_final
        GROUP BY team_abbreviation_away
      ),
      team_comeback_sum AS (
        SELECT
          team_abbreviation,
          SUM(comeback_wins) AS total_comeback_wins
        FROM team_comebacks
        GROUP BY team_abbreviation
      )
      SELECT
        team_abbreviation,
        total_comeback_wins
      FROM team_comeback_sum
      ORDER BY total_comeback_wins DESC
      LIMIT {limit}
    examples:
      - question: 전반에 지고도 이긴(역전승) 경기가 가장 많은 팀 TOP 10을 보여줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_009
    aliases:
      - 4쿼터 시작 시점에 지고도 이긴(클러치 역전) 경기가 많은 팀을 알려줘
    description_ko: 이 메트릭은 '4쿼터 시작 시점에 지고도 이긴(클러치 역전) 경기가 많은 팀을 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: clutch_wins_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - pts_qtr1_home
      - pts_qtr2_home
      - pts_qtr3_home
      - pts_home
      - team_abbreviation_away
      - pts_qtr1_away
      - pts_qtr2_away
      - pts_qtr3_away
      - pts_away
    sql_template: |-
      WITH base AS (
        SELECT
          g.game_id,
          g.team_abbreviation_home AS home_team,
          g.team_abbreviation_away AS away_team,
          (ls.pts_qtr1_home + ls.pts_qtr2_home + ls.pts_qtr3_home) AS home_3q_pts,
          (ls.pts_qtr1_away + ls.pts_qtr2_away + ls.pts_qtr3_away) AS away_3q_pts,
          ls.pts_home AS home_final_pts,
          ls.pts_away AS away_final_pts
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE date(g.game_date) >= '{start_date}' AND date(g.game_date) <= '{end_date}'
      ),
      clutch_wins AS (
        SELECT home_team AS team_abbreviation
        FROM base
        WHERE home_3q_pts < away_3q_pts AND home_final_pts > away_final_pts
        UNION ALL
        SELECT away_team AS team_abbreviation
        FROM base
        WHERE away_3q_pts < home_3q_pts AND away_final_pts > home_final_pts
      )
      SELECT
        team_abbreviation,
        COUNT(*) AS clutch_wins_count
      FROM clutch_wins
      GROUP BY team_abbreviation
      ORDER BY clutch_wins_count DESC
      LIMIT {limit}
    examples:
      - question: 4쿼터 시작 시점에 지고도 이긴(클러치 역전) 경기가 많은 팀을 알려줘
        params:
          end_date: '2023-06-30'
          limit: 200
          start_date: '2022-10-01'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_010
    aliases:
      - 특정 시즌에서 “4쿼터 득점이 가장 높았던 경기” TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “4쿼터 득점이 가장 높았던 경기” TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score, game 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: pts_qtr4_total DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - pts_qtr4_home
      - pts_qtr4_away
      - season_id
    sql_template: |-
      SELECT
        game_id,
        (pts_qtr4_home + pts_qtr4_away) AS pts_qtr4_total,
        '{season_year}' AS season_year
      FROM line_score
      WHERE game_id IN (SELECT game_id FROM game WHERE season_id = '{season_id}')
      ORDER BY pts_qtr4_total DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 “4쿼터 득점이 가장 높았던 경기” TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_011
    aliases:
      - 특정 시즌에서 “1쿼터 득점이 가장 높았던 경기” TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “1쿼터 득점이 가장 높았던 경기” TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score, game 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: pts_qtr1_total DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - pts_qtr1_home
      - pts_qtr1_away
      - season_id
    sql_template: |-
      SELECT
        game_id,
        (pts_qtr1_home + pts_qtr1_away) AS pts_qtr1_total,
        '{season_year}' AS season_year
      FROM line_score
      WHERE game_id IN (SELECT game_id FROM game WHERE season_id = '{season_id}')
      ORDER BY pts_qtr1_total DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 “1쿼터 득점이 가장 높았던 경기” TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_035
    aliases:
      - 연장전(OT) 경기가 가장 많았던 시즌 TOP 10을 보여줘
    description_ko: 이 메트릭은 '연장전(OT) 경기가 가장 많았던 시즌 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, line_score 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: ot_game_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - line_score
    required_columns:
      - season_id
      - game_id
      - pts_ot1_home
      - pts_ot1_away
    sql_template: |-
      WITH ot_games AS (
        SELECT
          g.season_id,
          COUNT(*) AS ot_game_count
        FROM game g
        JOIN line_score ls ON g.game_id = ls.game_id
        WHERE (
          pts_ot1_home IS NOT NULL AND pts_ot1_home > 0
        ) OR (
          pts_ot1_away IS NOT NULL AND pts_ot1_away > 0
        )
        GROUP BY g.season_id
      )
      SELECT season_id, ot_game_count
      FROM ot_games
      ORDER BY ot_game_count DESC
      LIMIT {limit}
    examples:
      - question: 연장전(OT) 경기가 가장 많았던 시즌 TOP 10을 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_036
    aliases:
      - 특정 시즌에서 연장전 경기가 가장 많았던 팀 TOP 10을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 연장전 경기가 가장 많았던 팀 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, line_score 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: ot_game_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - line_score
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - team_abbreviation_away
      - pts_ot1_home
      - pts_ot1_away
    sql_template: |-
      WITH ot_games AS (
        SELECT
          g.team_abbreviation_home AS team_abbr,
          g.game_id
        FROM game g
        JOIN line_score ls ON g.game_id = ls.game_id
        WHERE g.season_id = '{season_id}'
          AND ((pts_ot1_home IS NOT NULL AND pts_ot1_home > 0) OR (pts_ot1_away IS NOT NULL AND pts_ot1_away > 0))
        UNION ALL
        SELECT
          g.team_abbreviation_away AS team_abbr,
          g.game_id
        FROM game g
        JOIN line_score ls ON g.game_id = ls.game_id
        WHERE g.season_id = '{season_id}'
          AND ((pts_ot1_home IS NOT NULL AND pts_ot1_home > 0) OR (pts_ot1_away IS NOT NULL AND pts_ot1_away > 0))
      ),
      team_ot_counts AS (
        SELECT team_abbr, COUNT(DISTINCT game_id) AS ot_game_count
        FROM ot_games
        GROUP BY team_abbr
      )
      SELECT team_abbr, ot_game_count
      FROM team_ot_counts
      ORDER BY ot_game_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 연장전 경기가 가장 많았던 팀 TOP 10을 보여줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_037
    aliases:
      - 특정 시즌에서 2OT 이상 경기 목록을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 2OT 이상 경기 목록을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, line_score 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - game
      - line_score
    required_columns:
      - season_id
      - game_id
      - pts_ot2_home
      - pts_ot2_away
    sql_template: |-
      SELECT
        g.game_id,
        (CASE
          WHEN pts_ot2_home > 0 OR pts_ot2_away > 0 THEN 1
          ELSE 0
        END) AS has_2OT,
        '{season_year}' AS season_year
      FROM game g
      JOIN line_score ls ON g.game_id = ls.game_id
      WHERE g.season_id = '{season_id}'
        AND (pts_ot2_home > 0 OR pts_ot2_away > 0)
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 2OT 이상 경기 목록을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_038
    aliases:
      - 특정 시즌에서 연장전에서 가장 자주 이긴 팀(OT 승률)을 알려줘
    description_ko: 이 메트릭은 '특정 시즌에서 연장전에서 가장 자주 이긴 팀(OT 승률)을 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game, line_score 테이블을 활용해 조인 / cte / 그룹 집계 / 합계 / 카운트 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: ot_win_rate DESC, ot_wins DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - line_score
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - pts_home
      - team_abbreviation_away
      - pts_away
      - pts_ot1_home
      - pts_ot1_away
    sql_template: |-
      WITH ot_games AS (
        SELECT
          g.game_id,
          g.season_id,
          g.team_abbreviation_home AS home_team,
          g.team_abbreviation_away AS away_team,
          ls.pts_ot1_home,
          ls.pts_ot1_away,
          g.pts_home,
          g.pts_away
        FROM game g
        JOIN line_score ls ON g.game_id = ls.game_id
        WHERE g.season_id = '{season_id}'
          AND ((ls.pts_ot1_home > 0) OR (ls.pts_ot1_away > 0))
      ),
      team_ot_results AS (
        SELECT
          team_abbr,
          COUNT(*) AS ot_games,
          SUM(CASE WHEN team_abbr = winner THEN 1 ELSE 0 END) AS ot_wins
        FROM (
          SELECT
            game_id,
            home_team AS team_abbr,
            CASE WHEN pts_home > pts_away THEN home_team ELSE away_team END AS winner
          FROM ot_games
          UNION ALL
          SELECT
            game_id,
            away_team AS team_abbr,
            CASE WHEN pts_home > pts_away THEN home_team ELSE away_team END AS winner
          FROM ot_games
        )
        GROUP BY team_abbr
      )
      SELECT team_abbr, ot_games, ot_wins, ROUND(CAST(ot_wins AS FLOAT) / ot_games, 3) AS ot_win_rate
      FROM team_ot_results
      ORDER BY ot_win_rate DESC, ot_wins DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 연장전에서 가장 자주 이긴 팀(OT 승률)을 알려줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_039
    aliases:
      - 특정 팀의 시즌별 OT 경기 수와 OT 승률을 비교해줘
    description_ko: 이 메트릭은 '특정 팀의 시즌별 OT 경기 수와 OT 승률을 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game, line_score 테이블을 활용해 조인 / cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
      - line_score
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - pts_home
      - team_abbreviation_away
      - pts_away
      - pts_ot1_home
      - pts_ot1_away
    sql_template: |-
      WITH ot_games AS (
        SELECT
          g.season_id,
          g.game_id,
          g.team_abbreviation_home AS home_team,
          g.team_abbreviation_away AS away_team,
          g.pts_home,
          g.pts_away,
          ls.pts_ot1_home,
          ls.pts_ot1_away
        FROM game g
        JOIN line_score ls ON g.game_id = ls.game_id
        WHERE (ls.pts_ot1_home > 0 OR ls.pts_ot1_away > 0)
      ),
      team_ot_games AS (
        SELECT
          season_id,
          game_id,
          CASE
            WHEN home_team = '{team_abbreviation}' THEN home_team
            WHEN away_team = '{team_abbreviation}' THEN away_team
            ELSE NULL
          END AS team_abbr,
          CASE
            WHEN home_team = '{team_abbreviation}' THEN pts_home > pts_away
            WHEN away_team = '{team_abbreviation}' THEN pts_away > pts_home
            ELSE NULL
          END AS is_win
        FROM ot_games
        WHERE home_team = '{team_abbreviation}' OR away_team = '{team_abbreviation}'
      ),
      season_summary AS (
        SELECT
          season_id,
          COUNT(game_id) AS ot_game_count,
          SUM(CASE WHEN is_win THEN 1 ELSE 0 END) AS ot_win_count
        FROM team_ot_games
        GROUP BY season_id
      )
      SELECT
        season_id,
        ot_game_count,
        ot_win_count,
        ROUND(CAST(ot_win_count AS FLOAT) / ot_game_count, 3) AS ot_win_rate
      FROM season_summary
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 OT 경기 수와 OT 승률을 비교해줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_040
    aliases:
      - 연장전 경기의 평균 관중은 정규시간 경기보다 높은지 비교해줘 (멀티스텝)
    description_ko: 이 메트릭은 '연장전 경기의 평균 관중은 정규시간 경기보다 높은지 비교해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / cte / 평균 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - attendance
      - min
    sql_template: |-
      WITH base AS (
        SELECT
          gi.attendance,
          CASE WHEN g.min > 48 THEN '연장전 평균 관중' ELSE '정규시간 평균 관중' END AS category
        FROM game_info gi
        JOIN game g ON gi.game_id = g.game_id
        WHERE gi.attendance IS NOT NULL
      )
      SELECT
        category,
        AVG(attendance) AS avg_attendance
      FROM base
      GROUP BY category
      ORDER BY category
      LIMIT {limit}
    examples:
      - question: 연장전 경기의 평균 관중은 정규시간 경기보다 높은지 비교해줘 (멀티스텝)
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_041
    aliases:
      - 특정 시즌에서 연장전 득점(OT 합계)이 가장 많았던 경기 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 연장전 득점(OT 합계)이 가장 많았던 경기 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: ot_total_points DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - line_score
    required_columns:
      - season_id
      - game_id
      - pts_ot1_home
      - pts_ot2_home
      - pts_ot3_home
      - pts_ot4_home
      - pts_ot5_home
      - pts_ot6_home
      - pts_ot7_home
      - pts_ot8_home
      - pts_ot9_home
      - pts_ot10_home
      - pts_ot1_away
      - pts_ot2_away
      - pts_ot3_away
      - pts_ot4_away
      - pts_ot5_away
      - pts_ot6_away
      - pts_ot7_away
      - pts_ot8_away
      - pts_ot9_away
      - pts_ot10_away
    sql_template: |-
      WITH ot_scores AS (
        SELECT
          g.game_id,
          (COALESCE(ls.pts_ot1_home, 0) + COALESCE(ls.pts_ot2_home, 0) + COALESCE(ls.pts_ot3_home, 0) + COALESCE(ls.pts_ot4_home, 0)
           + COALESCE(ls.pts_ot5_home, 0) + COALESCE(ls.pts_ot6_home, 0) + COALESCE(ls.pts_ot7_home, 0) + COALESCE(ls.pts_ot8_home, 0)
           + COALESCE(ls.pts_ot9_home, 0) + COALESCE(ls.pts_ot10_home, 0)
           + COALESCE(ls.pts_ot1_away, 0) + COALESCE(ls.pts_ot2_away, 0) + COALESCE(ls.pts_ot3_away, 0) + COALESCE(ls.pts_ot4_away, 0)
           + COALESCE(ls.pts_ot5_away, 0) + COALESCE(ls.pts_ot6_away, 0) + COALESCE(ls.pts_ot7_away, 0) + COALESCE(ls.pts_ot8_away, 0)
           + COALESCE(ls.pts_ot9_away, 0) + COALESCE(ls.pts_ot10_away, 0)) AS ot_total_points
        FROM game g
        JOIN line_score ls ON g.game_id = ls.game_id
        WHERE season_id = '{season_id}'
      )
      SELECT game_id, ot_total_points
      FROM ot_scores
      WHERE ot_total_points > 0
      ORDER BY ot_total_points DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 연장전 득점(OT 합계)이 가장 많았던 경기 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_012
    aliases:
      - '특정 시즌에서 “전반 크게 지고(예: -15 이상)도 이긴” 경기 목록을 보여줘'
    description_ko: '이 메트릭은 ''특정 시즌에서 “전반 크게 지고(예: -15 이상)도 이긴” 경기 목록을 보여줘'' 요청을 처리하기 위한 조회 정의다. 주로 line_score, game 테이블을 활용해 조인 / cte 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
    required_columns:
      - game_id
      - pts_qtr1_home
      - pts_qtr2_home
      - pts_home
      - pts_qtr1_away
      - pts_qtr2_away
      - pts_away
      - season_id
    sql_template: |-
      WITH first_half_score AS (
        SELECT g.game_id,
               (pts_qtr1_home + pts_qtr2_home) AS first_half_home,
               (pts_qtr1_away + pts_qtr2_away) AS first_half_away,
               (g.pts_home) AS final_home,
               (g.pts_away) AS final_away
        FROM line_score ls
        JOIN game g ON ls.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
      )
      SELECT game_id
      FROM first_half_score
      WHERE (first_half_home - first_half_away) <= -15
        AND final_home > final_away
      LIMIT {limit}
    examples:
      - question: '특정 시즌에서 “전반 크게 지고(예: -15 이상)도 이긴” 경기 목록을 보여줘'
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_001
    aliases:
      - 리드 체인지(lead_changes)가 가장 많았던 경기 TOP 20을 보여줘
    description_ko: 이 메트릭은 '리드 체인지(lead_changes)가 가장 많았던 경기 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game 테이블을 활용해 조인 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: o.lead_changes DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - lead_changes
      - team_abbreviation_away
      - season_id
      - game_date
    sql_template: SELECT o.game_id, o.lead_changes, g.game_date, g.team_abbreviation_home, g.team_abbreviation_away, '{season_year}' AS season_year
      FROM other_stats o JOIN game g ON o.game_id = g.game_id WHERE g.season_id = '{season_id}' ORDER BY o.lead_changes DESC LIMIT {limit}
    examples:
      - question: 리드 체인지(lead_changes)가 가장 많았던 경기 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_002
    aliases:
      - 동점(times_tied)이 가장 많았던 경기 TOP 20을 보여줘
    description_ko: 이 메트릭은 '동점(times_tied)이 가장 많았던 경기 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game 테이블을 활용해 조인 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: o.times_tied DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - times_tied
      - team_abbreviation_away
      - season_id
      - game_date
    sql_template: SELECT o.game_id, o.times_tied, g.game_date, g.team_abbreviation_home, g.team_abbreviation_away, '{season_year}' AS season_year
      FROM other_stats o JOIN game g ON o.game_id = g.game_id WHERE g.season_id = '{season_id}' ORDER BY o.times_tied DESC LIMIT {limit}
    examples:
      - question: 동점(times_tied)이 가장 많았던 경기 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_003
    aliases:
      - 홈/원정 최대 리드(largest_lead_home/away)가 가장 컸던 경기 TOP 20을 보여줘
    description_ko: 이 메트릭은 '홈/원정 최대 리드(largest_lead_home/away)가 가장 컸던 경기 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats 테이블을 활용해 cte / 정렬 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: max_largest_lead DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - team_abbreviation_away
      - largest_lead_home
      - largest_lead_away
      - season_id
      - game_date
    sql_template: |-
      WITH max_lead AS (
        SELECT
          o.game_id,
          o.team_abbreviation_home,
          o.team_abbreviation_away,
          CASE
            WHEN o.largest_lead_home >= o.largest_lead_away THEN o.largest_lead_home
            ELSE o.largest_lead_away
          END AS max_largest_lead
        FROM other_stats o
      )
      SELECT
        ml.game_id,
        ml.team_abbreviation_home,
        ml.team_abbreviation_away,
        g.game_date,
        ml.max_largest_lead,
        '{season_year}' AS season_year
      FROM max_lead ml
      JOIN game g ON g.game_id = ml.game_id
      WHERE g.season_id = '{season_id}'
      ORDER BY ml.max_largest_lead DESC
      LIMIT {limit}
    examples:
      - question: 홈/원정 최대 리드(largest_lead_home/away)가 가장 컸던 경기 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_042
    aliases:
      - “최대 리드 대비 최종 결과가 뒤집힌 경기(역전)” TOP 20을 보여줘 (멀티스텝/계산)
    description_ko: 이 메트릭은 '“최대 리드 대비 최종 결과가 뒤집힌 경기(역전)” TOP 20을 보여줘 (멀티스텝/계산)' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 정렬
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: (largest_lead_home + largest_lead_away) DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - game_date
      - pts_home
      - team_abbreviation_away
      - pts_away
      - largest_lead_home
      - largest_lead_away
    sql_template: WITH max_lead AS ( SELECT g.game_id, g.team_abbreviation_home, g.team_abbreviation_away, g.game_date, o.largest_lead_home, o.largest_lead_away,
      g.pts_home, g.pts_away, g.season_id FROM game g JOIN other_stats o ON g.game_id = o.game_id WHERE g.season_id = '{season_id}' ), lead_winner
      AS ( SELECT game_id, team_abbreviation_home, team_abbreviation_away, game_date, largest_lead_home, largest_lead_away, pts_home, pts_away,
      season_id, CASE WHEN largest_lead_home > largest_lead_away THEN team_abbreviation_home WHEN largest_lead_away > largest_lead_home THEN team_abbreviation_away
      ELSE NULL END AS max_lead_team, CASE WHEN pts_home > pts_away THEN team_abbreviation_home WHEN pts_away > pts_home THEN team_abbreviation_away
      ELSE NULL END AS final_winner FROM max_lead ), reversed_games AS ( SELECT * FROM lead_winner WHERE max_lead_team IS NOT NULL AND final_winner
      IS NOT NULL AND max_lead_team != final_winner ) SELECT game_id, team_abbreviation_home, team_abbreviation_away, game_date, largest_lead_home,
      largest_lead_away, pts_home, pts_away, '{season_year}' AS season_year FROM reversed_games ORDER BY (largest_lead_home + largest_lead_away)
      DESC LIMIT {limit}
    examples:
      - question: “최대 리드 대비 최종 결과가 뒤집힌 경기(역전)” TOP 20을 보여줘 (멀티스텝/계산)
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_004
    aliases:
      - 리드 체인지가 많은 경기는 평균 관중이 더 많은지 분석해줘 (멀티스텝)
    description_ko: 이 메트릭은 '리드 체인지가 많은 경기는 평균 관중이 더 많은지 분석해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game_info, game 테이블을 활용해 조인 / cte / 그룹
      집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game_info
      - game
    required_columns:
      - game_id
      - lead_changes
      - attendance
      - season_id
    sql_template: |-
      WITH game_lead_attendance AS (
        SELECT o.game_id, o.lead_changes, gi.attendance
        FROM other_stats o
        JOIN game_info gi ON o.game_id = gi.game_id
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
      ),
      avg_lead AS (
        SELECT AVG(lead_changes) AS avg_lead_changes
        FROM game_lead_attendance
      ),
      high_low AS (
        SELECT
          CASE
            WHEN lead_changes >= (SELECT avg_lead_changes FROM avg_lead) THEN 'high_lead_changes'
            ELSE 'low_lead_changes'
          END AS lead_group,
          AVG(attendance) AS avg_attendance
        FROM game_lead_attendance
        GROUP BY lead_group
      )
      SELECT lead_group, avg_attendance
      FROM high_low
      LIMIT {limit}
    examples:
      - question: 리드 체인지가 많은 경기는 평균 관중이 더 많은지 분석해줘 (멀티스텝)
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_005
    aliases:
      - 동점이 많은 경기는 접전(마지막 5점 이내)으로 끝날 확률이 높은지 분석해줘
    description_ko: 이 메트릭은 '동점이 많은 경기는 접전(마지막 5점 이내)으로 끝날 확률이 높은지 분석해줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game 테이블을 활용해 조인 / cte / 그룹 집계 / 평균
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - times_tied
      - season_id
      - pts_home
      - pts_away
    sql_template: |-
      WITH game_tied_margin AS (
        SELECT o.game_id, o.times_tied, g.pts_home, g.pts_away
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
      ),
      game_tied_margin_flag AS (
        SELECT
          game_id,
          times_tied,
          ABS(pts_home - pts_away) AS final_margin,
          CASE WHEN ABS(pts_home - pts_away) <= 5 THEN 1 ELSE 0 END AS close_game
        FROM game_tied_margin
      ),
      avg_times_tied AS (
        SELECT AVG(times_tied) AS avg_times_tied
        FROM game_tied_margin_flag
      ),
      grouped AS (
        SELECT
          CASE
            WHEN times_tied >= (SELECT avg_times_tied FROM avg_times_tied) THEN 'high_times_tied'
            ELSE 'low_times_tied'
          END AS tied_group,
          AVG(close_game) AS close_game_prob
        FROM game_tied_margin_flag
        GROUP BY tied_group
      )
      SELECT tied_group, close_game_prob
      FROM grouped
      LIMIT {limit}
    examples:
      - question: 동점이 많은 경기는 접전(마지막 5점 이내)으로 끝날 확률이 높은지 분석해줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_043
    aliases:
      - 리드 체인지가 많은 팀(팀 경기 평균 lead_changes) TOP 10을 알려줘
    description_ko: 이 메트릭은 '리드 체인지가 많은 팀(팀 경기 평균 lead_changes) TOP 10을 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 그룹 집계 /
      평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_lead_changes DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - team_abbreviation_away
      - lead_changes
    sql_template: WITH team_games AS ( SELECT g.game_id, g.team_abbreviation_home AS team_abbreviation FROM game g WHERE g.season_id = '{season_id}'
      UNION ALL SELECT g.game_id, g.team_abbreviation_away AS team_abbreviation FROM game g WHERE g.season_id = '{season_id}' ), team_lead_changes
      AS ( SELECT tg.team_abbreviation, o.lead_changes FROM team_games tg JOIN other_stats o ON tg.game_id = o.game_id ), team_avg_lead AS ( SELECT
      team_abbreviation, AVG(lead_changes) AS avg_lead_changes FROM team_lead_changes GROUP BY team_abbreviation ) SELECT team_abbreviation, avg_lead_changes
      FROM team_avg_lead ORDER BY avg_lead_changes DESC LIMIT {limit}
    examples:
      - question: 리드 체인지가 많은 팀(팀 경기 평균 lead_changes) TOP 10을 알려줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_044
    aliases:
      - 동점이 많은 팀(팀 경기 평균 times_tied) TOP 10을 알려줘
    description_ko: 이 메트릭은 '동점이 많은 팀(팀 경기 평균 times_tied) TOP 10을 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 그룹 집계 / 평균 /
      정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_times_tied DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - team_abbreviation_away
      - times_tied
    sql_template: WITH team_games AS ( SELECT g.game_id, g.team_abbreviation_home AS team_abbreviation FROM game g WHERE g.season_id = '{season_id}'
      UNION ALL SELECT g.game_id, g.team_abbreviation_away AS team_abbreviation FROM game g WHERE g.season_id = '{season_id}' ), team_times_tied
      AS ( SELECT tg.team_abbreviation, o.times_tied FROM team_games tg JOIN other_stats o ON tg.game_id = o.game_id ), team_avg_tied AS ( SELECT
      team_abbreviation, AVG(times_tied) AS avg_times_tied FROM team_times_tied GROUP BY team_abbreviation ) SELECT team_abbreviation, avg_times_tied
      FROM team_avg_tied ORDER BY avg_times_tied DESC LIMIT {limit}
    examples:
      - question: 동점이 많은 팀(팀 경기 평균 times_tied) TOP 10을 알려줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_006
    aliases:
      - 특정 팀의 시즌별 평균 lead_changes 추이를 보여줘 (차트용)
    description_ko: 이 메트릭은 '특정 팀의 시즌별 평균 lead_changes 추이를 보여줘 (차트용)' 요청을 처리하기 위한 조회 정의다. 주로 other_stats 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - lead_changes
      - season_id
      - team_abbreviation_home
      - team_abbreviation_away
    sql_template: |-
      WITH team_games AS (
        SELECT g.season_id, o.lead_changes
        FROM other_stats o
        JOIN game g ON g.game_id = o.game_id
        WHERE g.team_abbreviation_home = '{team_abbreviation}' OR g.team_abbreviation_away = '{team_abbreviation}'
      )
      SELECT
        season_id,
        printf('%d-%02d', CAST(SUBSTR(season_id, 2, 4) AS INT), (CAST(SUBSTR(season_id, 2, 4) AS INT) + 1) % 100) AS season_year,
        AVG(lead_changes) AS avg_lead_changes
      FROM team_games
      GROUP BY season_id
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 평균 lead_changes 추이를 보여줘 (차트용)
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_007
    aliases:
      - 특정 팀의 시즌별 평균 times_tied 추이를 보여줘 (차트용)
    description_ko: 이 메트릭은 '특정 팀의 시즌별 평균 times_tied 추이를 보여줘 (차트용)' 요청을 처리하기 위한 조회 정의다. 주로 other_stats 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - times_tied
      - season_id
      - team_abbreviation_home
      - team_abbreviation_away
    sql_template: |-
      WITH team_games AS (
        SELECT g.season_id, o.times_tied
        FROM other_stats o
        JOIN game g ON g.game_id = o.game_id
        WHERE g.team_abbreviation_home = '{team_abbreviation}' OR g.team_abbreviation_away = '{team_abbreviation}'
      )
      SELECT
        season_id,
        printf('%d-%02d', CAST(SUBSTR(season_id, 2, 4) AS INT), (CAST(SUBSTR(season_id, 2, 4) AS INT) + 1) % 100) AS season_year,
        AVG(times_tied) AS avg_times_tied
      FROM team_games
      GROUP BY season_id
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 평균 times_tied 추이를 보여줘 (차트용)
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_045
    aliases:
      - 페인트존 득점(pts_paint) 비중이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)
    description_ko: 이 메트릭은 '페인트존 득점(pts_paint) 비중이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 그룹 집계
      / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: paint_score_ratio DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - wl_home
      - pts_home
      - team_abbreviation_away
      - wl_away
      - pts_away
      - pts_paint_home
      - pts_paint_away
    sql_template: |-
      WITH team_stats AS (
        SELECT
          g.season_id,
          g.team_abbreviation_home AS team_abbreviation,
          SUM(os.pts_paint_home) AS pts_paint,
          SUM(COALESCE(g.pts_home,0)) AS pts_total,
          SUM(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_home IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id,
          g.team_abbreviation_away AS team_abbreviation,
          SUM(os.pts_paint_away) AS pts_paint,
          SUM(COALESCE(g.pts_away,0)) AS pts_total,
          SUM(CASE WHEN g.wl_away = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_away IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_away
      ),
      team_agg AS (
        SELECT
          season_id,
          team_abbreviation,
          SUM(pts_paint) AS total_pts_paint,
          SUM(pts_total) AS total_pts,
          SUM(wins) AS total_wins,
          SUM(games) AS total_games
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        season_id,
        team_abbreviation,
        CASE WHEN total_pts > 0 THEN CAST(total_pts_paint AS FLOAT) / total_pts ELSE 0 END AS paint_score_ratio,
        CASE WHEN total_games > 0 THEN CAST(total_wins AS FLOAT) / total_games ELSE 0 END AS win_rate,
        '{season_year}' AS season_year
      FROM team_agg
      ORDER BY paint_score_ratio DESC
      LIMIT {limit}
    examples:
      - question: 페인트존 득점(pts_paint) 비중이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_046
    aliases:
      - 패스트브레이크 득점(pts_fb)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)
    description_ko: 이 메트릭은 '패스트브레이크 득점(pts_fb)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 그룹 집계 /
      합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: fastbreak_score_ratio DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - wl_home
      - pts_home
      - team_abbreviation_away
      - wl_away
      - pts_away
      - pts_fb_home
      - pts_fb_away
    sql_template: |-
      WITH team_stats AS (
        SELECT
          g.season_id,
          g.team_abbreviation_home AS team_abbreviation,
          SUM(os.pts_fb_home) AS pts_fb,
          SUM(COALESCE(g.pts_home,0)) AS pts_total,
          SUM(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_home IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id,
          g.team_abbreviation_away AS team_abbreviation,
          SUM(os.pts_fb_away) AS pts_fb,
          SUM(COALESCE(g.pts_away,0)) AS pts_total,
          SUM(CASE WHEN g.wl_away = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_away IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_away
      ),
      team_agg AS (
        SELECT
          season_id,
          team_abbreviation,
          SUM(pts_fb) AS total_pts_fb,
          SUM(pts_total) AS total_pts,
          SUM(wins) AS total_wins,
          SUM(games) AS total_games
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        season_id,
        team_abbreviation,
        CASE WHEN total_pts > 0 THEN CAST(total_pts_fb AS FLOAT) / total_pts ELSE 0 END AS fastbreak_score_ratio,
        CASE WHEN total_games > 0 THEN CAST(total_wins AS FLOAT) / total_games ELSE 0 END AS win_rate,
        '{season_year}' AS season_year
      FROM team_agg
      ORDER BY fastbreak_score_ratio DESC
      LIMIT {limit}
    examples:
      - question: 패스트브레이크 득점(pts_fb)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_047
    aliases:
      - 세컨찬스 득점(pts_2nd_chance)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)
    description_ko: 이 메트릭은 '세컨찬스 득점(pts_2nd_chance)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 그룹
      집계 / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: second_chance_score_ratio DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - wl_home
      - pts_home
      - team_abbreviation_away
      - wl_away
      - pts_away
      - pts_2nd_chance_home
      - pts_2nd_chance_away
    sql_template: |-
      WITH team_stats AS (
        SELECT
          g.season_id,
          g.team_abbreviation_home AS team_abbreviation,
          SUM(os.pts_2nd_chance_home) AS pts_2nd_chance,
          SUM(COALESCE(g.pts_home,0)) AS pts_total,
          SUM(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_home IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id,
          g.team_abbreviation_away AS team_abbreviation,
          SUM(os.pts_2nd_chance_away) AS pts_2nd_chance,
          SUM(COALESCE(g.pts_away,0)) AS pts_total,
          SUM(CASE WHEN g.wl_away = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_away IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_away
      ),
      team_agg AS (
        SELECT
          season_id,
          team_abbreviation,
          SUM(pts_2nd_chance) AS total_pts_2nd_chance,
          SUM(pts_total) AS total_pts,
          SUM(wins) AS total_wins,
          SUM(games) AS total_games
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        season_id,
        team_abbreviation,
        CASE WHEN total_pts > 0 THEN CAST(total_pts_2nd_chance AS FLOAT) / total_pts ELSE 0 END AS second_chance_score_ratio,
        CASE WHEN total_games > 0 THEN CAST(total_wins AS FLOAT) / total_games ELSE 0 END AS win_rate,
        '{season_year}' AS season_year
      FROM team_agg
      ORDER BY second_chance_score_ratio DESC
      LIMIT {limit}
    examples:
      - question: 세컨찬스 득점(pts_2nd_chance)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_048
    aliases:
      - 턴오버로 얻은 득점(pts_off_to)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)
    description_ko: 이 메트릭은 '턴오버로 얻은 득점(pts_off_to)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 그룹 집계
      / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: off_to_score_ratio DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - wl_home
      - pts_home
      - team_abbreviation_away
      - wl_away
      - pts_away
      - pts_off_to_home
      - pts_off_to_away
    sql_template: |-
      WITH team_stats AS (
        SELECT
          g.season_id,
          g.team_abbreviation_home AS team_abbreviation,
          SUM(os.pts_off_to_home) AS pts_off_to,
          SUM(COALESCE(g.pts_home,0)) AS pts_total,
          SUM(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_home IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id,
          g.team_abbreviation_away AS team_abbreviation,
          SUM(os.pts_off_to_away) AS pts_off_to,
          SUM(COALESCE(g.pts_away,0)) AS pts_total,
          SUM(CASE WHEN g.wl_away = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_away IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_away
      ),
      team_agg AS (
        SELECT
          season_id,
          team_abbreviation,
          SUM(pts_off_to) AS total_pts_off_to,
          SUM(pts_total) AS total_pts,
          SUM(wins) AS total_wins,
          SUM(games) AS total_games
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        season_id,
        team_abbreviation,
        CASE WHEN total_pts > 0 THEN CAST(total_pts_off_to AS FLOAT) / total_pts ELSE 0 END AS off_to_score_ratio,
        CASE WHEN total_games > 0 THEN CAST(total_wins AS FLOAT) / total_games ELSE 0 END AS win_rate,
        '{season_year}' AS season_year
      FROM team_agg
      ORDER BY off_to_score_ratio DESC
      LIMIT {limit}
    examples:
      - question: 턴오버로 얻은 득점(pts_off_to)이 높은 팀과 승률의 관계를 분석해줘 (멀티스텝)
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_049
    aliases:
      - 팀 리바운드(team_rebounds)가 많은 팀과 승률의 관계를 분석해줘 (멀티스텝)
    description_ko: 이 메트릭은 '팀 리바운드(team_rebounds)가 많은 팀과 승률의 관계를 분석해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 그룹 집계
      / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: avg_team_rebounds_per_game DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - wl_home
      - pts_home
      - team_abbreviation_away
      - wl_away
      - pts_away
      - team_rebounds_home
      - team_rebounds_away
    sql_template: |-
      WITH team_stats AS (
        SELECT
          g.season_id,
          g.team_abbreviation_home AS team_abbreviation,
          SUM(os.team_rebounds_home) AS team_rebounds,
          SUM(COALESCE(g.pts_home,0)) AS pts_total,
          SUM(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_home IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id,
          g.team_abbreviation_away AS team_abbreviation,
          SUM(os.team_rebounds_away) AS team_rebounds,
          SUM(COALESCE(g.pts_away,0)) AS pts_total,
          SUM(CASE WHEN g.wl_away = 'W' THEN 1 ELSE 0 END) AS wins,
          COUNT(*) AS games
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_away IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_away
      ),
      team_agg AS (
        SELECT
          season_id,
          team_abbreviation,
          SUM(team_rebounds) AS total_team_rebounds,
          SUM(pts_total) AS total_pts,
          SUM(wins) AS total_wins,
          SUM(games) AS total_games
        FROM team_stats
        GROUP BY season_id, team_abbreviation
      )
      SELECT
        season_id,
        team_abbreviation,
        CASE WHEN total_games > 0 THEN CAST(total_team_rebounds AS FLOAT) / total_games ELSE 0 END AS avg_team_rebounds_per_game,
        CASE WHEN total_games > 0 THEN CAST(total_wins AS FLOAT) / total_games ELSE 0 END AS win_rate,
        '{season_year}' AS season_year
      FROM team_agg
      ORDER BY avg_team_rebounds_per_game DESC
      LIMIT {limit}
    examples:
      - question: 팀 리바운드(team_rebounds)가 많은 팀과 승률의 관계를 분석해줘 (멀티스텝)
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_050
    aliases:
      - 특정 시즌에서 team_turnovers(팀 턴오버) 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 team_turnovers(팀 턴오버) 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 조인 / cte / 그룹 집계 / 합계 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: total_team_turnovers DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - team_abbreviation_away
      - team_turnovers_home
      - team_turnovers_away
    sql_template: |-
      WITH team_turnovers_agg AS (
        SELECT
          g.season_id,
          g.team_abbreviation_home AS team_abbreviation,
          SUM(os.team_turnovers_home) AS total_team_turnovers
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_home IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_home
        UNION ALL
        SELECT
          g.season_id,
          g.team_abbreviation_away AS team_abbreviation,
          SUM(os.team_turnovers_away) AS total_team_turnovers
        FROM game g
        JOIN other_stats os ON g.game_id = os.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_away IS NOT NULL
        GROUP BY g.season_id, g.team_abbreviation_away
      )
      SELECT
        season_id,
        team_abbreviation,
        SUM(total_team_turnovers) AS total_team_turnovers
      FROM team_turnovers_agg
      GROUP BY season_id, team_abbreviation
      ORDER BY total_team_turnovers DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 team_turnovers(팀 턴오버) 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_008
    aliases:
      - 특정 시즌에서 total_turnovers(총 턴오버) 상위 10팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 total_turnovers(총 턴오버) 상위 10팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game 테이블을 활용해 조인 / cte / 그룹 집계 / 합계
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: total_turnovers DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - total_turnovers_home
      - team_abbreviation_away
      - total_turnovers_away
      - season_id
    sql_template: |-
      WITH turnovers_agg AS (
        SELECT
          g.team_abbreviation_home AS team_abbreviation,
          SUM(o.total_turnovers_home) AS total_turnovers
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_home
        UNION ALL
        SELECT
          g.team_abbreviation_away AS team_abbreviation,
          SUM(o.total_turnovers_away) AS total_turnovers
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_away
      ),
      team_turnovers_sum AS (
        SELECT
          team_abbreviation,
          SUM(total_turnovers) AS total_turnovers
        FROM turnovers_agg
        GROUP BY team_abbreviation
      )
      SELECT
        team_abbreviation,
        total_turnovers,
        '{season_year}' AS season_year
      FROM team_turnovers_sum
      ORDER BY total_turnovers DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 total_turnovers(총 턴오버) 상위 10팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_009
    aliases:
      - 'team_turnovers와 total_turnovers 차이가 큰 팀을 찾아줘 (의미: 팀/상대 기여 분리)'
    description_ko: '이 메트릭은 ''team_turnovers와 total_turnovers 차이가 큰 팀을 찾아줘 (의미: 팀/상대 기여 분리)'' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game 테이블을 활용해
      조인 / cte / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: AVG · 정렬: avg_turnovers_diff DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - team_turnovers_home
      - total_turnovers_home
      - team_abbreviation_away
      - team_turnovers_away
      - total_turnovers_away
      - season_id
    sql_template: |-
      WITH turnovers_diff AS (
        SELECT
          g.team_abbreviation_home AS team_abbreviation,
          AVG(ABS(o.team_turnovers_home - o.total_turnovers_home)) AS turnovers_diff
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_home
        UNION ALL
        SELECT
          g.team_abbreviation_away AS team_abbreviation,
          AVG(ABS(o.team_turnovers_away - o.total_turnovers_away)) AS turnovers_diff
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_away
      ),
      turnovers_diff_agg AS (
        SELECT
          team_abbreviation,
          AVG(turnovers_diff) AS avg_turnovers_diff
        FROM turnovers_diff
        GROUP BY team_abbreviation
      )
      SELECT
        team_abbreviation,
        avg_turnovers_diff,
        '{season_year}' AS season_year
      FROM turnovers_diff_agg
      ORDER BY avg_turnovers_diff DESC
      LIMIT {limit}
    examples:
      - question: 'team_turnovers와 total_turnovers 차이가 큰 팀을 찾아줘 (의미: 팀/상대 기여 분리)'
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_051
    aliases:
      - 특정 시즌에서 “largest_lead가 큰데 패배한” 경기 목록을 보여줘 (블로운 리드 후보)
    description_ko: 이 메트릭은 '특정 시즌에서 “largest_lead가 큰데 패배한” 경기 목록을 보여줘 (블로운 리드 후보)' 요청을 처리하기 위한 조회 정의다. 주로 game, other_stats 테이블을 활용해 기본 조회/필터 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: largest_lead_losing_team DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - other_stats
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - game_date
      - wl_home
      - team_abbreviation_away
      - wl_away
      - largest_lead_home
      - largest_lead_away
    sql_template: |-
      SELECT
        game.game_id,
        game.game_date,
        game.team_abbreviation_home AS home_team,
        game.team_abbreviation_away AS away_team,
        CASE
          WHEN game.wl_home = 'L' THEN other_stats.largest_lead_home
          WHEN game.wl_away = 'L' THEN other_stats.largest_lead_away
          ELSE NULL
        END AS largest_lead_losing_team,
        '{season_year}' AS season_year
      FROM game
      JOIN other_stats ON game.game_id = other_stats.game_id
      WHERE season_id = '{season_id}'
        AND ((game.wl_home = 'L' AND other_stats.largest_lead_home > 0) OR (game.wl_away = 'L' AND other_stats.largest_lead_away > 0))
      ORDER BY largest_lead_losing_team DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 “largest_lead가 큰데 패배한” 경기 목록을 보여줘 (블로운 리드 후보)
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_052
    aliases:
      - 시즌별 리그 평균 관중 추이를 보여줘 (차트용)
    description_ko: 이 메트릭은 '시즌별 리그 평균 관중 추이를 보여줘 (차트용)' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - attendance
      - season_id
    sql_template: SELECT season_id, AVG(attendance) AS avg_attendance FROM game_info JOIN game USING(game_id) WHERE season_id = '{season_id}' GROUP
      BY season_id ORDER BY season_id LIMIT {limit}
    examples:
      - question: 시즌별 리그 평균 관중 추이를 보여줘 (차트용)
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_053
    aliases:
      - 시즌별 리그 평균 관중과 리그 평균 득점(경기당)을 같이 추세로 비교해줘 (차트용, 멀티스텝)
    description_ko: 이 메트릭은 '시즌별 리그 평균 관중과 리그 평균 득점(경기당)을 같이 추세로 비교해줘 (차트용, 멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / cte / 그룹
      집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - attendance
      - season_id
      - pts_home
      - pts_away
    sql_template: WITH season_stats AS ( SELECT season_id, AVG(attendance) AS avg_attendance, AVG(pts_home + pts_away) AS avg_points FROM game_info
      JOIN game USING(game_id) WHERE season_id = '{season_id}' GROUP BY season_id ) SELECT season_id, avg_attendance, avg_points FROM season_stats
      ORDER BY season_id LIMIT {limit}
    examples:
      - question: 시즌별 리그 평균 관중과 리그 평균 득점(경기당)을 같이 추세로 비교해줘 (차트용, 멀티스텝)
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_054
    aliases:
      - 특정 팀의 시즌별 홈 평균 관중 추이를 보여줘 (차트용)
    description_ko: 이 메트릭은 '특정 팀의 시즌별 홈 평균 관중 추이를 보여줘 (차트용)' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - attendance
      - season_id
      - team_abbreviation_home
    sql_template: SELECT season_id, AVG(attendance) AS avg_attendance FROM game_info JOIN game USING(game_id) WHERE season_id = '{season_id}' AND
      team_abbreviation_home = '{team_abbreviation}' GROUP BY season_id ORDER BY season_id LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 홈 평균 관중 추이를 보여줘 (차트용)
        params:
          limit: 200
          season_id: '22022'
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_055
    aliases:
      - 특정 팀의 월별(홈경기) 평균 관중 추이를 보여줘 (차트용)
    description_ko: 이 메트릭은 '특정 팀의 월별(홈경기) 평균 관중 추이를 보여줘 (차트용)' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: year_month · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - game_date
      - attendance
      - season_id
      - team_abbreviation_home
    sql_template: |-
      SELECT
        strftime('%Y-%m', g.game_date) AS year_month,
        AVG(gi.attendance) AS avg_attendance
      FROM game_info gi
      JOIN game g ON gi.game_id = g.game_id
      WHERE g.team_abbreviation_home = '{team_abbreviation}'
        AND g.season_id = '{season_id}'
        AND gi.attendance IS NOT NULL
      GROUP BY year_month
      ORDER BY year_month
      LIMIT {limit}
    examples:
      - question: 특정 팀의 월별(홈경기) 평균 관중 추이를 보여줘 (차트용)
        params:
          limit: 200
          season_id: '22022'
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_056
    aliases:
      - 관중이 많은 경기 TOP 50에서 연장전 비율이 높은지 분석해줘 (멀티스텝)
    description_ko: 이 메트릭은 '관중이 많은 경기 TOP 50에서 연장전 비율이 높은지 분석해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / cte / 카운트 / 정렬 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: attendance DESC · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - attendance
      - min
    sql_template: |-
      WITH top_games AS (
        SELECT game_id, attendance
        FROM game_info
        WHERE attendance IS NOT NULL
        ORDER BY attendance DESC
        LIMIT 50
      ),
      ot_games AS (
        SELECT g.game_id
        FROM game g
        JOIN top_games t ON g.game_id = t.game_id
        WHERE g.min > 48
      )
      SELECT
        (SELECT COUNT(*) FROM ot_games) * 1.0 / 50.0 AS overtime_ratio
      LIMIT {limit}
    examples:
      - question: 관중이 많은 경기 TOP 50에서 연장전 비율이 높은지 분석해줘 (멀티스텝)
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_057
    aliases:
      - 관중이 많은 경기 TOP 50에서 접전 경기 비율이 높은지 분석해줘
    description_ko: 이 메트릭은 '관중이 많은 경기 TOP 50에서 접전 경기 비율이 높은지 분석해줘' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / cte / 카운트 / 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: attendance DESC · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - attendance
      - pts_home
      - pts_away
    sql_template: WITH top_games AS ( SELECT game_id, attendance FROM game_info ORDER BY attendance DESC LIMIT 50 ), close_games AS ( SELECT g.game_id
      FROM game g JOIN top_games t ON g.game_id = t.game_id WHERE ABS(pts_home - pts_away) <= {margin} ) SELECT (SELECT COUNT(*) FROM close_games)
      * 1.0 / 50.0 AS close_game_ratio LIMIT {limit}
    examples:
      - question: 관중이 많은 경기 TOP 50에서 접전 경기 비율이 높은지 분석해줘
        params:
          limit: 10
          margin: 5
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_058
    aliases:
      - 특정 시즌에서 관중이 가장 많았던 “매치업” TOP 20을 보여줘 (홈/원정 조합 기준)
    description_ko: 이 메트릭은 '특정 시즌에서 관중이 가장 많았던 “매치업” TOP 20을 보여줘 (홈/원정 조합 기준)' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: attendance DESC · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - attendance
      - season_id
      - matchup_home
    sql_template: SELECT matchup_home AS matchup, attendance FROM game_info JOIN game USING(game_id) WHERE season_id = '{season_id}' ORDER BY attendance
      DESC LIMIT {limit};
    examples:
      - question: 특정 시즌에서 관중이 가장 많았던 “매치업” TOP 20을 보여줘 (홈/원정 조합 기준)
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_059
    aliases:
      - 특정 팀 홈경기 중 관중 TOP 20 경기와 그 결과(승패/점수)를 보여줘
    description_ko: 이 메트릭은 '특정 팀 홈경기 중 관중 TOP 20 경기와 그 결과(승패/점수)를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, game_info 테이블을 활용해 조인 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: gi.attendance DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_info
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - wl_home
      - pts_home
      - pts_away
      - attendance
    sql_template: SELECT g.game_id, gi.attendance, g.wl_home AS result, g.pts_home, g.pts_away FROM game g JOIN game_info gi ON g.game_id = gi.game_id
      WHERE g.team_abbreviation_home = '{team_abbreviation}' AND g.season_id = '{season_id}' ORDER BY gi.attendance DESC LIMIT {limit};
    examples:
      - question: 특정 팀 홈경기 중 관중 TOP 20 경기와 그 결과(승패/점수)를 보여줘
        params:
          limit: 10
          season_id: '22022'
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_060
    aliases:
      - 특정 시즌에서 경기 시간(game_time)이 가장 긴 경기 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 경기 시간(game_time)이 가장 긴 경기 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: game_time DESC · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - game_date
      - game_time
      - season_id
    sql_template: SELECT game_id, game_date, game_time FROM game_info WHERE game_id IN (SELECT game_id FROM game WHERE season_id = '{season_id}')
      ORDER BY game_time DESC LIMIT {limit}
    examples:
      - question: 특정 시즌에서 경기 시간(game_time)이 가장 긴 경기 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_061
    aliases:
      - 경기 시간이 긴 경기는 연장전 비율이 높은지 분석해줘
    description_ko: 이 메트릭은 '경기 시간이 긴 경기는 연장전 비율이 높은지 분석해줘' 요청을 처리하기 위한 조회 정의다. 주로 game, line_score 테이블을 활용해 조인 / cte / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: game_time DESC) AS rn FROM game_overtime ) SELECT ''long_games_overtime_rate'' AS metric, AVG(has_overtime) AS
      overtime_rate_long_games FROM ranked_games WHERE rn <= { · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_info
    required_columns:
      - season_id
      - game_id
      - game_time
      - min
    sql_template: |-
      WITH game_overtime AS (
        SELECT
          g.game_id,
          gi.game_time,
          CASE WHEN g.min > 48 THEN 1 ELSE 0 END AS has_overtime
        FROM game g
        JOIN game_info gi ON g.game_id = gi.game_id
        WHERE g.season_id = '{season_id}'
          AND gi.game_time IS NOT NULL
          AND gi.game_time != ''
          AND INSTR(gi.game_time, ':') > 0
      ),
      parsed AS (
        SELECT
          game_id,
          (CAST(SUBSTR(game_time, 1, INSTR(game_time, ':') - 1) AS INT) * 60
           + CAST(SUBSTR(game_time, INSTR(game_time, ':') + 1) AS INT)) AS game_time_value,
          has_overtime
        FROM game_overtime
      ),
      ranked AS (
        SELECT
          game_id,
          game_time_value,
          has_overtime,
          ROW_NUMBER() OVER (ORDER BY game_time_value DESC) AS rn
        FROM parsed
      ),
      long_games AS (
        SELECT has_overtime
        FROM ranked
        WHERE rn <= {limit}
      )
      SELECT
        'long_games_overtime_rate' AS metric,
        AVG(has_overtime) AS overtime_rate
      FROM long_games
      UNION ALL
      SELECT
        'all_games_overtime_rate' AS metric,
        AVG(has_overtime) AS overtime_rate
      FROM parsed
      LIMIT {limit}
    examples:
      - question: 경기 시간이 긴 경기는 연장전 비율이 높은지 분석해줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_001
    aliases:
      - 특정 시즌 심판별 배정 경기 수 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌 심판별 배정 경기 수 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 officials, game 테이블을 활용해 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: game_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - game
    required_columns:
      - game_id
      - official_id
      - first_name
      - last_name
      - season_id
    sql_template: |-
      SELECT
        o.official_id,
        o.first_name || ' ' || o.last_name AS official_name,
        COUNT(DISTINCT o.game_id) AS game_count
      FROM officials o
      JOIN game g ON o.game_id = g.game_id
      WHERE g.season_id = '{season_id}'
      GROUP BY o.official_id, o.first_name, o.last_name
      ORDER BY game_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 심판별 배정 경기 수 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_002
    aliases:
      - 특정 시즌 심판별 홈팀 승률을 보여줘 (편향 여부 탐색)
    description_ko: 이 메트릭은 '특정 시즌 심판별 홈팀 승률을 보여줘 (편향 여부 탐색)' 요청을 처리하기 위한 조회 정의다. 주로 officials, game 테이블을 활용해 조인 / cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: home_win_rate DESC · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - game
    required_columns:
      - game_id
      - official_id
      - first_name
      - last_name
      - season_id
      - wl_home
    sql_template: |-
      WITH official_games AS (
        SELECT
          o.official_id,
          o.first_name || ' ' || o.last_name AS official_name,
          g.wl_home
        FROM officials o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY o.official_id, o.first_name, o.last_name, o.game_id, g.wl_home
      )
      SELECT
        official_id,
        official_name,
        COUNT(*) AS total_games,
        SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS home_win_rate
      FROM official_games
      GROUP BY official_id, official_name
      ORDER BY home_win_rate DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 심판별 홈팀 승률을 보여줘 (편향 여부 탐색)
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_003
    aliases:
      - 특정 시즌 심판별 평균 파울(pf_home+pf_away) 콜 수를 보여줘
    description_ko: 이 메트릭은 '특정 시즌 심판별 평균 파울(pf_home+pf_away) 콜 수를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 officials, game 테이블을 활용해 조인 / cte / 그룹 집계 / 평균 / 카운트
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG/COUNT · 정렬: avg_pf DESC · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - game
    required_columns:
      - game_id
      - official_id
      - first_name
      - last_name
      - season_id
      - pf_home
      - pf_away
    sql_template: |-
      WITH pf_per_game AS (
        SELECT
          o.official_id,
          o.first_name || ' ' || o.last_name AS official_name,
          g.game_id,
          (g.pf_home + g.pf_away) AS total_pf
        FROM officials o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY o.official_id, o.first_name, o.last_name, g.game_id, g.pf_home, g.pf_away
      )
      SELECT
        official_id,
        official_name,
        COUNT(game_id) AS game_count,
        AVG(total_pf) AS avg_pf
      FROM pf_per_game
      GROUP BY official_id, official_name
      ORDER BY avg_pf DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 심판별 평균 파울(pf_home+pf_away) 콜 수를 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_004
    aliases:
      - 특정 시즌 심판별 평균 자유투 시도(fta_home+fta_away) 콜 수를 보여줘
    description_ko: 이 메트릭은 '특정 시즌 심판별 평균 자유투 시도(fta_home+fta_away) 콜 수를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 officials, game 테이블을 활용해 조인 / cte / 그룹 집계 /
      평균 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG/COUNT · 정렬: avg_fta DESC · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - game
    required_columns:
      - game_id
      - official_id
      - first_name
      - last_name
      - season_id
      - fta_home
      - fta_away
    sql_template: |-
      WITH fta_per_game AS (
        SELECT
          o.official_id,
          o.first_name || ' ' || o.last_name AS official_name,
          g.game_id,
          (g.fta_home + g.fta_away) AS total_fta
        FROM officials o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY o.official_id, o.first_name, o.last_name, g.game_id, g.fta_home, g.fta_away
      )
      SELECT
        official_id,
        official_name,
        COUNT(game_id) AS game_count,
        AVG(total_fta) AS avg_fta
      FROM fta_per_game
      GROUP BY official_id, official_name
      ORDER BY avg_fta DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌 심판별 평균 자유투 시도(fta_home+fta_away) 콜 수를 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_005
    aliases:
      - 특정 심판이 가장 자주 배정된 팀 TOP 10을 보여줘
    description_ko: 이 메트릭은 '특정 심판이 가장 자주 배정된 팀 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 officials, game 테이블을 활용해 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: game_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - game
    required_columns:
      - game_id
      - official_id
      - team_id_home
      - team_abbreviation_home
      - team_abbreviation_away
    sql_template: |-
      SELECT
        CASE
          WHEN g.team_id_home IS NOT NULL THEN g.team_abbreviation_home
          ELSE g.team_abbreviation_away
        END AS team_abbreviation,
        COUNT(DISTINCT g.game_id) AS game_count
      FROM officials o
      JOIN game g ON o.game_id = g.game_id
      WHERE o.official_id = '{official_id}'
      GROUP BY team_abbreviation
      ORDER BY game_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 심판이 가장 자주 배정된 팀 TOP 10을 보여줘
        params:
          limit: 10
          official_id: '20001'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_006
    aliases:
      - 특정 팀 경기에서 가장 자주 등장하는 심판 TOP 10을 보여줘
    description_ko: 이 메트릭은 '특정 팀 경기에서 가장 자주 등장하는 심판 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 officials, game 테이블을 활용해 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: game_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - game
    required_columns:
      - game_id
      - official_id
      - first_name
      - last_name
      - team_abbreviation_home
      - team_abbreviation_away
    sql_template: |-
      SELECT
        o.official_id,
        o.first_name || ' ' || o.last_name AS official_name,
        COUNT(DISTINCT o.game_id) AS game_count
      FROM officials o
      JOIN game g ON o.game_id = g.game_id
      WHERE (g.team_abbreviation_home = '{team_abbreviation}' OR g.team_abbreviation_away = '{team_abbreviation}')
      GROUP BY o.official_id, o.first_name, o.last_name
      ORDER BY game_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 팀 경기에서 가장 자주 등장하는 심판 TOP 10을 보여줘
        params:
          limit: 10
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_007
    aliases:
      - 심판 조합(3인 crew)별 등장 빈도 TOP 20을 보여줘 (멀티스텝/집계)
    description_ko: 이 메트릭은 '심판 조합(3인 crew)별 등장 빈도 TOP 20을 보여줘 (멀티스텝/집계)' 요청을 처리하기 위한 조회 정의다. 주로 officials 테이블을 활용해 cte / 그룹 집계 / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: crew_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - officials
    required_columns:
      - game_id
      - official_id
    sql_template: |-
      WITH distinct_officials AS (
        SELECT DISTINCT game_id, official_id
        FROM officials
      ),
      ranked AS (
        SELECT
          game_id,
          official_id,
          ROW_NUMBER() OVER (PARTITION BY game_id ORDER BY official_id) AS rn,
          COUNT(*) OVER (PARTITION BY game_id) AS cnt
        FROM distinct_officials
      ),
      crew AS (
        SELECT
          game_id,
          MAX(CASE WHEN rn = 1 THEN official_id END) AS first_official,
          MAX(CASE WHEN rn = 2 THEN official_id END) AS second_official,
          MAX(CASE WHEN rn = 3 THEN official_id END) AS third_official
        FROM ranked
        WHERE cnt = 3
        GROUP BY game_id
      ),
      crew_grouped AS (
        SELECT first_official, second_official, third_official, COUNT(*) AS crew_count
        FROM crew
        GROUP BY first_official, second_official, third_official
      )
      SELECT
        first_official,
        second_official,
        third_official,
        crew_count
      FROM crew_grouped
      ORDER BY crew_count DESC
      LIMIT {limit}
    examples:
      - question: 심판 조합(3인 crew)별 등장 빈도 TOP 20을 보여줘 (멀티스텝/집계)
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_062
    aliases:
      - 심판별 연장전 경기 비율(OT 포함 경기 비중)을 보여줘
    description_ko: 이 메트릭은 '심판별 연장전 경기 비율(OT 포함 경기 비중)을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, officials 테이블을 활용해 조인 / cte / 합계 / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: ot_ratio DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - officials
    required_columns:
      - season_id
      - game_id
      - min
      - official_id
      - first_name
      - last_name
    sql_template: |-
      WITH ot_games AS (
        SELECT
          g.game_id,
          CASE WHEN g.min > 48 THEN 1 ELSE 0 END AS is_ot
        FROM game g
        WHERE g.season_id = '{season_id}'
      ),
      official_games AS (
        SELECT
          o.official_id,
          o.first_name || ' ' || o.last_name AS official_name,
          o.game_id
        FROM officials o
        JOIN ot_games og ON o.game_id = og.game_id
      )
      SELECT
        og.official_id,
        og.official_name,
        COUNT(og.game_id) AS total_games,
        SUM(CASE WHEN g.min > 48 THEN 1 ELSE 0 END) * 1.0 / COUNT(og.game_id) AS ot_ratio
      FROM official_games og
      JOIN game g ON og.game_id = g.game_id
      WHERE g.season_id = '{season_id}'
      GROUP BY og.official_id, og.official_name
      ORDER BY ot_ratio DESC
      LIMIT {limit}
    examples:
      - question: 심판별 연장전 경기 비율(OT 포함 경기 비중)을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_008
    aliases:
      - 심판별 리드 체인지 평균(lead_changes)과 동점(times_tied) 평균을 보여줘
    description_ko: 이 메트릭은 '심판별 리드 체인지 평균(lead_changes)과 동점(times_tied) 평균을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 officials, other_stats 테이블을 활용해 조인 / cte
      / 그룹 집계 / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - other_stats
    required_columns:
      - game_id
      - official_id
      - lead_changes
      - times_tied
    sql_template: WITH game_officials AS (SELECT DISTINCT game_id, official_id FROM officials) SELECT o.official_id, AVG(os.lead_changes) AS avg_lead_changes,
      AVG(os.times_tied) AS avg_times_tied FROM game_officials o JOIN other_stats os ON o.game_id = os.game_id GROUP BY o.official_id LIMIT {limit}
    examples:
      - question: 심판별 리드 체인지 평균(lead_changes)과 동점(times_tied) 평균을 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_009
    aliases:
      - 심판별 관중 평균을 보여줘 (흥행 경기 배정 경향)
    description_ko: 이 메트릭은 '심판별 관중 평균을 보여줘 (흥행 경기 배정 경향)' 요청을 처리하기 위한 조회 정의다. 주로 officials, game_info 테이블을 활용해 조인 / cte / 그룹 집계 / 평균 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - game_info
    required_columns:
      - game_id
      - official_id
      - attendance
    sql_template: WITH game_officials AS (SELECT DISTINCT game_id, official_id FROM officials) SELECT o.official_id, AVG(gi.attendance) AS avg_attendance
      FROM game_officials o JOIN game_info gi ON o.game_id = gi.game_id GROUP BY o.official_id LIMIT {limit}
    examples:
      - question: 심판별 관중 평균을 보여줘 (흥행 경기 배정 경향)
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_001
    aliases:
      - 활동 중(is_active=1) 선수 목록을 보여줘
    description_ko: 이 메트릭은 '활동 중(is_active=1) 선수 목록을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 player 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에
      따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - player
    required_columns:
      - id
      - full_name
      - first_name
      - last_name
      - is_active
    sql_template: SELECT id, full_name, first_name, last_name FROM player WHERE is_active = 1 LIMIT {limit}
    examples:
      - question: 활동 중(is_active=1) 선수 목록을 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_002
    aliases:
      - 활동 중 선수 중 포지션별 인원수를 보여줘
    description_ko: 이 메트릭은 '활동 중 선수 중 포지션별 인원수를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: player_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - position
      - rosterstatus
    sql_template: SELECT position, COUNT(*) AS player_count FROM common_player_info WHERE rosterstatus = 'Active' GROUP BY position ORDER BY player_count
      DESC LIMIT {limit}
    examples:
      - question: 활동 중 선수 중 포지션별 인원수를 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_003
    aliases:
      - 포지션별 평균 키/몸무게를 보여줘
    description_ko: 이 메트릭은 '포지션별 평균 키/몸무게를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: position · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - height
      - weight
      - position
    sql_template: SELECT position, AVG(height) AS avg_height, AVG(weight) AS avg_weight FROM common_player_info WHERE height IS NOT NULL AND weight
      IS NOT NULL GROUP BY position ORDER BY position LIMIT {limit}
    examples:
      - question: 포지션별 평균 키/몸무게를 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_004
    aliases:
      - 키 상위 20명 선수와 포지션/국가/학교를 보여줘
    description_ko: 이 메트릭은 '키 상위 20명 선수와 포지션/국가/학교를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: height DESC · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - display_first_last
      - school
      - country
      - height
      - position
    sql_template: SELECT display_first_last AS player_name, position, country, school, height FROM common_player_info WHERE height IS NOT NULL ORDER
      BY height DESC LIMIT {limit}
    examples:
      - question: 키 상위 20명 선수와 포지션/국가/학교를 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_005
    aliases:
      - 몸무게 상위 20명 선수와 포지션/국가/학교를 보여줘
    description_ko: 이 메트릭은 '몸무게 상위 20명 선수와 포지션/국가/학교를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: weight DESC · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - display_first_last
      - school
      - country
      - weight
      - position
    sql_template: SELECT display_first_last AS player_name, position, country, school, weight FROM common_player_info WHERE weight IS NOT NULL ORDER
      BY weight DESC LIMIT {limit}
    examples:
      - question: 몸무게 상위 20명 선수와 포지션/국가/학교를 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_006
    aliases:
      - 국가(country)별 선수 수 TOP 20을 보여줘 (기존 분포의 변형)
    description_ko: 이 메트릭은 '국가(country)별 선수 수 TOP 20을 보여줘 (기존 분포의 변형)' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 카운트 / 정렬 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: player_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - country
    sql_template: SELECT country, COUNT(*) AS player_count FROM common_player_info WHERE country IS NOT NULL GROUP BY country ORDER BY player_count
      DESC LIMIT {limit};
    examples:
      - question: 국가(country)별 선수 수 TOP 20을 보여줘 (기존 분포의 변형)
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_007
    aliases:
      - 국가별 평균 키/몸무게를 보여줘
    description_ko: 이 메트릭은 '국가별 평균 키/몸무게를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: country · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - country
      - height
      - weight
    sql_template: SELECT country, AVG(height) AS avg_height, AVG(weight) AS avg_weight FROM common_player_info WHERE country IS NOT NULL AND height
      IS NOT NULL AND weight IS NOT NULL GROUP BY country ORDER BY country LIMIT {limit}
    examples:
      - question: 국가별 평균 키/몸무게를 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_008
    aliases:
      - 학교(school) 출신 선수 수 TOP 20을 보여줘
    description_ko: 이 메트릭은 '학교(school) 출신 선수 수 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: player_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - school
    sql_template: SELECT school, COUNT(*) AS player_count FROM common_player_info WHERE school IS NOT NULL GROUP BY school ORDER BY player_count
      DESC LIMIT {limit};
    examples:
      - question: 학교(school) 출신 선수 수 TOP 20을 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_009
    aliases:
      - 특정 학교 출신 선수들의 포지션 분포를 보여줘
    description_ko: 이 메트릭은 '특정 학교 출신 선수들의 포지션 분포를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: player_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - school
      - position
    sql_template: SELECT position, COUNT(*) AS player_count FROM common_player_info WHERE school = '{school}' GROUP BY position ORDER BY player_count
      DESC LIMIT {limit}
    examples:
      - question: 특정 학교 출신 선수들의 포지션 분포를 보여줘
        params:
          limit: 200
          school: Duke
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_010
    aliases:
      - 드래프트 연도(draft_year)별 선수 수를 보여줘
    description_ko: 이 메트릭은 '드래프트 연도(draft_year)별 선수 수를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: draft_year · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - draft_year
    sql_template: SELECT draft_year, COUNT(*) AS player_count FROM common_player_info WHERE draft_year IS NOT NULL GROUP BY draft_year ORDER BY
      draft_year LIMIT {limit}
    examples:
      - question: 드래프트 연도(draft_year)별 선수 수를 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_001
    aliases:
      - 드래프트 라운드(draft_round)별 선수 수를 보여줘
    description_ko: 이 메트릭은 '드래프트 라운드(draft_round)별 선수 수를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history 테이블을 활용해 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: draft_round · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - round_number
    sql_template: SELECT round_number AS draft_round, COUNT(*) AS player_count FROM draft_history WHERE round_number IS NOT NULL GROUP BY round_number
      ORDER BY round_number LIMIT {limit}
    examples:
      - question: 드래프트 라운드(draft_round)별 선수 수를 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_011
    aliases:
      - 드래프트 픽(draft_number) 상위(=낮은 숫자) 선수들의 평균 커리어 길이를 분석해줘
    description_ko: 이 메트릭은 '드래프트 픽(draft_number) 상위(=낮은 숫자) 선수들의 평균 커리어 길이를 분석해줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 평균 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - from_year
      - to_year
      - draft_number
    sql_template: SELECT AVG(to_year - from_year + 1) AS avg_career_length FROM common_player_info WHERE draft_number IS NOT NULL AND draft_number
      <= {n} LIMIT {limit}
    examples:
      - question: 드래프트 픽(draft_number) 상위(=낮은 숫자) 선수들의 평균 커리어 길이를 분석해줘
        params:
          limit: 200
          n: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_012
    aliases:
      - 특정 팀의 현재 로스터(활동중/로스터status)와 포지션을 표로 보여줘
    description_ko: 이 메트릭은 '특정 팀의 현재 로스터(활동중/로스터status)와 포지션을 표로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: full_name · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - display_first_last
      - season_exp
      - position
      - rosterstatus
      - team_abbreviation
    sql_template: SELECT display_first_last AS player_name, position, season_exp FROM common_player_info WHERE team_abbreviation = '{team_abbreviation}'
      AND rosterstatus = 'Active' ORDER BY display_first_last LIMIT {limit}
    examples:
      - question: 특정 팀의 현재 로스터(활동중/로스터status)와 포지션을 표로 보여줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_013
    aliases:
      - 팀별 로스터 평균 커리어 연차(season_exp)를 보여줘
    description_ko: 이 메트릭은 '팀별 로스터 평균 커리어 연차(season_exp)를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_season_exp DESC · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - season_exp
      - rosterstatus
      - team_abbreviation
    sql_template: SELECT team_abbreviation, AVG(season_exp) AS avg_season_exp FROM common_player_info WHERE rosterstatus = 'Active' GROUP BY team_abbreviation
      ORDER BY avg_season_exp DESC LIMIT {limit}
    examples:
      - question: 팀별 로스터 평균 커리어 연차(season_exp)를 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: player_014
    aliases:
      - 특정 팀의 평균 키/몸무게/연차를 시즌별로 비교할 수 있나? 가능한 범위에서 보여줘
    description_ko: 이 메트릭은 '특정 팀의 평균 키/몸무게/연차를 시즌별로 비교할 수 있나? 가능한 범위에서 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 common_player_info 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG(현재 로스터 기준) · 제한: LIMIT {limit}'
    required_tables:
      - common_player_info
    required_columns:
      - height
      - weight
      - season_exp
      - team_abbreviation
      - rosterstatus
    sql_template: |-
      WITH roster AS (
        SELECT
          team_abbreviation,
          CAST(season_exp AS REAL) AS season_exp,
          CASE
            WHEN height LIKE '%-%' THEN CAST(SUBSTR(height, 1, INSTR(height, '-') - 1) AS INT) * 12
              + CAST(SUBSTR(height, INSTR(height, '-') + 1) AS INT)
            ELSE NULL
          END AS height_in,
          CAST(weight AS REAL) AS weight_lb
        FROM common_player_info
        WHERE team_abbreviation = '{team_abbreviation}' AND rosterstatus = 'Active'
      )
      SELECT
        team_abbreviation,
        ROUND(AVG(height_in), 1) AS avg_height_in,
        ROUND(AVG(weight_lb), 1) AS avg_weight_lb,
        ROUND(AVG(season_exp), 2) AS avg_season_exp,
        'common_player_info에는 시즌별 로스터 히스토리가 없어 현재 로스터 기준으로 계산했습니다.' AS note
      FROM roster
      GROUP BY team_abbreviation
      LIMIT {limit}
    examples:
      - question: 특정 팀의 평균 키/몸무게/연차를 시즌별로 비교할 수 있나? 가능한 범위에서 보여줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_002
    aliases:
      - (멀티스텝) 드래프트 1라운드 출신이 많은 팀과 시즌 성적의 관계를 분석해줘
    description_ko: 이 메트릭은 '(멀티스텝) 드래프트 1라운드 출신이 많은 팀과 시즌 성적의 관계를 분석해줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history, game 테이블을 활용해 조인 / cte / 그룹 집계 / 합계
      / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: f.season, f.first_round_players DESC · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
      - game
    required_columns:
      - season
      - round_number
      - team_abbreviation
      - season_id
      - team_abbreviation_home
      - wl_home
      - team_abbreviation_away
      - wl_away
    sql_template: |-
      WITH first_round_counts AS (
        SELECT team_abbreviation, season, COUNT(*) AS first_round_players
        FROM draft_history
        WHERE round_number = 1
        GROUP BY team_abbreviation, season
      ),
      team_season_performance AS (
        SELECT season_id, team_abbreviation_home AS team_abbreviation, wl_home AS win_loss
        FROM game
        UNION ALL
        SELECT season_id, team_abbreviation_away AS team_abbreviation, wl_away AS win_loss
        FROM game
      ),
      team_wins AS (
        SELECT season_id, team_abbreviation, SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS wins, COUNT(*) AS games_played
        FROM team_season_performance
        GROUP BY season_id, team_abbreviation
      )
      SELECT f.season AS season_id, f.team_abbreviation, f.first_round_players, COALESCE(t.wins, 0) AS wins, COALESCE(t.games_played, 0) AS games_played
      FROM first_round_counts f
      LEFT JOIN team_wins t ON f.season = t.season_id AND f.team_abbreviation = t.team_abbreviation
      ORDER BY f.season, f.first_round_players DESC
      LIMIT {limit}
    examples:
      - question: (멀티스텝) 드래프트 1라운드 출신이 많은 팀과 시즌 성적의 관계를 분석해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_003
    aliases:
      - '특정 연도 드래프트 전체 픽(1~60) 리스트를 보여줘 (기존 기능 변형: 라운드/팀/출신 포함)'
    description_ko: '이 메트릭은 ''특정 연도 드래프트 전체 픽(1~60) 리스트를 보여줘 (기존 기능 변형: 라운드/팀/출신 포함)'' 요청을 처리하기 위한 조회 정의다. 주로 draft_history 테이블을 활용해 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: SELECT · 정렬: overall_pick · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - season
      - player_name
      - round_number
      - overall_pick
      - team_abbreviation
      - organization
      - organization_type
    sql_template: SELECT season AS draft_year, round_number, overall_pick, player_name, team_abbreviation, organization, organization_type FROM draft_history
      WHERE season = '{draft_year}' AND overall_pick BETWEEN 1 AND 60 ORDER BY overall_pick LIMIT {limit}
    examples:
      - question: '특정 연도 드래프트 전체 픽(1~60) 리스트를 보여줘 (기존 기능 변형: 라운드/팀/출신 포함)'
        params:
          draft_year: 2018
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_004
    aliases:
      - 특정 연도 1라운드 픽 리스트만 보여줘
    description_ko: 이 메트릭은 '특정 연도 1라운드 픽 리스트만 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가
      달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: overall_pick · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - season
      - player_name
      - round_number
      - overall_pick
      - team_abbreviation
      - organization
      - organization_type
    sql_template: SELECT season AS draft_year, round_number, overall_pick, player_name, team_abbreviation, organization, organization_type FROM draft_history
      WHERE season = '{draft_year}' AND round_number = 1 ORDER BY overall_pick LIMIT {limit}
    examples:
      - question: 특정 연도 1라운드 픽 리스트만 보여줘
        params:
          draft_year: 2018
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_005
    aliases:
      - 특정 연도 2라운드 픽 리스트만 보여줘
    description_ko: 이 메트릭은 '특정 연도 2라운드 픽 리스트만 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가
      달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: overall_pick · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - season
      - player_name
      - round_number
      - overall_pick
      - team_abbreviation
      - organization
      - organization_type
    sql_template: SELECT season AS draft_year, round_number, overall_pick, player_name, team_abbreviation, organization, organization_type FROM draft_history
      WHERE season = '{draft_year}' AND round_number = 2 ORDER BY overall_pick LIMIT {limit}
    examples:
      - question: 특정 연도 2라운드 픽 리스트만 보여줘
        params:
          draft_year: 2018
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_006
    aliases:
      - 특정 팀의 드래프트 히스토리를 연도별로 보여줘 (전체/1라운드/2라운드)
    description_ko: 이 메트릭은 '특정 팀의 드래프트 히스토리를 연도별로 보여줘 (전체/1라운드/2라운드)' 요청을 처리하기 위한 조회 정의다. 주로 draft_history 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: draft_year, round_number, overall_pick · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - season
      - player_name
      - round_number
      - overall_pick
      - team_abbreviation
      - organization
      - organization_type
    sql_template: SELECT season AS draft_year, round_number, overall_pick, player_name, team_abbreviation, organization, organization_type FROM draft_history
      WHERE team_abbreviation = '{team_abbreviation}' ORDER BY season, round_number, overall_pick LIMIT {limit}
    examples:
      - question: 특정 팀의 드래프트 히스토리를 연도별로 보여줘 (전체/1라운드/2라운드)
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_007
    aliases:
      - 특정 시즌 드래프트에서 팀별로 뽑은 선수 수를 보여줘
    description_ko: 이 메트릭은 '특정 시즌 드래프트에서 팀별로 뽑은 선수 수를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history 테이블을 활용해 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: player_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - season
      - team_abbreviation
    sql_template: SELECT season AS draft_year, team_abbreviation, COUNT(*) AS player_count FROM draft_history WHERE season = '{draft_year}' GROUP
      BY season, team_abbreviation ORDER BY player_count DESC LIMIT {limit}
    examples:
      - question: 특정 시즌 드래프트에서 팀별로 뽑은 선수 수를 보여줘
        params:
          draft_year: 2018
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_008
    aliases:
      - 특정 연도 드래프트에서 포지션별 픽 분포를 보여줘
    description_ko: 이 메트릭은 '특정 연도 드래프트에서 포지션별 픽 분포를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history, common_player_info 테이블을 활용해 조인 / 그룹 집계 / 카운트 / 정렬
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: pick_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
      - common_player_info
    required_columns:
      - person_id
      - position
      - season
    sql_template: SELECT dh.season AS draft_year, cpi.position, COUNT(*) AS pick_count FROM draft_history dh LEFT JOIN common_player_info cpi ON
      dh.person_id = cpi.person_id WHERE dh.season = '{draft_year}' GROUP BY cpi.position ORDER BY pick_count DESC LIMIT {limit}
    examples:
      - question: 특정 연도 드래프트에서 포지션별 픽 분포를 보여줘
        params:
          draft_year: 2018
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_009
    aliases:
      - 특정 연도 드래프트에서 국가/출신(organization_type)별 픽 분포를 보여줘
    description_ko: 이 메트릭은 '특정 연도 드래프트에서 국가/출신(organization_type)별 픽 분포를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history, common_player_info 테이블을 활용해
      조인 / 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: pick_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
      - common_player_info
    required_columns:
      - person_id
      - organization_type
      - country
      - season
    sql_template: SELECT dh.season AS draft_year, cpi.country, dh.organization_type, COUNT(*) AS pick_count FROM draft_history dh LEFT JOIN common_player_info
      cpi ON dh.person_id = cpi.person_id WHERE dh.season = '{draft_year}' GROUP BY cpi.country, dh.organization_type ORDER BY pick_count DESC LIMIT
      {limit}
    examples:
      - question: 특정 연도 드래프트에서 국가/출신(organization_type)별 픽 분포를 보여줘
        params:
          draft_year: 2018
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_010
    aliases:
      - 드래프트 전체 픽 기준으로 “팀 약어별 가장 많은 픽 보유 연도”를 알려줘
    description_ko: 이 메트릭은 '드래프트 전체 픽 기준으로 “팀 약어별 가장 많은 픽 보유 연도”를 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 / 정렬
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: tyc.team_abbreviation · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - team_abbreviation
      - season
    sql_template: |-
      WITH team_year_counts AS (
        SELECT team_abbreviation, season AS draft_year, COUNT(*) AS pick_count
        FROM draft_history
        GROUP BY team_abbreviation, season
      ),
      max_picks AS (
        SELECT team_abbreviation, MAX(pick_count) AS max_pick_count
        FROM team_year_counts
        GROUP BY team_abbreviation
      )
      SELECT tyc.team_abbreviation, tyc.draft_year, tyc.pick_count
      FROM team_year_counts tyc
      JOIN max_picks mp ON tyc.team_abbreviation = mp.team_abbreviation AND tyc.pick_count = mp.max_pick_count
      ORDER BY tyc.team_abbreviation
      LIMIT {limit}
    examples:
      - question: 드래프트 전체 픽 기준으로 “팀 약어별 가장 많은 픽 보유 연도”를 알려줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_011
    aliases:
      - 드래프트 1픽 선수들의 국가/포지션/학교 분포를 보여줘
    description_ko: 이 메트릭은 '드래프트 1픽 선수들의 국가/포지션/학교 분포를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history, common_player_info 테이블을 활용해 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
      - common_player_info
    required_columns:
      - person_id
      - overall_pick
      - school
      - country
      - position
    sql_template: |-
      SELECT cpi.country, cpi.position, cpi.school, COUNT(*) AS count, '{season_year}' AS season_year
      FROM draft_history dh
      JOIN common_player_info cpi ON dh.person_id = cpi.person_id
      WHERE dh.overall_pick = 1
      GROUP BY cpi.country, cpi.position, cpi.school
      LIMIT {limit}
    examples:
      - question: 드래프트 1픽 선수들의 국가/포지션/학교 분포를 보여줘
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_012
    aliases:
      - 드래프트 1픽의 평균 커리어 길이를 “국가별/포지션별”로 나눠서 비교해줘
    description_ko: 이 메트릭은 '드래프트 1픽의 평균 커리어 길이를 “국가별/포지션별”로 나눠서 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history, common_player_info 테이블을 활용해 평균 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
      - common_player_info
    required_columns:
      - person_id
      - overall_pick
      - country
      - position
      - from_year
      - to_year
    sql_template: |-
      SELECT cpi.country, cpi.position, AVG(COALESCE(cpi.to_year, strftime('%Y','now')) - cpi.from_year + 1) AS avg_career_length, '{season_year}' AS season_year
      FROM draft_history dh
      JOIN common_player_info cpi ON dh.person_id = cpi.person_id
      WHERE dh.overall_pick = 1
      GROUP BY cpi.country, cpi.position
      LIMIT {limit}
    examples:
      - question: 드래프트 1픽의 평균 커리어 길이를 “국가별/포지션별”로 나눠서 비교해줘
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_013
    aliases:
      - 특정 선수의 드래프트 정보(연도/라운드/픽/팀)를 알려줘
    description_ko: 이 메트릭은 '특정 선수의 드래프트 정보(연도/라운드/픽/팀)를 알려줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history, common_player_info 테이블을 활용해 기본 조회/필터 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - player_name
      - season
      - round_number
      - overall_pick
      - team_city
      - team_name
      - team_abbreviation
    sql_template: |-
      SELECT season AS draft_year, round_number, overall_pick, team_city, team_name, team_abbreviation, player_name
      FROM draft_history
      WHERE player_name LIKE '%' || '{player_name}' || '%'
      ORDER BY season DESC, overall_pick ASC
      LIMIT {limit}
    examples:
      - question: 특정 선수의 드래프트 정보(연도/라운드/픽/팀)를 알려줘
        params:
          limit: 200
          player_name: Stephen Curry
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_014
    aliases:
      - 같은 팀이 같은 연도에 다수 픽을 보유한 사례를 찾아줘
    description_ko: 이 메트릭은 '같은 팀이 같은 연도에 다수 픽을 보유한 사례를 찾아줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_history 테이블을 활용해 cte / 그룹 집계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: dh.team_id, dh.season, dh.overall_pick · 제한: LIMIT {limit}'
    required_tables:
      - draft_history
    required_columns:
      - season
      - round_number
      - overall_pick
      - team_id
      - team_city
      - team_name
      - team_abbreviation
    sql_template: |-
      WITH team_picks AS (
        SELECT team_id, season, COUNT(*) AS pick_count
        FROM draft_history
        GROUP BY team_id, season
        HAVING pick_count > 1
      )
      SELECT dh.team_city, dh.team_name, dh.team_abbreviation, dh.season AS draft_year, dh.round_number, dh.overall_pick, '{season_year}' AS season_year
      FROM draft_history dh
      JOIN team_picks tp ON dh.team_id = tp.team_id AND dh.season = tp.season
      ORDER BY dh.team_id, dh.season, dh.overall_pick
      LIMIT {limit}
    examples:
      - question: 같은 팀이 같은 연도에 다수 픽을 보유한 사례를 찾아줘
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_015
    aliases:
      - 특정 연도 컴바인에서 윙스팬(wingspan) 상위 20명을 보여줘
    description_ko: 이 메트릭은 '특정 연도 컴바인에서 윙스팬(wingspan) 상위 20명을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: wingspan DESC · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - season
      - player_name
      - wingspan
    sql_template: SELECT player_name, wingspan, '{season_year}' AS season_year FROM draft_combine_stats WHERE season = '{season_id}' ORDER BY wingspan
      DESC LIMIT {limit}
    examples:
      - question: 특정 연도 컴바인에서 윙스팬(wingspan) 상위 20명을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_016
    aliases:
      - 특정 연도 컴바인에서 스탠딩 리치(standing_reach) 상위 20명을 보여줘
    description_ko: 이 메트릭은 '특정 연도 컴바인에서 스탠딩 리치(standing_reach) 상위 20명을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: standing_reach DESC · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - season
      - player_name
      - standing_reach
    sql_template: SELECT player_name, standing_reach, '{season_year}' AS season_year FROM draft_combine_stats WHERE season = '{season_id}' ORDER
      BY standing_reach DESC LIMIT {limit}
    examples:
      - question: 특정 연도 컴바인에서 스탠딩 리치(standing_reach) 상위 20명을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_017
    aliases:
      - 특정 연도 컴바인에서 3/4 스프린트(three_quarter_sprint) 기록 상위(=빠른) 20명을 보여줘
    description_ko: 이 메트릭은 '특정 연도 컴바인에서 3/4 스프린트(three_quarter_sprint) 기록 상위(=빠른) 20명을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해
      정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: three_quarter_sprint ASC · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - season
      - player_name
      - three_quarter_sprint
    sql_template: SELECT player_name, three_quarter_sprint, '{season_year}' AS season_year FROM draft_combine_stats WHERE season = '{season_id}'
      AND three_quarter_sprint IS NOT NULL ORDER BY three_quarter_sprint ASC LIMIT {limit}
    examples:
      - question: 특정 연도 컴바인에서 3/4 스프린트(three_quarter_sprint) 기록 상위(=빠른) 20명을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_018
    aliases:
      - 특정 연도 컴바인에서 레인 어질리티(lane_agility_time) 기록 상위 20명을 보여줘
    description_ko: 이 메트릭은 '특정 연도 컴바인에서 레인 어질리티(lane_agility_time) 기록 상위 20명을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: lane_agility_time ASC · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - season
      - player_name
      - lane_agility_time
    sql_template: SELECT player_name, lane_agility_time, '{season_year}' AS season_year FROM draft_combine_stats WHERE season = '{season_id}' AND
      lane_agility_time IS NOT NULL ORDER BY lane_agility_time ASC LIMIT {limit}
    examples:
      - question: 특정 연도 컴바인에서 레인 어질리티(lane_agility_time) 기록 상위 20명을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_019
    aliases:
      - 특정 연도 컴바인에서 최대 수직점프(max_vertical_leap) 상위 20명을 보여줘
    description_ko: 이 메트릭은 '특정 연도 컴바인에서 최대 수직점프(max_vertical_leap) 상위 20명을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: max_vertical_leap DESC · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - season
      - player_name
      - max_vertical_leap
    sql_template: SELECT player_name, max_vertical_leap, '{season_year}' AS season_year FROM draft_combine_stats WHERE season = '{season_id}' AND
      max_vertical_leap IS NOT NULL ORDER BY max_vertical_leap DESC LIMIT {limit}
    examples:
      - question: 특정 연도 컴바인에서 최대 수직점프(max_vertical_leap) 상위 20명을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_020
    aliases:
      - 포지션별 평균 wingspan / standing_reach / max_vertical_leap을 비교해줘
    description_ko: 이 메트릭은 '포지션별 평균 wingspan / standing_reach / max_vertical_leap을 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해 그룹
      집계 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: position · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - position
      - wingspan
      - standing_reach
      - max_vertical_leap
    sql_template: SELECT position, ROUND(AVG(wingspan),2) AS avg_wingspan, ROUND(AVG(standing_reach),2) AS avg_standing_reach, ROUND(AVG(max_vertical_leap),2)
      AS avg_max_vertical_leap FROM draft_combine_stats GROUP BY position ORDER BY position LIMIT {limit}
    examples:
      - question: 포지션별 평균 wingspan / standing_reach / max_vertical_leap을 비교해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_021
    aliases:
      - 포지션별 평균 스피드(three_quarter_sprint)와 민첩성(lane_agility_time)을 비교해줘
    description_ko: 이 메트릭은 '포지션별 평균 스피드(three_quarter_sprint)와 민첩성(lane_agility_time)을 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해
      그룹 집계 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: position · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - position
      - lane_agility_time
      - three_quarter_sprint
    sql_template: SELECT position, ROUND(AVG(three_quarter_sprint),3) AS avg_three_quarter_sprint, ROUND(AVG(lane_agility_time),3) AS avg_lane_agility_time
      FROM draft_combine_stats WHERE three_quarter_sprint IS NOT NULL AND lane_agility_time IS NOT NULL GROUP BY position ORDER BY position LIMIT
      {limit}
    examples:
      - question: 포지션별 평균 스피드(three_quarter_sprint)와 민첩성(lane_agility_time)을 비교해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_022
    aliases:
      - 특정 선수의 컴바인 기록을 요약해줘 (가능한 필드만)
    description_ko: 이 메트릭은 '특정 선수의 컴바인 기록을 요약해줘 (가능한 필드만)' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - player_name
      - position
      - height_wo_shoes
      - height_w_shoes
      - weight
      - wingspan
      - standing_reach
      - body_fat_pct
      - hand_length
      - hand_width
      - standing_vertical_leap
      - max_vertical_leap
      - lane_agility_time
      - modified_lane_agility_time
      - three_quarter_sprint
      - bench_press
    sql_template: SELECT player_name, position, height_wo_shoes, height_w_shoes, weight, wingspan, standing_reach, body_fat_pct, hand_length, hand_width,
      standing_vertical_leap, max_vertical_leap, lane_agility_time, modified_lane_agility_time, three_quarter_sprint, bench_press FROM draft_combine_stats
      WHERE player_name = '{player_name}' LIMIT {limit}
    examples:
      - question: 특정 선수의 컴바인 기록을 요약해줘 (가능한 필드만)
        params:
          limit: 200
          player_name: Stephen Curry
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_023
    aliases:
      - '컴바인 측정치가 가장 이례적인(outlier) 선수 TOP 20을 찾아줘 (예: wingspan 대비 키 비율)'
    description_ko: '이 메트릭은 ''컴바인 측정치가 가장 이례적인(outlier) 선수 TOP 20을 찾아줘 (예: wingspan 대비 키 비율)'' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats 테이블을 활용해
      cte / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: AVG · 정렬: z_score DESC · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
    required_columns:
      - player_id
      - player_name
      - height_wo_shoes
      - wingspan
    sql_template: |-
      WITH ratio_calc AS (
        SELECT
          player_id,
          player_name,
          height_wo_shoes AS height,
          wingspan,
          CASE WHEN height_wo_shoes > 0 THEN CAST(wingspan AS FLOAT) / height_wo_shoes ELSE NULL END AS wingspan_height_ratio
        FROM draft_combine_stats
        WHERE height_wo_shoes > 0 AND wingspan > 0
      ),
      stats AS (
        SELECT
          AVG(wingspan_height_ratio) AS avg_ratio,
          SQRT(
            AVG(wingspan_height_ratio * wingspan_height_ratio)
            - AVG(wingspan_height_ratio) * AVG(wingspan_height_ratio)
          ) AS stddev_ratio
        FROM ratio_calc
      ),
      outliers AS (
        SELECT
          player_id,
          player_name,
          height,
          wingspan,
          wingspan_height_ratio,
          ABS(wingspan_height_ratio - (SELECT avg_ratio FROM stats)) / NULLIF((SELECT stddev_ratio FROM stats), 0) AS z_score
        FROM ratio_calc
        WHERE wingspan_height_ratio IS NOT NULL
      )
      SELECT
        player_id,
        player_name,
        height,
        wingspan,
        wingspan_height_ratio,
        z_score
      FROM outliers
      ORDER BY z_score DESC
      LIMIT {limit}
    examples:
      - question: '컴바인 측정치가 가장 이례적인(outlier) 선수 TOP 20을 찾아줘 (예: wingspan 대비 키 비율)'
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: draft_024
    aliases:
      - '(멀티스텝) 드래프트 상위 픽(예: overall 1~10)의 평균 wingspan/스피드가 다른 구간(예: 20~30)과 다른지 비교해줘'
    description_ko: '이 메트릭은 ''(멀티스텝) 드래프트 상위 픽(예: overall 1~10)의 평균 wingspan/스피드가 다른 구간(예: 20~30)과 다른지 비교해줘'' 요청을 처리하기 위한 조회 정의다. 주로 draft_combine_stats,
      draft_history 테이블을 활용해 조인 / cte / 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: AVG · 제한: LIMIT {limit}'
    required_tables:
      - draft_combine_stats
      - draft_history
    required_columns:
      - player_id
      - player_name
      - wingspan
      - lane_agility_time
      - overall_pick
    sql_template: |-
      WITH top_picks AS (
        SELECT dcs.player_id, dcs.player_name, dcs.wingspan, dcs.lane_agility_time
        FROM draft_combine_stats dcs
        JOIN draft_history dh ON dcs.player_name = dh.player_name
        WHERE dh.overall_pick BETWEEN 1 AND 10
          AND dcs.wingspan IS NOT NULL
          AND dcs.lane_agility_time IS NOT NULL
      ),
      mid_picks AS (
        SELECT dcs.player_id, dcs.player_name, dcs.wingspan, dcs.lane_agility_time
        FROM draft_combine_stats dcs
        JOIN draft_history dh ON dcs.player_name = dh.player_name
        WHERE dh.overall_pick BETWEEN 20 AND 30
          AND dcs.wingspan IS NOT NULL
          AND dcs.lane_agility_time IS NOT NULL
      ),
      avgs AS (
        SELECT
          'top_1_10' AS group_name,
          AVG(wingspan) AS avg_wingspan,
          AVG(lane_agility_time) AS avg_lane_agility_time
        FROM top_picks
        UNION ALL
        SELECT
          'mid_20_30' AS group_name,
          AVG(wingspan) AS avg_wingspan,
          AVG(lane_agility_time) AS avg_lane_agility_time
        FROM mid_picks
      )
      SELECT * FROM avgs
      LIMIT {limit}
    examples:
      - question: '(멀티스텝) 드래프트 상위 픽(예: overall 1~10)의 평균 wingspan/스피드가 다른 구간(예: 20~30)과 다른지 비교해줘'
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: inactive_001
    aliases:
      - 특정 시즌에서 결장(인액티브) 등록이 가장 많은 팀 TOP 10을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 결장(인액티브) 등록이 가장 많은 팀 TOP 10을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 inactive_players, game 테이블을 활용해 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: inactive_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - inactive_players
      - game
    required_columns:
      - game_id
      - team_abbreviation
      - season_id
    sql_template: |-
      SELECT season_id, team_abbreviation, COUNT(*) AS inactive_count
      FROM inactive_players ip
      JOIN game g ON ip.game_id = g.game_id
      WHERE season_id = '{season_id}'
      GROUP BY season_id, team_abbreviation
      ORDER BY inactive_count DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 결장(인액티브) 등록이 가장 많은 팀 TOP 10을 보여줘
        params:
          limit: 10
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: inactive_002
    aliases:
      - 특정 팀의 시즌별 결장자 수 추이를 보여줘 (차트용)
    description_ko: 이 메트릭은 '특정 팀의 시즌별 결장자 수 추이를 보여줘 (차트용)' 요청을 처리하기 위한 조회 정의다. 주로 inactive_players, game 테이블을 활용해 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: g.season_id · 제한: LIMIT {limit}'
    required_tables:
      - inactive_players
      - game
    required_columns:
      - game_id
      - team_abbreviation
      - season_id
    sql_template: |-
      SELECT g.season_id, '{season_year}' AS season_year, ip.team_abbreviation, COUNT(*) AS inactive_count
      FROM inactive_players ip
      JOIN game g ON ip.game_id = g.game_id
      WHERE ip.team_abbreviation = '{team_abbreviation}'
      GROUP BY g.season_id, ip.team_abbreviation
      ORDER BY g.season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 결장자 수 추이를 보여줘 (차트용)
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: inactive_003
    aliases:
      - 특정 경기에서 인액티브가 가장 많았던 팀/경기를 찾아줘
    description_ko: 이 메트릭은 '특정 경기에서 인액티브가 가장 많았던 팀/경기를 찾아줘' 요청을 처리하기 위한 조회 정의다. 주로 inactive_players 테이블을 활용해 cte / 그룹 집계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: inactive_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - inactive_players
    required_columns:
      - game_id
      - team_abbreviation
    sql_template: |-
      WITH inactive_counts AS (
        SELECT ip.game_id, ip.team_abbreviation, COUNT(*) AS inactive_count
        FROM inactive_players ip
        WHERE ip.game_id = '{game_id}'
        GROUP BY ip.game_id, ip.team_abbreviation
      )
      SELECT game_id, team_abbreviation, inactive_count
      FROM inactive_counts
      ORDER BY inactive_count DESC
      LIMIT {limit};
    examples:
      - question: 특정 경기에서 인액티브가 가장 많았던 팀/경기를 찾아줘
        params:
          game_id: '0022200001'
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: inactive_004
    aliases:
      - 특정 선수의 인액티브 기록(경기 수, 시즌별)을 보여줘
    description_ko: 이 메트릭은 '특정 선수의 인액티브 기록(경기 수, 시즌별)을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 inactive_players, game 테이블을 활용해 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 제한: LIMIT {limit}'
    required_tables:
      - inactive_players
      - game
    required_columns:
      - game_id
      - player_id
      - first_name
      - last_name
      - season_id
    sql_template: |-
      SELECT
        ip.player_id,
        ip.first_name || ' ' || ip.last_name AS player_name,
        g.season_id,
        printf('%d-%02d', CAST(SUBSTR(g.season_id, 2, 4) AS INT), (CAST(SUBSTR(g.season_id, 2, 4) AS INT) + 1) % 100) AS season_year,
        COUNT(DISTINCT ip.game_id) AS inactive_games
      FROM inactive_players ip
      JOIN game g ON ip.game_id = g.game_id
      WHERE (ip.first_name || ' ' || ip.last_name) LIKE '%' || '{player_a}' || '%'
      GROUP BY ip.player_id, g.season_id
      ORDER BY g.season_id
      LIMIT {limit}
    examples:
      - question: 특정 선수의 인액티브 기록(경기 수, 시즌별)을 보여줘
        params:
          limit: 200
          player_a: Stephen Curry
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: inactive_005
    aliases:
      - 결장자가 많은 경기에서 팀이 이길 확률이 낮아지는지 분석해줘 (멀티스텝)
    description_ko: 이 메트릭은 '결장자가 많은 경기에서 팀이 이길 확률이 낮아지는지 분석해줘 (멀티스텝)' 요청을 처리하기 위한 조회 정의다. 주로 inactive_players, game 테이블을 활용해 조인 / cte / 그룹 집계 /
      평균 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG/COUNT · 정렬: inactive_count · 제한: LIMIT {limit}'
    required_tables:
      - inactive_players
      - game
    required_columns:
      - game_id
      - team_abbreviation
      - team_abbreviation_home
      - wl_home
      - team_abbreviation_away
      - wl_away
    sql_template: |-
      WITH inactive_counts AS (
        SELECT ip.game_id, ip.team_abbreviation, COUNT(*) AS inactive_count
        FROM inactive_players ip
        GROUP BY ip.game_id, ip.team_abbreviation
      ),
      team_results AS (
        SELECT game_id, team_abbreviation_home AS team_abbreviation, wl_home AS win_loss
        FROM game
        UNION ALL
        SELECT game_id, team_abbreviation_away AS team_abbreviation, wl_away AS win_loss
        FROM game
      ),
      combined AS (
        SELECT ic.game_id, ic.team_abbreviation, ic.inactive_count, tr.win_loss
        FROM inactive_counts ic
        JOIN team_results tr ON ic.game_id = tr.game_id AND ic.team_abbreviation = tr.team_abbreviation
      )
      SELECT inactive_count, AVG(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_rate
      FROM combined
      GROUP BY inactive_count
      ORDER BY inactive_count
      LIMIT {limit}
    examples:
      - question: 결장자가 많은 경기에서 팀이 이길 확률이 낮아지는지 분석해줘 (멀티스텝)
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_001
    aliases:
      - 특정 경기의 플레이바이플레이를 시간순으로 요약해서 보여줘 (기간/쿼터 필터 포함)
    description_ko: 이 메트릭은 '특정 경기의 플레이바이플레이를 시간순으로 요약해서 보여줘 (기간/쿼터 필터 포함)' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: eventnum ASC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
    required_columns:
      - game_id
      - eventnum
      - eventmsgtype
      - eventmsgactiontype
      - period
      - wctimestring
      - pctimestring
      - score
      - scoremargin
      - player1_id
      - player1_name
      - player1_team_abbreviation
      - player2_id
      - player2_name
      - player2_team_abbreviation
      - player3_id
      - player3_name
      - player3_team_abbreviation
    sql_template: |-
      SELECT eventnum, eventmsgtype, eventmsgactiontype, period, wctimestring, pctimestring, player1_id, player1_name, player1_team_abbreviation, player2_id, player2_name, player2_team_abbreviation, player3_id, player3_name, player3_team_abbreviation, score, scoremargin
      FROM play_by_play
      WHERE game_id = '{game_id}'
        AND period BETWEEN {period_start} AND {period_end}
        AND wctimestring BETWEEN '{start_date}' AND '{end_date}'
      ORDER BY eventnum ASC
      LIMIT {limit}
    examples:
      - question: 특정 경기의 플레이바이플레이를 시간순으로 요약해서 보여줘 (기간/쿼터 필터 포함)
        params:
          end_date: '2023-06-30'
          game_id: '0022200001'
          limit: 200
          period_end: 4
          period_start: 1
          start_date: '2022-10-01'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_002
    aliases:
      - 특정 시즌에서 이벤트 타입(eventmsgtype)별 발생 비중을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 이벤트 타입(eventmsgtype)별 발생 비중을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 조인 / cte / 그룹 집계 / 합계 /
      카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: cnt DESC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - season_id
    sql_template: |-
      WITH event_counts AS (
        SELECT eventmsgtype, COUNT(*) AS cnt
        FROM play_by_play p
        JOIN game g ON p.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY eventmsgtype
      ), total AS (
        SELECT SUM(cnt) AS total_cnt FROM event_counts
      )
      SELECT eventmsgtype, cnt, ROUND(100.0 * cnt / total_cnt, 2) AS percentage
      FROM event_counts, total
      ORDER BY cnt DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 이벤트 타입(eventmsgtype)별 발생 비중을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_003
    aliases:
      - 특정 팀의 이벤트 타입(eventmsgtype) 분포를 시즌별로 비교해줘
    description_ko: 이 메트릭은 '특정 팀의 이벤트 타입(eventmsgtype) 분포를 시즌별로 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: g.season_id, event_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - player1_team_abbreviation
      - player2_team_abbreviation
      - player3_team_abbreviation
      - season_id
    sql_template: |-
      SELECT g.season_id, p.eventmsgtype, COUNT(*) AS event_count
      FROM play_by_play p
      JOIN game g ON p.game_id = g.game_id
      WHERE (p.player1_team_abbreviation = '{team_abbreviation}' OR p.player2_team_abbreviation = '{team_abbreviation}' OR p.player3_team_abbreviation = '{team_abbreviation}')
      GROUP BY g.season_id, p.eventmsgtype
      ORDER BY g.season_id, event_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 팀의 이벤트 타입(eventmsgtype) 분포를 시즌별로 비교해줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_004
    aliases:
      - 특정 선수의 이벤트 타입(eventmsgtype) 분포를 시즌별로 보여줘
    description_ko: 이 메트릭은 '특정 선수의 이벤트 타입(eventmsgtype) 분포를 시즌별로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: g.season_id, event_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - player1_name
      - player2_name
      - player3_name
      - season_id
    sql_template: |-
      SELECT g.season_id, p.eventmsgtype, COUNT(*) AS event_count
      FROM play_by_play p
      JOIN game g ON p.game_id = g.game_id
      WHERE '{player_name}' IN (p.player1_name, p.player2_name, p.player3_name)
      GROUP BY g.season_id, p.eventmsgtype
      ORDER BY g.season_id, event_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 선수의 이벤트 타입(eventmsgtype) 분포를 시즌별로 보여줘
        params:
          limit: 200
          player_name: Stephen Curry
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_005
    aliases:
      - 특정 시즌에서 “턴오버(eventmsgtype=5)”가 가장 많은 선수 TOP 20을 보여줘 (코드 기반)
    description_ko: 이 메트릭은 '특정 시즌에서 “턴오버(eventmsgtype=5)”가 가장 많은 선수 TOP 20을 보여줘 (코드 기반)' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 카운트
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: turnover_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - player1_id
      - player1_name
      - season_id
    sql_template: |-
      SELECT p.player1_id AS player_id, p.player1_name AS player_name, COUNT(*) AS turnover_count, '{season_year}' AS season_year
      FROM play_by_play p
      JOIN game g ON p.game_id = g.game_id
      WHERE g.season_id = '{season_id}' AND p.eventmsgtype = 5
      GROUP BY p.player1_id, p.player1_name
      ORDER BY turnover_count DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 “턴오버(eventmsgtype=5)”가 가장 많은 선수 TOP 20을 보여줘 (코드 기반)
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_006
    aliases:
      - 특정 시즌에서 “파울(eventmsgtype=6)”이 가장 많은 선수 TOP 20을 보여줘 (코드 기반)
    description_ko: 이 메트릭은 '특정 시즌에서 “파울(eventmsgtype=6)”이 가장 많은 선수 TOP 20을 보여줘 (코드 기반)' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 카운트 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: foul_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - player1_id
      - player1_name
      - season_id
    sql_template: |-
      SELECT p.player1_id AS player_id, p.player1_name AS player_name, COUNT(*) AS foul_count, '{season_year}' AS season_year
      FROM play_by_play p
      JOIN game g ON p.game_id = g.game_id
      WHERE g.season_id = '{season_id}' AND p.eventmsgtype = 6
      GROUP BY p.player1_id, p.player1_name
      ORDER BY foul_count DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 “파울(eventmsgtype=6)”이 가장 많은 선수 TOP 20을 보여줘 (코드 기반)
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_007
    aliases:
      - 특정 시즌에서 “리바운드(eventmsgtype=4)”가 가장 많은 선수 TOP 20을 보여줘 (코드 기반)
    description_ko: 이 메트릭은 '특정 시즌에서 “리바운드(eventmsgtype=4)”가 가장 많은 선수 TOP 20을 보여줘 (코드 기반)' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 카운트
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: rebound_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - player1_id
      - player1_name
      - season_id
    sql_template: |-
      SELECT p.player1_id AS player_id, p.player1_name AS player_name, COUNT(*) AS rebound_count, '{season_year}' AS season_year
      FROM play_by_play p
      JOIN game g ON p.game_id = g.game_id
      WHERE g.season_id = '{season_id}' AND p.eventmsgtype = 4
      GROUP BY p.player1_id, p.player1_name
      ORDER BY rebound_count DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 “리바운드(eventmsgtype=4)”가 가장 많은 선수 TOP 20을 보여줘 (코드 기반)
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_008
    aliases:
      - 특정 시즌에서 “득점 이벤트(eventmsgtype=1,3 등)”가 많은 선수 TOP 20을 보여줘 (코드 기반/가공)
    description_ko: 이 메트릭은 '특정 시즌에서 “득점 이벤트(eventmsgtype=1,3 등)”가 많은 선수 TOP 20을 보여줘 (코드 기반/가공)' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해
      카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: scoring_event_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - player1_id
      - player1_name
      - season_id
    sql_template: |-
      SELECT p.player1_id AS player_id, p.player1_name AS player_name, COUNT(*) AS scoring_event_count, '{season_year}' AS season_year
      FROM play_by_play p
      JOIN game g ON p.game_id = g.game_id
      WHERE g.season_id = '{season_id}' AND p.eventmsgtype IN (1, 3)
      GROUP BY p.player1_id, p.player1_name
      ORDER BY scoring_event_count DESC
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 “득점 이벤트(eventmsgtype=1,3 등)”가 많은 선수 TOP 20을 보여줘 (코드 기반/가공)
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_009
    aliases:
      - '특정 선수의 4쿼터 막판(예: 2분 이내) 이벤트만 모아서 보여줘 (클러치 이벤트)'
    description_ko: '이 메트릭은 ''특정 선수의 4쿼터 막판(예: 2분 이내) 이벤트만 모아서 보여줘 (클러치 이벤트)'' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.'
    formula_ko: '집계/조회: SELECT · 정렬: eventnum · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
    required_columns:
      - eventnum
      - period
      - pctimestring
      - player1_name
    sql_template: SELECT * FROM play_by_play WHERE player1_name = '{player_name}' AND period = 4 AND CAST(SUBSTR(pctimestring, 1, 2) AS INTEGER)
      * 60 + CAST(SUBSTR(pctimestring, 4, 2) AS INTEGER) <= {clutch_seconds} ORDER BY eventnum LIMIT {limit}
    examples:
      - question: '특정 선수의 4쿼터 막판(예: 2분 이내) 이벤트만 모아서 보여줘 (클러치 이벤트)'
        params:
          clutch_seconds: 120
          limit: 200
          player_name: Stephen Curry
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_010
    aliases:
      - 특정 경기에서 마지막 2분의 주요 이벤트만 추려서 보여줘 (클러치)
    description_ko: 이 메트릭은 '특정 경기에서 마지막 2분의 주요 이벤트만 추려서 보여줘 (클러치)' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play 테이블을 활용해 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: eventnum · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
    required_columns:
      - game_id
      - eventnum
      - period
      - pctimestring
    sql_template: SELECT * FROM play_by_play WHERE game_id = '{game_id}' AND period = 4 AND CAST(SUBSTR(pctimestring, 1, 2) AS INTEGER) * 60 + CAST(SUBSTR(pctimestring,
      4, 2) AS INTEGER) <= 120 ORDER BY eventnum LIMIT {limit}
    examples:
      - question: 특정 경기에서 마지막 2분의 주요 이벤트만 추려서 보여줘 (클러치)
        params:
          game_id: '0022200001'
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_063
    aliases:
      - 특정 팀 vs 특정 팀의 맞대결에서, 특정 선수 이벤트만 모아서 보여줘
    description_ko: 이 메트릭은 '특정 팀 vs 특정 팀의 맞대결에서, 특정 선수 이벤트만 모아서 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, play_by_play 테이블을 활용해 cte / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: game_id, eventnum · 제한: LIMIT {limit}'
    required_tables:
      - game
      - play_by_play
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - team_abbreviation_away
      - eventnum
      - player1_name
      - player2_name
      - player3_name
    sql_template: WITH matchup_games AS (SELECT game_id FROM game WHERE ((team_abbreviation_home = '{team_a}' AND team_abbreviation_away = '{team_b}')
      OR (team_abbreviation_home = '{team_b}' AND team_abbreviation_away = '{team_a}')) AND season_id = '{season_id}') SELECT * FROM play_by_play
      WHERE game_id IN (SELECT game_id FROM matchup_games) AND (player1_name = '{player_name}' OR player2_name = '{player_name}' OR player3_name
      = '{player_name}') ORDER BY game_id, eventnum LIMIT {limit}
    examples:
      - question: 특정 팀 vs 특정 팀의 맞대결에서, 특정 선수 이벤트만 모아서 보여줘
        params:
          limit: 200
          player_name: Stephen Curry
          season_id: '22022'
          team_a: LAL
          team_b: BOS
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_011
    aliases:
      - 특정 선수 2명의 맞대결에서 서로가 관여한 이벤트(스크린/어시스트/파울 등)를 찾아줘 (텍스트/필드 기반)
    description_ko: 이 메트릭은 '특정 선수 2명의 맞대결에서 서로가 관여한 이벤트(스크린/어시스트/파울 등)를 찾아줘 (텍스트/필드 기반)' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play 테이블을 활용해 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: game_id, eventnum · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
    required_columns:
      - game_id
      - eventnum
      - player1_name
      - player2_name
      - player3_name
    sql_template: SELECT * FROM play_by_play WHERE (player1_name = '{player_a}' AND (player2_name = '{player_b}' OR player3_name = '{player_b}'))
      OR (player1_name = '{player_b}' AND (player2_name = '{player_a}' OR player3_name = '{player_a}')) ORDER BY game_id, eventnum LIMIT {limit}
    examples:
      - question: 특정 선수 2명의 맞대결에서 서로가 관여한 이벤트(스크린/어시스트/파울 등)를 찾아줘 (텍스트/필드 기반)
        params:
          limit: 200
          player_a: Stephen Curry
          player_b: LeBron James
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_064
    aliases:
      - (멀티스텝) 접전 경기(마지막 5점 이내)만 골라서, 마지막 2분 이벤트를 요약해줘
    description_ko: 이 메트릭은 '(멀티스텝) 접전 경기(마지막 5점 이내)만 골라서, 마지막 2분 이벤트를 요약해줘' 요청을 처리하기 위한 조회 정의다. 주로 game, play_by_play 테이블을 활용해 cte / 정렬 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: game_id, eventnum · 제한: LIMIT {limit}'
    required_tables:
      - game
      - play_by_play
    required_columns:
      - season_id
      - game_id
      - pts_home
      - pts_away
      - eventnum
      - period
      - pctimestring
    sql_template: WITH close_games AS (SELECT game_id FROM game WHERE ABS(pts_home - pts_away) <= {margin} AND season_id = '{season_id}'), last_two_min_events
      AS (SELECT * FROM play_by_play WHERE game_id IN (SELECT game_id FROM close_games) AND period = 4 AND CAST(SUBSTR(pctimestring, 1, 2) AS INTEGER)
      * 60 + CAST(SUBSTR(pctimestring, 4, 2) AS INTEGER) <= 120) SELECT * FROM last_two_min_events ORDER BY game_id, eventnum LIMIT {limit}
    examples:
      - question: (멀티스텝) 접전 경기(마지막 5점 이내)만 골라서, 마지막 2분 이벤트를 요약해줘
        params:
          limit: 200
          margin: 5
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_065
    aliases:
      - (멀티스텝) 관중이 많은 경기 TOP 20의 마지막 2분 이벤트 특징을 요약해줘
    description_ko: 이 메트릭은 '(멀티스텝) 관중이 많은 경기 TOP 20의 마지막 2분 이벤트 특징을 요약해줘' 요청을 처리하기 위한 조회 정의다. 주로 game_info, play_by_play 테이블을 활용해 cte / 정렬 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: attendance DESC · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - play_by_play
    required_columns:
      - game_id
      - attendance
      - eventnum
      - period
      - pctimestring
    sql_template: WITH top_attendance_games AS (SELECT game_id FROM game_info ORDER BY attendance DESC LIMIT 20), last_two_min_events AS (SELECT
      * FROM play_by_play WHERE game_id IN (SELECT game_id FROM top_attendance_games) AND period = 4 AND CAST(SUBSTR(pctimestring, 1, 2) AS INTEGER)
      * 60 + CAST(SUBSTR(pctimestring, 4, 2) AS INTEGER) <= 120) SELECT * FROM last_two_min_events ORDER BY game_id, eventnum LIMIT {limit}
    examples:
      - question: (멀티스텝) 관중이 많은 경기 TOP 20의 마지막 2분 이벤트 특징을 요약해줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: unsupported_002
    aliases:
      - (주의) 플레이바이플레이는 이벤트 코드/설명 텍스트 파싱이 필요하므로, metric 설계 시 이벤트 매핑 테이블/룰 정리가 필요함
    description_ko: 이 메트릭은 '(주의) 플레이바이플레이는 이벤트 코드/설명 텍스트 파싱이 필요하므로, metric 설계 시 이벤트 매핑 테이블/룰 정리가 필요함' 요청을 처리하기 위한 조회 정의다. 주로 테이블 미지정 테이블을 활용해 기본
      조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables: []
    required_columns: []
    sql_template: |-
      SELECT 'notice: play_by_play 기반 고급 이벤트 분석은 eventmsgtype/eventmsgactiontype 매핑이 필요합니다.' AS notice
      LIMIT {limit};
    examples:
      - question: (주의) 플레이바이플레이는 이벤트 코드/설명 텍스트 파싱이 필요하므로, metric 설계 시 이벤트 매핑 테이블/룰 정리가 필요함
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_066
    aliases:
      - 관중 상위 10팀의 승률/득실차/TS%/eFG%를 한 표로 비교해줘
    description_ko: 이 메트릭은 '관중 상위 10팀의 승률/득실차/TS%/eFG%를 한 표로 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / cte / 그룹 집계 / 합계 / 카운트 /
      정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: total_attendance DESC · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - attendance
      - team_abbreviation_home
      - wl_home
      - fgm_home
      - fga_home
      - fg3m_home
      - ftm_home
      - fta_home
      - pts_home
      - pts_away
    sql_template: |-
      WITH top_10_teams AS (
        SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance
        FROM game_info
        JOIN game ON game_info.game_id = game.game_id
        GROUP BY team_abbreviation_home
        ORDER BY total_attendance DESC
        LIMIT 10
      ),
      team_stats AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          COUNT(*) AS games_played,
          SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,
          SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,
          SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,
          (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct
        FROM game
        GROUP BY team_abbreviation_home
      )
      SELECT
        t.team_abbreviation,
        s.win_pct,
        s.avg_plus_minus AS plus_minus,
        s.ts_pct,
        s.efg_pct
      FROM top_10_teams t
      JOIN team_stats s ON t.team_abbreviation = s.team_abbreviation
      ORDER BY s.win_pct DESC
      LIMIT {limit}
    examples:
      - question: 관중 상위 10팀의 승률/득실차/TS%/eFG%를 한 표로 비교해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_067
    aliases:
      - 관중 상위 10경기에서 리드 체인지/동점/연장전 여부를 같이 분석해줘
    description_ko: 이 메트릭은 '관중 상위 10경기에서 리드 체인지/동점/연장전 여부를 같이 분석해줘' 요청을 처리하기 위한 조회 정의다. 주로 game_info, other_stats, line_score 테이블을 활용해 cte / 정렬
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: attendance DESC · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - other_stats
      - line_score
    required_columns:
      - game_id
      - attendance
      - lead_changes
      - times_tied
      - pts_ot1_home
      - pts_ot1_away
    sql_template: |-
      WITH top_10_games AS (
        SELECT game_info.game_id, attendance
        FROM game_info
        ORDER BY attendance DESC
        LIMIT 10
      )
      SELECT
        g.game_id,
        o.lead_changes,
        o.times_tied,
        CASE WHEN (pts_ot1_home IS NOT NULL AND pts_ot1_home > 0) OR (pts_ot1_away IS NOT NULL AND pts_ot1_away > 0) THEN 1 ELSE 0 END AS has_overtime
      FROM top_10_games g
      JOIN other_stats o ON g.game_id = o.game_id
      JOIN line_score l ON g.game_id = l.game_id
      LIMIT {limit}
    examples:
      - question: 관중 상위 10경기에서 리드 체인지/동점/연장전 여부를 같이 분석해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_010
    aliases:
      - 리드 체인지가 많은 팀 TOP 10과 그 팀들의 승률을 같이 보여줘
    description_ko: 이 메트릭은 '리드 체인지가 많은 팀 TOP 10과 그 팀들의 승률을 같이 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 / 정렬
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: total_lead_changes DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - team_abbreviation_home
      - lead_changes
      - wl_home
    sql_template: |-
      WITH team_lead_changes AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          SUM(lead_changes) AS total_lead_changes
        FROM other_stats
        GROUP BY team_abbreviation_home
        ORDER BY total_lead_changes DESC
        LIMIT 10
      ),
      team_wins AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          COUNT(*) AS games_played,
          SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct
        FROM game
        GROUP BY team_abbreviation_home
      )
      SELECT
        l.team_abbreviation,
        l.total_lead_changes,
        w.win_pct
      FROM team_lead_changes l
      JOIN team_wins w ON l.team_abbreviation = w.team_abbreviation
      ORDER BY l.total_lead_changes DESC
      LIMIT {limit}
    examples:
      - question: 리드 체인지가 많은 팀 TOP 10과 그 팀들의 승률을 같이 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_013
    aliases:
      - 연장전이 많은 팀 TOP 10과 그 팀들의 평균 관중/승률을 같이 보여줘
    description_ko: 이 메트릭은 '연장전이 많은 팀 TOP 10과 그 팀들의 평균 관중/승률을 같이 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score, game, game_info 테이블을 활용해 조인 / cte / 그룹
      집계 / 평균 / 합계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG/SUM/COUNT · 정렬: overtime_games DESC · 제한: LIMIT {limit}'
    required_tables:
      - line_score
      - game
      - game_info
    required_columns:
      - game_id
      - team_abbreviation_home
      - pts_ot1_home
      - pts_ot1_away
      - wl_home
      - attendance
    sql_template: |-
      WITH overtime_games AS (
        SELECT
          game_id,
          CASE WHEN (pts_ot1_home IS NOT NULL AND pts_ot1_home > 0) OR (pts_ot1_away IS NOT NULL AND pts_ot1_away > 0) THEN 1 ELSE 0 END AS has_overtime
        FROM line_score
      ),
      team_overtime_counts AS (
        SELECT
          g.team_abbreviation_home AS team_abbreviation,
          COUNT(*) AS total_games,
          SUM(CASE WHEN o.has_overtime = 1 THEN 1 ELSE 0 END) AS overtime_games
        FROM game g
        JOIN overtime_games o ON g.game_id = o.game_id
        GROUP BY g.team_abbreviation_home
        ORDER BY overtime_games DESC
        LIMIT 10
      ),
      team_avg_attendance AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          AVG(attendance) AS avg_attendance
        FROM game_info
        JOIN game ON game_info.game_id = game.game_id
        GROUP BY team_abbreviation_home
      ),
      team_win_pct AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct
        FROM game
        GROUP BY team_abbreviation_home
      )
      SELECT
        t.team_abbreviation,
        t.overtime_games,
        a.avg_attendance,
        w.win_pct
      FROM team_overtime_counts t
      LEFT JOIN team_avg_attendance a ON t.team_abbreviation = a.team_abbreviation
      LEFT JOIN team_win_pct w ON t.team_abbreviation = w.team_abbreviation
      ORDER BY t.overtime_games DESC
      LIMIT {limit}
    examples:
      - question: 연장전이 많은 팀 TOP 10과 그 팀들의 평균 관중/승률을 같이 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_068
    aliases:
      - 백투백 경기 수가 많은 팀 TOP 10과 승률을 같이 보여줘
    description_ko: 이 메트릭은 '백투백 경기 수가 많은 팀 TOP 10과 승률을 같이 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: game_date) AS prev_date FROM team_games ), b2b AS ( SELECT team_name, team_abbreviation, COUNT(*) AS b2b_games
      FROM ordered WHERE prev_date IS NOT NULL AND julianday(game_date) - julianday(prev_date) = 1 GROUP BY team_abbreviation, team_name ), win
      AS ( SELECT team_name, team_abbreviation, SUM(CASE WHEN wl = ''W'' THEN 1 ELSE 0 END) AS w, SUM(CASE WHEN wl = ''L'' THEN 1 ELSE 0 END) AS
      l, ROUND(1.0 * SUM(CASE WHEN wl = ''W'' THEN 1 ELSE 0 END) / COUNT(*), 3) AS pct FROM team_games GROUP BY team_abbreviation, team_name ) SELECT
      b2b.team_name, b2b.team_abbreviation, ''{season_year}'' AS season_year, b2b.b2b_games, win.w, win.l, win.pct FROM b2b JOIN win ON win.team_abbreviation
      = b2b.team_abbreviation ORDER BY b2b.b2b_games DESC, win.pct DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - team_name_home
      - game_date
      - wl_home
      - team_abbreviation_away
      - team_name_away
      - wl_away
      - season_type
    sql_template: |-
      WITH team_games AS (
        SELECT season_id, date(game_date) AS game_date, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, wl_home AS wl
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season'
        UNION ALL
        SELECT season_id, date(game_date) AS game_date, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, wl_away AS wl
        FROM game
        WHERE season_id = '{season_id}' AND season_type = 'Regular Season'
      ),
      ordered AS (
        SELECT team_abbreviation, team_name, game_date,
               LAG(game_date) OVER (PARTITION BY team_abbreviation ORDER BY game_date) AS prev_date
        FROM team_games
      ),
      b2b AS (
        SELECT team_name, team_abbreviation,
               COUNT(*) AS b2b_games
        FROM ordered
        WHERE prev_date IS NOT NULL AND julianday(game_date) - julianday(prev_date) = 1
        GROUP BY team_abbreviation, team_name
      ),
      win AS (
        SELECT team_name, team_abbreviation,
               SUM(CASE WHEN wl = 'W' THEN 1 ELSE 0 END) AS w,
               SUM(CASE WHEN wl = 'L' THEN 1 ELSE 0 END) AS l,
               ROUND(1.0 * SUM(CASE WHEN wl = 'W' THEN 1 ELSE 0 END) / COUNT(*), 3) AS pct
        FROM team_games
        GROUP BY team_abbreviation, team_name
      )
      SELECT b2b.team_name,
             b2b.team_abbreviation,
             '{season_year}' AS season_year,
             b2b.b2b_games,
             win.w,
             win.l,
             win.pct
      FROM b2b
      JOIN win ON win.team_abbreviation = b2b.team_abbreviation
      ORDER BY b2b.b2b_games DESC, win.pct DESC
      LIMIT {limit};
    examples:
      - question: 백투백 경기 수가 많은 팀 TOP 10과 승률을 같이 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_011
    aliases:
      - 세컨찬스 득점이 높은 팀 TOP 10과 승률/득실차를 같이 보여줘
    description_ko: 이 메트릭은 '세컨찬스 득점이 높은 팀 TOP 10과 승률/득실차를 같이 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 / 정렬
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: total_pts_2nd_chance DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - team_abbreviation_home
      - pts_2nd_chance_home
      - wl_home
      - pts_home
      - pts_away
    sql_template: |-
      WITH team_second_chance AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          SUM(pts_2nd_chance_home) AS total_pts_2nd_chance
        FROM other_stats
        GROUP BY team_abbreviation_home
        ORDER BY total_pts_2nd_chance DESC
        LIMIT 10
      ),
      team_stats AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          COUNT(*) AS games_played,
          SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,
          SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus
        FROM game
        GROUP BY team_abbreviation_home
      )
      SELECT
        s.team_abbreviation,
        t.total_pts_2nd_chance,
        s.win_pct,
        s.avg_plus_minus AS plus_minus
      FROM team_second_chance t
      JOIN team_stats s ON t.team_abbreviation = s.team_abbreviation
      ORDER BY t.total_pts_2nd_chance DESC
      LIMIT {limit}
    examples:
      - question: 세컨찬스 득점이 높은 팀 TOP 10과 승률/득실차를 같이 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_012
    aliases:
      - 턴오버로 얻는 득점이 높은 팀 TOP 10과 승률을 같이 보여줘
    description_ko: 이 메트릭은 '턴오버로 얻는 득점이 높은 팀 TOP 10과 승률을 같이 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: total_pts_off_to DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - pts_off_to_home
      - team_abbreviation_away
      - pts_off_to_away
      - season_id
      - wl_home
      - wl_away
    sql_template: |-
      WITH team_turnover_points AS (
        SELECT
          g.team_abbreviation_home AS team_abbreviation,
          SUM(o.pts_off_to_home) AS pts_off_to,
          COUNT(*) AS games,
          SUM(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS wins
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_home
        UNION ALL
        SELECT
          g.team_abbreviation_away AS team_abbreviation,
          SUM(o.pts_off_to_away) AS pts_off_to,
          COUNT(*) AS games,
          SUM(CASE WHEN g.wl_away = 'W' THEN 1 ELSE 0 END) AS wins
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_away
      ),
      team_agg AS (
        SELECT
          team_abbreviation,
          SUM(pts_off_to) AS total_pts_off_to,
          SUM(games) AS total_games,
          SUM(wins) AS total_wins
        FROM team_turnover_points
        GROUP BY team_abbreviation
      )
      SELECT
        team_abbreviation,
        total_pts_off_to,
        ROUND(CAST(total_wins AS FLOAT) / total_games, 3) AS win_rate,
        '{season_year}' AS season_year
      FROM team_agg
      ORDER BY total_pts_off_to DESC
      LIMIT {limit}
    examples:
      - question: 턴오버로 얻는 득점이 높은 팀 TOP 10과 승률을 같이 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_013
    aliases:
      - 페인트존 득점이 높은 팀 TOP 10과 3점 시도 비중을 같이 비교해줘
    description_ko: 이 메트릭은 '페인트존 득점이 높은 팀 TOP 10과 3점 시도 비중을 같이 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats, game 테이블을 활용해 조인 / cte / 그룹 집계 / 합계 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: total_pts_paint DESC · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - game_id
      - team_abbreviation_home
      - pts_paint_home
      - team_abbreviation_away
      - pts_paint_away
      - season_id
      - fga_home
      - fg3a_home
      - fga_away
      - fg3a_away
    sql_template: |-
      WITH team_paint_and_3pt AS (
        SELECT
          g.team_abbreviation_home AS team_abbreviation,
          SUM(o.pts_paint_home) AS pts_paint,
          SUM(g.fg3a_home) AS fg3a,
          SUM(g.fga_home) AS fga
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_home
        UNION ALL
        SELECT
          g.team_abbreviation_away AS team_abbreviation,
          SUM(o.pts_paint_away) AS pts_paint,
          SUM(g.fg3a_away) AS fg3a,
          SUM(g.fga_away) AS fga
        FROM other_stats o
        JOIN game g ON o.game_id = g.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_away
      ),
      team_agg AS (
        SELECT
          team_abbreviation,
          SUM(pts_paint) AS total_pts_paint,
          SUM(fg3a) AS total_fg3a,
          SUM(fga) AS total_fga
        FROM team_paint_and_3pt
        GROUP BY team_abbreviation
      )
      SELECT
        team_abbreviation,
        total_pts_paint,
        CASE WHEN total_fga > 0 THEN ROUND(CAST(total_fg3a AS FLOAT) / total_fga, 3) ELSE 0 END AS fg3a_ratio,
        '{season_year}' AS season_year
      FROM team_agg
      ORDER BY total_pts_paint DESC
      LIMIT {limit}
    examples:
      - question: 페인트존 득점이 높은 팀 TOP 10과 3점 시도 비중을 같이 비교해줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: officials_010
    aliases:
      - 심판별 평균 파울 콜 수 TOP 10과 그 심판이 배정된 경기의 평균 자유투 시도 수를 같이 보여줘
    description_ko: 이 메트릭은 '심판별 평균 파울 콜 수 TOP 10과 그 심판이 배정된 경기의 평균 자유투 시도 수를 같이 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 officials, game, game_info 테이블을 활용해
      조인 / cte / 그룹 집계 / 평균 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG/COUNT · 정렬: avg_fouls DESC · 제한: LIMIT {limit}'
    required_tables:
      - officials
      - game
    required_columns:
      - game_id
      - official_id
      - first_name
      - last_name
      - fta_home
      - pf_home
      - fta_away
      - pf_away
    sql_template: |-
      WITH official_games AS (
        SELECT DISTINCT official_id, first_name, last_name, game_id
        FROM officials
      ),
      game_stats AS (
        SELECT game_id, (pf_home + pf_away) AS total_pf, (fta_home + fta_away) AS total_fta
        FROM game
      ),
      agg AS (
        SELECT
          og.official_id,
          og.first_name || ' ' || og.last_name AS official_name,
          AVG(gs.total_pf) AS avg_fouls,
          AVG(gs.total_fta) AS avg_fta,
          COUNT(DISTINCT og.game_id) AS games_count
        FROM official_games og
        JOIN game_stats gs ON og.game_id = gs.game_id
        GROUP BY og.official_id, og.first_name, og.last_name
      )
      SELECT
        official_name,
        ROUND(avg_fouls, 3) AS avg_fouls,
        ROUND(avg_fta, 3) AS avg_fta,
        games_count
      FROM agg
      ORDER BY avg_fouls DESC
      LIMIT {limit}
    examples:
      - question: 심판별 평균 파울 콜 수 TOP 10과 그 심판이 배정된 경기의 평균 자유투 시도 수를 같이 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_069
    aliases:
      - 특정 팀의 시즌별 “평균 관중”과 “승률” 추이를 같이 차트로 비교해줘
    description_ko: 이 메트릭은 '특정 팀의 시즌별 “평균 관중”과 “승률” 추이를 같이 차트로 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game, game_info 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_info
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - wl_home
      - team_abbreviation_away
      - wl_away
      - attendance
    sql_template: |-
      WITH team_games AS (
        SELECT
          g.season_id,
          g.game_id,
          g.team_abbreviation_home AS team_abbreviation,
          CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END AS win,
          gi.attendance
        FROM game g
        JOIN game_info gi ON g.game_id = gi.game_id
        WHERE g.team_abbreviation_home = '{team_abbreviation}'
        UNION ALL
        SELECT
          g.season_id,
          g.game_id,
          g.team_abbreviation_away AS team_abbreviation,
          CASE WHEN g.wl_away = 'W' THEN 1 ELSE 0 END AS win,
          gi.attendance
        FROM game g
        JOIN game_info gi ON g.game_id = gi.game_id
        WHERE g.team_abbreviation_away = '{team_abbreviation}'
      ),
      season_stats AS (
        SELECT
          season_id,
          ROUND(AVG(attendance), 0) AS avg_attendance,
          ROUND(CAST(SUM(win) AS FLOAT) / COUNT(game_id), 3) AS win_rate
        FROM team_games
        GROUP BY season_id
      )
      SELECT
        season_id AS season_id,
        avg_attendance,
        win_rate
      FROM season_stats
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 “평균 관중”과 “승률” 추이를 같이 차트로 비교해줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_070
    aliases:
      - 시즌별 리그 평균 득점(경기당) 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '시즌별 리그 평균 득점(경기당) 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - pts_home
      - pts_away
    sql_template: SELECT season_id, AVG(pts_home + pts_away) AS avg_points_per_game, '{season_year}' AS season_year FROM game GROUP BY season_id
      ORDER BY season_id LIMIT {limit}
    examples:
      - question: 시즌별 리그 평균 득점(경기당) 추이를 차트로 보여줘
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_071
    aliases:
      - 시즌별 리그 평균 3점 시도(3PA)와 3점 성공률 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '시즌별 리그 평균 3점 시도(3PA)와 3점 성공률 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - fg3m_home
      - fg3a_home
      - fg3m_away
      - fg3a_away
    sql_template: SELECT season_id, AVG(fg3a_home + fg3a_away) AS avg_3pa, AVG(CASE WHEN (fg3a_home + fg3a_away) = 0 THEN 0 ELSE (fg3m_home + fg3m_away)*1.0/(fg3a_home
      + fg3a_away) END) AS avg_3p_pct, '{season_year}' AS season_year FROM game GROUP BY season_id ORDER BY season_id LIMIT {limit}
    examples:
      - question: 시즌별 리그 평균 3점 시도(3PA)와 3점 성공률 추이를 차트로 보여줘
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_072
    aliases:
      - 시즌별 리그 평균 자유투 시도(FTA)와 자유투 성공률 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '시즌별 리그 평균 자유투 시도(FTA)와 자유투 성공률 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - ftm_home
      - fta_home
      - ftm_away
      - fta_away
    sql_template: SELECT season_id, AVG(fta_home + fta_away) AS avg_fta, AVG(CASE WHEN (fta_home + fta_away) = 0 THEN 0 ELSE (ftm_home + ftm_away)*1.0/(fta_home
      + fta_away) END) AS avg_ft_pct, '{season_year}' AS season_year FROM game GROUP BY season_id ORDER BY season_id LIMIT {limit}
    examples:
      - question: 시즌별 리그 평균 자유투 시도(FTA)와 자유투 성공률 추이를 차트로 보여줘
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_073
    aliases:
      - 시즌별 리그 평균 리바운드/어시스트/턴오버 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '시즌별 리그 평균 리바운드/어시스트/턴오버 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - reb_home
      - ast_home
      - tov_home
      - reb_away
      - ast_away
      - tov_away
    sql_template: SELECT season_id, AVG(reb_home + reb_away) AS avg_rebounds, AVG(ast_home + ast_away) AS avg_assists, AVG(tov_home + tov_away)
      AS avg_turnovers, '{season_year}' AS season_year FROM game GROUP BY season_id ORDER BY season_id LIMIT {limit}
    examples:
      - question: 시즌별 리그 평균 리바운드/어시스트/턴오버 추이를 차트로 보여줘
        params:
          limit: 200
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_074
    aliases:
      - 특정 팀의 시즌별 평균 득점/실점/득실차 추이를 한 번에 비교해줘 (차트)
    description_ko: 이 메트릭은 '특정 팀의 시즌별 평균 득점/실점/득실차 추이를 한 번에 비교해줘 (차트)' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - pts_home
      - team_abbreviation_away
      - pts_away
    sql_template: SELECT season_id, AVG(CASE WHEN team_abbreviation_home = '{team_abbreviation}' THEN pts_home WHEN team_abbreviation_away = '{team_abbreviation}'
      THEN pts_away ELSE NULL END) AS avg_points, AVG(CASE WHEN team_abbreviation_home = '{team_abbreviation}' THEN pts_away WHEN team_abbreviation_away
      = '{team_abbreviation}' THEN pts_home ELSE NULL END) AS avg_points_allowed, AVG(CASE WHEN team_abbreviation_home = '{team_abbreviation}' THEN
      pts_home - pts_away WHEN team_abbreviation_away = '{team_abbreviation}' THEN pts_away - pts_home ELSE NULL END) AS avg_point_margin, '{season_year}'
      AS season_year FROM game WHERE team_abbreviation_home = '{team_abbreviation}' OR team_abbreviation_away = '{team_abbreviation}' GROUP BY season_id
      ORDER BY season_id LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 평균 득점/실점/득실차 추이를 한 번에 비교해줘 (차트)
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_075
    aliases:
      - 특정 팀의 시즌별 eFG%/TS% 추이를 차트로 비교해줘
    description_ko: 이 메트릭은 '특정 팀의 시즌별 eFG%/TS% 추이를 차트로 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - fgm_home
      - fga_home
      - fg3m_home
      - ftm_home
      - fta_home
      - team_abbreviation_away
      - fgm_away
      - fga_away
      - fg3m_away
      - ftm_away
      - fta_away
    sql_template: WITH team_stats AS ( SELECT season_id, team_abbreviation_home AS team_abbr, SUM(fgm_home) AS fgm, SUM(fga_home) AS fga, SUM(fg3m_home)
      AS fg3m, SUM(ftm_home) AS ftm, SUM(fta_home) AS fta FROM game WHERE team_abbreviation_home = '{team_abbreviation}' GROUP BY season_id, team_abbreviation_home
      UNION ALL SELECT season_id, team_abbreviation_away AS team_abbr, SUM(fgm_away) AS fgm, SUM(fga_away) AS fga, SUM(fg3m_away) AS fg3m, SUM(ftm_away)
      AS ftm, SUM(fta_away) AS fta FROM game WHERE team_abbreviation_away = '{team_abbreviation}' GROUP BY season_id, team_abbreviation_away ),
      agg AS ( SELECT season_id, SUM(fgm) AS fgm, SUM(fga) AS fga, SUM(fg3m) AS fg3m, SUM(ftm) AS ftm, SUM(fta) AS fta FROM team_stats GROUP BY
      season_id ) SELECT season_id, CASE WHEN fga = 0 THEN 0 ELSE (fgm + 0.5 * fg3m)*1.0/fga END AS efg_pct, CASE WHEN fta + 0.44 * fga = 0 THEN
      0 ELSE fgm*1.0/(2*(fga + 0.44 * fta)) END AS ts_pct, '{season_year}' AS season_year FROM agg ORDER BY season_id LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 eFG%/TS% 추이를 차트로 비교해줘
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_076
    aliases:
      - 특정 팀의 시즌별 홈 승률 vs 원정 승률 추이를 차트로 비교해줘
    description_ko: 이 메트릭은 '특정 팀의 시즌별 홈 승률 vs 원정 승률 추이를 차트로 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 조인 / cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - wl_home
      - team_abbreviation_away
      - wl_away
    sql_template: |-
      WITH home_stats AS (
        SELECT
          season_id,
          COUNT(*) AS games_home,
          SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) AS wins_home
        FROM game
        WHERE team_abbreviation_home = '{team_abbreviation}'
        GROUP BY season_id
      ),
      away_stats AS (
        SELECT
          season_id,
          COUNT(*) AS games_away,
          SUM(CASE WHEN wl_away = 'W' THEN 1 ELSE 0 END) AS wins_away
        FROM game
        WHERE team_abbreviation_away = '{team_abbreviation}'
        GROUP BY season_id
      )
      SELECT
        COALESCE(h.season_id, a.season_id) AS season_id,
        '{season_year}' AS season_year,
        CASE WHEN h.games_home > 0 THEN CAST(h.wins_home AS FLOAT) / h.games_home ELSE NULL END AS home_win_pct,
        CASE WHEN a.games_away > 0 THEN CAST(a.wins_away AS FLOAT) / a.games_away ELSE NULL END AS away_win_pct
      FROM home_stats h
      FULL OUTER JOIN away_stats a ON h.season_id = a.season_id
      ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 홈 승률 vs 원정 승률 추이를 차트로 비교해줘
        params:
          limit: 200
          season_year: 2022-23
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_077
    aliases:
      - 특정 시즌에서 팀별 월간 승률(혹은 승수) 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 팀별 월간 승률(혹은 승수) 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: team_abbreviation, year_month · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_date
      - wl_home
      - team_abbreviation_away
      - wl_away
    sql_template: |-
      WITH games AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          strftime('%Y-%m', game_date) AS year_month,
          COUNT(*) AS games_played,
          SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) AS wins
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY team_abbreviation_home, year_month
        UNION ALL
        SELECT
          team_abbreviation_away AS team_abbreviation,
          strftime('%Y-%m', game_date) AS year_month,
          COUNT(*) AS games_played,
          SUM(CASE WHEN wl_away = 'W' THEN 1 ELSE 0 END) AS wins
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY team_abbreviation_away, year_month
      ),
      agg AS (
        SELECT
          team_abbreviation,
          year_month,
          SUM(games_played) AS total_games,
          SUM(wins) AS total_wins
        FROM games
        GROUP BY team_abbreviation, year_month
      )
      SELECT
        team_abbreviation,
        year_month,
        total_wins,
        total_games,
        CASE WHEN total_games > 0 THEN CAST(total_wins AS FLOAT) / total_games ELSE NULL END AS win_pct
      FROM agg
      ORDER BY team_abbreviation, year_month
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 팀별 월간 승률(혹은 승수) 추이를 차트로 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_078
    aliases:
      - 특정 시즌에서 팀별 월간 평균 득점/실점 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 팀별 월간 평균 득점/실점 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: team_abbreviation, year_month · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_date
      - pts_home
      - team_abbreviation_away
      - pts_away
    sql_template: |-
      WITH monthly_scores AS (
        SELECT
          team_abbreviation_home AS team_abbreviation,
          strftime('%Y-%m', game_date) AS year_month,
          SUM(pts_home) AS total_pts_scored,
          SUM(pts_away) AS total_pts_allowed,
          COUNT(*) AS games_played
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY team_abbreviation_home, year_month
        UNION ALL
        SELECT
          team_abbreviation_away AS team_abbreviation,
          strftime('%Y-%m', game_date) AS year_month,
          SUM(pts_away) AS total_pts_scored,
          SUM(pts_home) AS total_pts_allowed,
          COUNT(*) AS games_played
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY team_abbreviation_away, year_month
      ),
      agg AS (
        SELECT
          team_abbreviation,
          year_month,
          SUM(total_pts_scored) AS total_pts_scored,
          SUM(total_pts_allowed) AS total_pts_allowed,
          SUM(games_played) AS total_games
        FROM monthly_scores
        GROUP BY team_abbreviation, year_month
      )
      SELECT
        team_abbreviation,
        year_month,
        CASE WHEN total_games > 0 THEN CAST(total_pts_scored AS FLOAT) / total_games ELSE NULL END AS avg_pts_scored,
        CASE WHEN total_games > 0 THEN CAST(total_pts_allowed AS FLOAT) / total_games ELSE NULL END AS avg_pts_allowed
      FROM agg
      ORDER BY team_abbreviation, year_month
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 팀별 월간 평균 득점/실점 추이를 차트로 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_079
    aliases:
      - 특정 팀의 월별 홈 평균 관중 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '특정 팀의 월별 홈 평균 관중 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, game_info 테이블을 활용해 평균 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: year_month · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_info
    required_columns:
      - team_abbreviation_home
      - game_id
      - game_date
      - attendance
    sql_template: |-
      SELECT
        strftime('%Y-%m', g.game_date) AS year_month,
        AVG(gi.attendance) AS avg_attendance
      FROM game g
      JOIN game_info gi ON g.game_id = gi.game_id
      WHERE g.team_abbreviation_home = '{team_abbreviation}'
      GROUP BY year_month
      ORDER BY year_month
      LIMIT {limit}
    examples:
      - question: 특정 팀의 월별 홈 평균 관중 추이를 차트로 보여줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_080
    aliases:
      - 특정 시즌에서 관중 상위 팀들의 “월별 평균 관중 추이”를 한 차트에서 비교해줘
    description_ko: 이 메트릭은 '특정 시즌에서 관중 상위 팀들의 “월별 평균 관중 추이”를 한 차트에서 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game, game_info 테이블을 활용해 조인 / cte / 그룹 집계 / 평균
      / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: avg_attendance DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_info
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - game_date
      - attendance
    sql_template: |-
      WITH team_attendance AS (
        SELECT
          g.team_abbreviation_home AS team_abbreviation,
          AVG(gi.attendance) AS avg_attendance
        FROM game g
        JOIN game_info gi ON g.game_id = gi.game_id
        WHERE g.season_id = '{season_id}'
        GROUP BY g.team_abbreviation_home
      ),
      top_teams AS (
        SELECT team_abbreviation
        FROM team_attendance
        ORDER BY avg_attendance DESC
        LIMIT {top_k}
      ),
      monthly_attendance AS (
        SELECT
          g.team_abbreviation_home AS team_abbreviation,
          strftime('%Y-%m', g.game_date) AS year_month,
          AVG(gi.attendance) AS avg_attendance
        FROM game g
        JOIN game_info gi ON g.game_id = gi.game_id
        WHERE g.season_id = '{season_id}'
          AND g.team_abbreviation_home IN (SELECT team_abbreviation FROM top_teams)
        GROUP BY g.team_abbreviation_home, year_month
      )
      SELECT
        team_abbreviation,
        year_month,
        avg_attendance
      FROM monthly_attendance
      ORDER BY team_abbreviation, year_month
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 관중 상위 팀들의 “월별 평균 관중 추이”를 한 차트에서 비교해줘
        params:
          limit: 200
          season_id: '22022'
          top_k: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: line_score_014
    aliases:
      - 특정 시즌에서 연장전 경기 비율(OT 경기 수 / 전체 경기 수) 추이를 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 연장전 경기 비율(OT 경기 수 / 전체 경기 수) 추이를 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 line_score 테이블을 활용해 cte / 그룹 집계 / 합계 / 카운트 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM/COUNT · 정렬: year_month · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - game_date
      - min
    sql_template: |-
      WITH monthly_games AS (
        SELECT
          strftime('%Y-%m', date(game_date)) AS year_month,
          COUNT(*) AS total_games,
          SUM(CASE WHEN min > 48 THEN 1 ELSE 0 END) AS ot_games
        FROM game
        WHERE season_id = '{season_id}'
        GROUP BY year_month
      )
      SELECT
        year_month,
        ot_games,
        total_games,
        CASE WHEN total_games > 0 THEN CAST(ot_games AS FLOAT) / total_games ELSE NULL END AS ot_ratio
      FROM monthly_games
      ORDER BY year_month
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 연장전 경기 비율(OT 경기 수 / 전체 경기 수) 추이를 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_014
    aliases:
      - 시즌별 평균 lead_changes / times_tied 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '시즌별 평균 lead_changes / times_tied 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - lead_changes
      - times_tied
      - game_id
      - season_id
    sql_template: |-
      SELECT
        g.season_id,
        AVG(o.lead_changes) AS avg_lead_changes,
        AVG(o.times_tied) AS avg_times_tied
      FROM other_stats o
      JOIN game g ON o.game_id = g.game_id
      GROUP BY g.season_id
      ORDER BY g.season_id
      LIMIT {limit}
    examples:
      - question: 시즌별 평균 lead_changes / times_tied 추이를 차트로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: other_stats_015
    aliases:
      - 특정 팀의 시즌별 평균 lead_changes / times_tied 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '특정 팀의 시즌별 평균 lead_changes / times_tied 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 other_stats 테이블을 활용해 그룹 집계 / 평균 / 정렬 로직으로
      결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - other_stats
      - game
    required_columns:
      - lead_changes
      - times_tied
      - game_id
      - season_id
      - team_abbreviation_home
      - team_abbreviation_away
    sql_template: |-
      SELECT
        g.season_id,
        AVG(o.lead_changes) AS avg_lead_changes,
        AVG(o.times_tied) AS avg_times_tied
      FROM other_stats o
      JOIN game g ON o.game_id = g.game_id
      WHERE g.team_abbreviation_home = '{team_abbreviation}' OR g.team_abbreviation_away = '{team_abbreviation}'
      GROUP BY g.season_id
      ORDER BY g.season_id
      LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 평균 lead_changes / times_tied 추이를 차트로 보여줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_081
    aliases:
      - 시즌별 “접전 경기 비율(마지막 5점 이내)” 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '시즌별 “접전 경기 비율(마지막 5점 이내)” 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: t.season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - pts_home
      - pts_away
    sql_template: WITH close_games AS ( SELECT season_id, COUNT(*) AS close_game_count FROM game WHERE ABS(pts_home - pts_away) <= 5 GROUP BY season_id
      ), total_games AS ( SELECT season_id, COUNT(*) AS total_game_count FROM game GROUP BY season_id ) SELECT t.season_id, COALESCE(c.close_game_count,
      0) * 1.0 / t.total_game_count AS close_game_ratio FROM total_games t LEFT JOIN close_games c ON t.season_id = c.season_id ORDER BY t.season_id
      LIMIT {limit}
    examples:
      - question: 시즌별 “접전 경기 비율(마지막 5점 이내)” 추이를 차트로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_082
    aliases:
      - 특정 팀의 시즌별 “접전 경기 비율” 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '특정 팀의 시즌별 “접전 경기 비율” 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트 / 정렬 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: t.season_id · 제한: LIMIT {limit}'
    required_tables:
      - game
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - pts_home
      - team_abbreviation_away
      - pts_away
    sql_template: WITH team_games AS ( SELECT season_id, game_id, pts_home, pts_away FROM game WHERE team_abbreviation_home = '{team_abbreviation}'
      OR team_abbreviation_away = '{team_abbreviation}' ), close_games AS ( SELECT season_id, COUNT(*) AS close_game_count FROM team_games WHERE
      ABS(pts_home - pts_away) <= 5 GROUP BY season_id ), total_games AS ( SELECT season_id, COUNT(*) AS total_game_count FROM team_games GROUP
      BY season_id ) SELECT t.season_id, COALESCE(c.close_game_count, 0) * 1.0 / t.total_game_count AS close_game_ratio FROM total_games t LEFT
      JOIN close_games c ON t.season_id = c.season_id ORDER BY t.season_id LIMIT {limit}
    examples:
      - question: 특정 팀의 시즌별 “접전 경기 비율” 추이를 차트로 보여줘
        params:
          limit: 200
          team_abbreviation: GSW
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_083
    aliases:
      - 시즌별 평균 경기 시간(game_time) 추이를 차트로 보여줘
    description_ko: 이 메트릭은 '시즌별 평균 경기 시간(game_time) 추이를 차트로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game_info, game 테이블을 활용해 조인 / 그룹 집계 / 평균 / 정렬 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG · 정렬: season_id · 제한: LIMIT {limit}'
    required_tables:
      - game_info
      - game
    required_columns:
      - game_id
      - game_time
      - season_id
    sql_template: SELECT season_id, AVG(CAST(strftime('%H', game_time) AS INTEGER) * 3600 + CAST(strftime('%M', game_time) AS INTEGER) * 60 + CAST(strftime('%S',
      game_time) AS INTEGER)) AS avg_game_time_seconds FROM game_info g JOIN game gm ON g.game_id = gm.game_id GROUP BY season_id ORDER BY season_id
      LIMIT {limit}
    examples:
      - question: 시즌별 평균 경기 시간(game_time) 추이를 차트로 보여줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_084
    aliases:
      - 특정 시즌에서 경기 시간이 긴 팀/짧은 팀을 비교해줘
    description_ko: 이 메트릭은 '특정 시즌에서 경기 시간이 긴 팀/짧은 팀을 비교해줘' 요청을 처리하기 위한 조회 정의다. 주로 game, game_info 테이블을 활용해 조인 / cte / 그룹 집계 / 순위 계산 / 평균 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: AVG/RANK · 정렬: avg_game_time_seconds DESC) AS rank_desc, RANK() OVER (ORDER BY avg_game_time_seconds ASC) AS rank_asc FROM
      avg_team_times ) SELECT ''Longest Game Time Teams'' AS category, team_abbreviation, avg_game_time_seconds FROM ranked_teams WHERE rank_desc
      <= {top_k} UNION ALL SELECT ''Shortest Game Time Teams'' AS category, team_abbreviation, avg_game_time_seconds FROM ranked_teams WHERE rank_asc
      <= {top_k} · 제한: LIMIT {limit}'
    required_tables:
      - game
      - game_info
    required_columns:
      - season_id
      - team_abbreviation_home
      - game_id
      - team_abbreviation_away
      - game_time
    sql_template: WITH team_game_times AS ( SELECT gm.season_id, gm.team_abbreviation_home AS team_abbreviation, CAST(strftime('%H', gi.game_time)
      AS INTEGER) * 3600 + CAST(strftime('%M', gi.game_time) AS INTEGER) * 60 + CAST(strftime('%S', gi.game_time) AS INTEGER) AS game_time_seconds
      FROM game gm JOIN game_info gi ON gm.game_id = gi.game_id WHERE gm.season_id = '{season_id}' UNION ALL SELECT gm.season_id, gm.team_abbreviation_away
      AS team_abbreviation, CAST(strftime('%H', gi.game_time) AS INTEGER) * 3600 + CAST(strftime('%M', gi.game_time) AS INTEGER) * 60 + CAST(strftime('%S',
      gi.game_time) AS INTEGER) AS game_time_seconds FROM game gm JOIN game_info gi ON gm.game_id = gi.game_id WHERE gm.season_id = '{season_id}'
      ), avg_team_times AS ( SELECT team_abbreviation, AVG(game_time_seconds) AS avg_game_time_seconds FROM team_game_times GROUP BY team_abbreviation
      ), ranked_teams AS ( SELECT team_abbreviation, avg_game_time_seconds, RANK() OVER (ORDER BY avg_game_time_seconds DESC) AS rank_desc, RANK()
      OVER (ORDER BY avg_game_time_seconds ASC) AS rank_asc FROM avg_team_times ) SELECT 'Longest Game Time Teams' AS category, team_abbreviation,
      avg_game_time_seconds FROM ranked_teams WHERE rank_desc <= {top_k} UNION ALL SELECT 'Shortest Game Time Teams' AS category, team_abbreviation,
      avg_game_time_seconds FROM ranked_teams WHERE rank_asc <= {top_k} LIMIT {limit}
    examples:
      - question: 특정 시즌에서 경기 시간이 긴 팀/짧은 팀을 비교해줘
        params:
          limit: 200
          season_id: '22022'
          top_k: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_085
    aliases:
      - 특정 시즌에서 “3PT” 성공/실패 이벤트를 선수별로 집계해서 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “3PT” 성공/실패 이벤트를 선수별로 집계해서 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, play_by_play 테이블을 활용해 cte / 합계 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SUM · 정렬: three_pt_made DESC, three_pt_attempts DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - play_by_play
    required_columns:
      - season_id
      - game_id
      - eventmsgtype
      - eventmsgactiontype
      - player1_id
      - player1_name
    sql_template: "WITH season_games AS (\n  SELECT game_id\n  FROM game\n  WHERE season_id = '{season_id}'\n),\nthree_pt_events AS (\n  SELECT\
      \ player1_id AS player_id, player1_name AS player_name, \n         CASE WHEN eventmsgtype = 1 AND eventmsgactiontype IN (3,4) THEN 1 ELSE\
      \ 0 END AS made,\n         CASE WHEN eventmsgtype = 1 AND eventmsgactiontype IN (5,6) THEN 1 ELSE 0 END AS missed\n  FROM play_by_play\n \
      \ WHERE game_id IN (SELECT game_id FROM season_games)\n    AND eventmsgtype = 1\n    AND eventmsgactiontype IN (3,4,5,6) -- 3PT made/missed\n\
      \    AND player1_id IS NOT NULL\n)\nSELECT player_id, player_name, SUM(made) AS three_pt_made, SUM(missed) AS three_pt_missed, (SUM(made)\
      \ + SUM(missed)) AS three_pt_attempts, '{season_year}' AS season_year\nFROM three_pt_events\nGROUP BY player_id, player_name\nORDER BY three_pt_made\
      \ DESC, three_pt_attempts DESC\nLIMIT {limit}"
    examples:
      - question: 특정 시즌에서 “3PT” 성공/실패 이벤트를 선수별로 집계해서 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_086
    aliases:
      - 특정 시즌에서 “DUNK” 이벤트가 가장 많은 선수 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “DUNK” 이벤트가 가장 많은 선수 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, play_by_play 테이블을 활용해 cte / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: dunk_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - play_by_play
    required_columns:
      - season_id
      - game_id
      - eventmsgtype
      - eventmsgactiontype
      - player1_id
      - player1_name
    sql_template: |-
      WITH season_games AS (
        SELECT game_id
        FROM game
        WHERE season_id = '{season_id}'
      ),
      dunk_events AS (
        SELECT player1_id AS player_id, player1_name AS player_name
        FROM play_by_play
        WHERE game_id IN (SELECT game_id FROM season_games)
          AND eventmsgtype = 1
          AND eventmsgactiontype = 7 -- dunk event
          AND player1_id IS NOT NULL
      )
      SELECT player_id, player_name, COUNT(*) AS dunk_count, '{season_year}' AS season_year
      FROM dunk_events
      GROUP BY player_id, player_name
      ORDER BY dunk_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 “DUNK” 이벤트가 가장 많은 선수 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: unsupported_003
    aliases:
      - 특정 시즌에서 “BLOCK”이 언급된 이벤트가 가장 많은 선수 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “BLOCK”이 언급된 이벤트가 가장 많은 선수 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 테이블 미지정 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables: []
    required_columns: []
    sql_template: |-
      SELECT 'notice: 블록 이벤트는 play_by_play 텍스트(description) 파싱이 필요해 코드(eventmsgtype/eventmsgactiontype)만으로는 정확히 분리하기 어렵습니다.' AS notice
      LIMIT {limit};
    examples:
      - question: 특정 시즌에서 “BLOCK”이 언급된 이벤트가 가장 많은 선수 TOP 20을 보여줘
        params:
          limit: 10
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_087
    aliases:
      - 특정 시즌에서 “STEAL”이 언급된 이벤트가 가장 많은 선수 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “STEAL”이 언급된 이벤트가 가장 많은 선수 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, play_by_play 테이블을 활용해 cte / 카운트 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: steal_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - play_by_play
    required_columns:
      - season_id
      - game_id
      - eventmsgtype
      - player1_id
      - player1_name
    sql_template: |-
      WITH season_games AS (
        SELECT game_id
        FROM game
        WHERE season_id = '{season_id}'
      ),
      steal_events AS (
        SELECT player1_id AS player_id, player1_name AS player_name
        FROM play_by_play
        WHERE game_id IN (SELECT game_id FROM season_games)
          AND eventmsgtype = 5 -- steal eventmsgtype
          AND player1_id IS NOT NULL
      )
      SELECT player_id, player_name, COUNT(*) AS steal_count, '{season_year}' AS season_year
      FROM steal_events
      GROUP BY player_id, player_name
      ORDER BY steal_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 “STEAL”이 언급된 이벤트가 가장 많은 선수 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_088
    aliases:
      - 특정 시즌에서 “TECHNICAL” 파울 이벤트가 가장 많은 선수/팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “TECHNICAL” 파울 이벤트가 가장 많은 선수/팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, play_by_play 테이블을 활용해 cte / 카운트 로직으로 결과를 구성한다.
      플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: technical_foul_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - play_by_play
    required_columns:
      - season_id
      - game_id
      - eventmsgtype
      - player1_id
      - player1_name
      - player1_team_abbreviation
    sql_template: |-
      WITH season_games AS (
        SELECT game_id
        FROM game
        WHERE season_id = '{season_id}'
      ),
      technical_events AS (
        SELECT player1_id AS player_id, player1_name AS player_name, player1_team_abbreviation AS team_abbreviation
        FROM play_by_play
        WHERE game_id IN (SELECT game_id FROM season_games)
          AND eventmsgtype = 6 -- technical foul eventmsgtype
          AND player1_id IS NOT NULL
      )
      SELECT player_id, player_name, team_abbreviation, COUNT(*) AS technical_foul_count, '{season_year}' AS season_year
      FROM technical_events
      GROUP BY player_id, player_name, team_abbreviation
      ORDER BY technical_foul_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 “TECHNICAL” 파울 이벤트가 가장 많은 선수/팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: game_089
    aliases:
      - 특정 시즌에서 “FLAGRANT” 파울 이벤트가 가장 많은 경기 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “FLAGRANT” 파울 이벤트가 가장 많은 경기 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 game, play_by_play 테이블을 활용해 cte / 카운트 로직으로 결과를
      구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: flagrant_foul_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - game
      - play_by_play
    required_columns:
      - season_id
      - game_id
      - eventmsgtype
    sql_template: |-
      WITH season_games AS (
        SELECT game_id
        FROM game
        WHERE season_id = '{season_id}'
      ),
      flagrant_events AS (
        SELECT game_id
        FROM play_by_play
        WHERE game_id IN (SELECT game_id FROM season_games)
          AND eventmsgtype = 7 -- flagrant foul eventmsgtype
      )
      SELECT game_id, COUNT(*) AS flagrant_foul_count, '{season_year}' AS season_year
      FROM flagrant_events
      GROUP BY game_id
      ORDER BY flagrant_foul_count DESC
      LIMIT {limit}
    examples:
      - question: 특정 시즌에서 “FLAGRANT” 파울 이벤트가 가장 많은 경기 TOP 20을 보여줘
        params:
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_012
    aliases:
      - 특정 시즌에서 “TIMEOUT” 이벤트가 가장 많은 팀(홈/원정 구분 가능)을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “TIMEOUT” 이벤트가 가장 많은 팀(홈/원정 구분 가능)을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 조인 / cte / 그룹 집계
      / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - player1_team_abbreviation
      - season_id
      - team_abbreviation_home
      - team_abbreviation_away
    sql_template: "WITH timeout_events AS (  \n  SELECT  \n    CASE  \n      WHEN player1_team_abbreviation = team_abbreviation_home THEN 'home'\
      \  \n      WHEN player1_team_abbreviation = team_abbreviation_away THEN 'away'  \n      ELSE 'unknown'  \n    END AS location,  \n    player1_team_abbreviation\
      \ AS team_abbreviation,  \n    COUNT(*) AS timeout_count  \n  FROM play_by_play pbp  \n  JOIN game g ON pbp.game_id = g.game_id  \n  WHERE\
      \ eventmsgtype = 9  -- TIMEOUT eventmsgtype  \n    AND season_id = '{season_id}'  \n  GROUP BY location, player1_team_abbreviation  \n), max_timeout\
      \ AS (  \n  SELECT location, MAX(timeout_count) AS max_count  \n  FROM timeout_events  \n  GROUP BY location  \n)  \nSELECT t.location, t.team_abbreviation,\
      \ t.timeout_count  \nFROM timeout_events t  \nJOIN max_timeout m ON t.location = m.location AND t.timeout_count = m.max_count  \nLIMIT {limit}"
    examples:
      - question: 특정 시즌에서 “TIMEOUT” 이벤트가 가장 많은 팀(홈/원정 구분 가능)을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_013
    aliases:
      - 특정 시즌에서 “SUBSTITUTION” 이벤트가 가장 많은 팀을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 “SUBSTITUTION” 이벤트가 가장 많은 팀을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 조인 / cte / 그룹 집계 / 카운트
      로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - player1_team_abbreviation
      - season_id
    sql_template: "WITH substitution_events AS (  \n  SELECT  \n    player1_team_abbreviation AS team_abbreviation,  \n    COUNT(*) AS substitution_count\
      \  \n  FROM play_by_play pbp  \n  JOIN game g ON pbp.game_id = g.game_id  \n  WHERE eventmsgtype = 8  -- SUBSTITUTION eventmsgtype  \n   \
      \ AND season_id = '{season_id}'  \n  GROUP BY player1_team_abbreviation  \n), max_substitution AS (  \n  SELECT MAX(substitution_count) AS\
      \ max_count  \n  FROM substitution_events  \n)  \nSELECT team_abbreviation, substitution_count  \nFROM substitution_events  \nWHERE substitution_count\
      \ = (SELECT max_count FROM max_substitution)  \nLIMIT {limit}"
    examples:
      - question: 특정 시즌에서 “SUBSTITUTION” 이벤트가 가장 많은 팀을 보여줘
        params:
          limit: 200
          season_id: '22022'
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_014
    aliases:
      - 특정 경기에서 특정 선수의 모든 득점 관련 이벤트만 모아 타임라인으로 보여줘
    description_ko: 이 메트릭은 '특정 경기에서 특정 선수의 모든 득점 관련 이벤트만 모아 타임라인으로 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: eventnum · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
    required_columns:
      - game_id
      - eventnum
      - eventmsgtype
      - eventmsgactiontype
      - period
      - wctimestring
      - pctimestring
      - score
      - scoremargin
      - player1_id
    sql_template: "SELECT eventnum, period, wctimestring, pctimestring, eventmsgtype, eventmsgactiontype, score, scoremargin  \nFROM play_by_play\
      \  \nWHERE game_id = '{game_id}'  \n  AND player1_id = '{player_name}'  \n  AND eventmsgtype IN (1, 2, 3, 4)  -- 득점 관련 이벤트 (예: 1=Made Shot,\
      \ 2=Missed Shot, 3=Free Throw, 4=Rebound 등 필요에 따라 조정)  \nORDER BY eventnum  \nLIMIT {limit}"
    examples:
      - question: 특정 경기에서 특정 선수의 모든 득점 관련 이벤트만 모아 타임라인으로 보여줘
        params:
          game_id: '0022200001'
          limit: 200
          player_name: Stephen Curry
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_015
    aliases:
      - 특정 경기에서 “마지막 5분”의 득점 이벤트만 모아 요약해줘
    description_ko: 이 메트릭은 '특정 경기에서 “마지막 5분”의 득점 이벤트만 모아 요약해줘' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play 테이블을 활용해 cte 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 정렬: eventnum · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
    required_columns:
      - game_id
      - eventnum
      - eventmsgtype
      - eventmsgactiontype
      - period
      - wctimestring
      - pctimestring
      - score
      - scoremargin
      - player1_id
      - player1_name
      - player1_team_abbreviation
    sql_template: "WITH last_5_minutes AS (  \n  SELECT *  \n  FROM play_by_play  \n  WHERE game_id = '{game_id}'  \n    AND (period = 4 AND CAST(SUBSTR(pctimestring,\
      \ 1, 2) AS INTEGER) * 60 + CAST(SUBSTR(pctimestring, 4, 2) AS INTEGER) <= 300)  \n    AND eventmsgtype IN (1, 3)  -- 득점 이벤트: 1=Field Goal\
      \ Made, 3=Free Throw Made  \n)  \nSELECT eventnum, period, wctimestring, pctimestring, player1_id, player1_name, player1_team_abbreviation,\
      \ eventmsgtype, eventmsgactiontype, score, scoremargin  \nFROM last_5_minutes  \nORDER BY eventnum  \nLIMIT {limit}"
    examples:
      - question: 특정 경기에서 “마지막 5분”의 득점 이벤트만 모아 요약해줘
        params:
          game_id: '0022200001'
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
  - name: pbp_016
    aliases:
      - 특정 시즌에서 클러치 타임(4Q 2분 이내) 득점 이벤트가 많은 선수 TOP 20을 보여줘
    description_ko: 이 메트릭은 '특정 시즌에서 클러치 타임(4Q 2분 이내) 득점 이벤트가 많은 선수 TOP 20을 보여줘' 요청을 처리하기 위한 조회 정의다. 주로 play_by_play, game 테이블을 활용해 조인 / cte / 그룹
      집계 / 카운트 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수) 값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: COUNT · 정렬: clutch_score_count DESC · 제한: LIMIT {limit}'
    required_tables:
      - play_by_play
      - game
    required_columns:
      - game_id
      - eventmsgtype
      - period
      - pctimestring
      - player1_id
      - player1_name
      - season_id
    sql_template: "WITH clutch_events AS (  \n  SELECT player1_id, player1_name, COUNT(*) AS clutch_score_count  \n  FROM play_by_play pbp  \n \
      \ JOIN game g ON pbp.game_id = g.game_id  \n  WHERE season_id = '{season_id}'  \n    AND period = 4  \n    AND (CAST(SUBSTR(pctimestring,\
      \ 1, 2) AS INTEGER) * 60 + CAST(SUBSTR(pctimestring, 4, 2) AS INTEGER)) <= {clutch_seconds}  \n    AND eventmsgtype IN (1, 3)  -- 득점 이벤트:\
      \ 1=Field Goal Made, 3=Free Throw Made  \n  GROUP BY player1_id, player1_name  \n)  \nSELECT player1_id, player1_name, clutch_score_count,\
      \ '{season_year}' AS season_year  \nFROM clutch_events  \nORDER BY clutch_score_count DESC  \nLIMIT {limit};"
    examples:
      - question: 특정 시즌에서 클러치 타임(4Q 2분 이내) 득점 이벤트가 많은 선수 TOP 20을 보여줘
        params:
          clutch_seconds: 120
          limit: 10
          season_id: '22022'
          season_year: 2022-23
    cut_rules:
      min_games: null
      min_minutes: null
  - name: unsupported_004
    aliases:
      - 특정 팀 vs 팀 맞대결에서 가장 많이 등장한 선수/이벤트 키워드를 요약해줘
    description_ko: 이 메트릭은 '특정 팀 vs 팀 맞대결에서 가장 많이 등장한 선수/이벤트 키워드를 요약해줘' 요청을 처리하기 위한 조회 정의다. 주로 테이블 미지정 테이블을 활용해 기본 조회/필터 로직으로 결과를 구성한다. 플레이스홀더(시즌/팀/선수/기간/개수)
      값에 따라 결과가 달라지며, NULL/데이터 공백으로 일부 행이 제외될 수 있다.
    formula_ko: '집계/조회: SELECT · 제한: LIMIT {limit}'
    required_tables: []
    required_columns: []
    sql_template: |-
      SELECT 'notice: 플레이바이플레이 키워드 요약은 텍스트(description) 파싱이 필요합니다. eventmsgtype/eventmsgactiontype 기반 빈도 분석으로는 확장 가능합니다.' AS notice
      LIMIT {limit};
    examples:
      - question: 특정 팀 vs 팀 맞대결에서 가장 많이 등장한 선수/이벤트 키워드를 요약해줘
        params:
          limit: 200
    cut_rules:
      min_games: null
      min_minutes: null
