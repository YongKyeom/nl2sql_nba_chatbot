{"timestamp": "2026-01-05T22:59:08.276127", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "sql_required", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 22932.727084000362, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-05T22:59:44.747444", "user_text": "관중 수 상위 10팀의 시즌 성적과 순위를 정리해줘", "route": "reuse", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 8395.44120899518, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-05T23:00:33.096084", "user_text": "2018 드래프트 전체 픽 리스트 보여줘", "route": "sql_required", "sql": "SELECT season, overall_pick, player_name, team_name, team_abbreviation, round_number, round_pick FROM draft_history WHERE season = '2018' ORDER BY overall_pick LIMIT 200", "rows": 60, "latency_ms": 22095.81729200727, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-05T23:05:16.923550", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "sql_required", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 29060.763166999095, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-05T23:06:04.192152", "user_text": "관중 수 상위 10팀의 시즌 성적과 순위를 정리해줘", "route": "reuse", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 7616.53958298848, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-05T23:06:29.312747", "user_text": "관중 수 상위 10개 팀의 시즌 승률/순위를 같이 보여줘", "route": "sql_required", "sql": "WITH arena_top AS (SELECT team_id, abbreviation, arenacapacity FROM team_details ORDER BY arenacapacity DESC LIMIT 10),\nhome_stats AS (\n  SELECT g.team_id_home AS team_id, AVG(gi.attendance) AS avg_attendance, AVG(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS win_rate\n  FROM game g\n  JOIN game_info gi ON g.game_id = gi.game_id\n  WHERE g.team_id_home IN (SELECT team_id FROM arena_top)\n  GROUP BY g.team_id_home\n)\nSELECT a.abbreviation, a.arenacapacity, COALESCE(h.avg_attendance, 0) AS avg_attendance, COALESCE(h.win_rate, 0) AS win_rate\nFROM arena_top a\nLEFT JOIN home_stats h ON a.team_id = h.team_id\nORDER BY a.arenacapacity DESC\nLIMIT 10", "rows": 10, "latency_ms": 22662.52795899345, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-05T23:09:29.986277", "user_text": "최근 리그에서 승률 상위 5개 팀 알려줘", "route": "reuse", "sql": "WITH arena_top AS (SELECT team_id, abbreviation, arenacapacity FROM team_details ORDER BY arenacapacity DESC LIMIT 10),\nhome_stats AS (\n  SELECT g.team_id_home AS team_id, AVG(gi.attendance) AS avg_attendance, AVG(CASE WHEN g.wl_home = 'W' THEN 1 ELSE 0 END) AS win_rate\n  FROM game g\n  JOIN game_info gi ON g.game_id = gi.game_id\n  WHERE g.team_id_home IN (SELECT team_id FROM arena_top)\n  GROUP BY g.team_id_home\n)\nSELECT a.abbreviation, a.arenacapacity, COALESCE(h.avg_attendance, 0) AS avg_attendance, COALESCE(h.win_rate, 0) AS win_rate\nFROM arena_top a\nLEFT JOIN home_stats h ON a.team_id = h.team_id\nORDER BY a.arenacapacity DESC\nLIMIT 10", "rows": 5, "latency_ms": 5009.469333002926, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-05T23:10:48.729989", "user_text": "관중 수 상위 10개 팀의 시즌 승률/순위를 같이 보여줘", "route": "sql_required", "sql": "WITH attendance_top_teams AS (\n  SELECT\n    g.team_id_home AS team_id,\n    g.team_abbreviation_home AS abbreviation\n  FROM game g\n  JOIN game_info gi ON g.game_id = gi.game_id\n  WHERE g.season_id = '22022'\n  GROUP BY g.team_id_home\n  ORDER BY AVG(gi.attendance) DESC\n  LIMIT 10\n),\nseason_stats AS (\n  SELECT\n    team_abbreviation_home AS abbreviation,\n    COUNT(CASE WHEN wl_home = 'W' THEN 1 END) AS w,\n    COUNT(CASE WHEN wl_home = 'L' THEN 1 END) AS l,\n    CAST(COUNT(CASE WHEN wl_home = 'W' THEN 1 END) AS FLOAT) / COUNT(*) AS pct\n  FROM game\n  WHERE season_id = '22022'\n  GROUP BY team_abbreviation_home\n),\nfinal_stats AS (\n  SELECT att.abbreviation, ss.pct AS win_pct, ss.w, ss.l\n  FROM attendance_top_teams att\n  LEFT JOIN season_stats ss ON att.abbreviation = ss.abbreviation\n)\nSELECT *\nFROM final_stats\nORDER BY win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 73049.75120899326, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T10:58:54.004560", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "sql_required", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 36666.34391700791, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:09:11.318379", "user_text": "관중 수 상위 10개 팀의 승패와 리그 순위를 알려줘", "route": "sql_required", "sql": "WITH top_10_teams AS ( SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance FROM game_info JOIN game ON game_info.game_id = game.game_id GROUP BY team_abbreviation_home ORDER BY total_attendance DESC LIMIT 10 ), team_stats AS ( SELECT team_abbreviation_home AS team_abbreviation, COUNT(*) AS games_played, SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct, SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus, SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct, (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct FROM game GROUP BY team_abbreviation_home ) SELECT t.team_abbreviation, s.win_pct, s.avg_plus_minus AS plus_minus, s.ts_pct, s.efg_pct FROM top_10_teams t JOIN team_stats s ON t.team_abbreviation = s.team_abbreviation ORDER BY s.win_pct DESC LIMIT 10", "rows": 10, "latency_ms": 47492.858458994306, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:11:21.635318", "user_text": "관중 수 상위 10개 팀의 최근 리그 순위를 분석해줘", "route": "reuse", "sql": "WITH top_10_teams AS ( SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance FROM game_info JOIN game ON game_info.game_id = game.game_id GROUP BY team_abbreviation_home ORDER BY total_attendance DESC LIMIT 10 ), team_stats AS ( SELECT team_abbreviation_home AS team_abbreviation, COUNT(*) AS games_played, SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct, SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus, SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct, (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct FROM game GROUP BY team_abbreviation_home ) SELECT t.team_abbreviation, s.win_pct, s.avg_plus_minus AS plus_minus, s.ts_pct, s.efg_pct FROM top_10_teams t JOIN team_stats s ON t.team_abbreviation = s.team_abbreviation ORDER BY s.win_pct DESC LIMIT 10", "rows": 10, "latency_ms": 6994.9945410044165, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:12:11.804181", "user_text": "2023-24 시즌 팀 득점 상위 10개 보여줘", "route": "sql_required", "sql": "WITH team_games AS (\n  SELECT season_id, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, pts_home AS pts\n  FROM game\n  WHERE season_id = '22022' AND season_type = 'Regular Season'\n  UNION ALL\n  SELECT season_id, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, pts_away AS pts\n  FROM game\n  WHERE season_id = '22022' AND season_type = 'Regular Season'\n)\nSELECT team_name,\n       team_abbreviation,\n       '2022-23' AS season_year,\n       AVG(pts) AS pts_pg\nFROM team_games\nGROUP BY team_abbreviation, team_name\nORDER BY pts_pg DESC\nLIMIT 10", "rows": 10, "latency_ms": 24663.453415996628, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:14:59.385548", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "sql_required", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 21328.84912499867, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:17:32.470888", "user_text": "2023-24 시즌 팀 득점 상위 10개 보여줘", "route": "sql_required", "sql": "WITH team_games AS (\n  SELECT season_id, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, pts_home AS pts\n  FROM game\n  WHERE season_id = '22022' AND season_type = 'Regular Season'\n  UNION ALL\n  SELECT season_id, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, pts_away AS pts\n  FROM game\n  WHERE season_id = '22022' AND season_type = 'Regular Season'\n)\nSELECT team_name,\n       team_abbreviation,\n       '2022-23' AS season_year,\n       AVG(pts) AS pts_pg\nFROM team_games\nGROUP BY team_abbreviation, team_name\nORDER BY pts_pg DESC\nLIMIT 10", "rows": 10, "latency_ms": 22634.765958006028, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:23:28.195181", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "sql_required", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 22534.6376660018, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:24:08.467893", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "sql_required", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 21596.83754100115, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:24:29.112180", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "reuse", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 5731.94150000927, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:24:40.325711", "user_text": "관중 수 상위 10팀의 시즌 성적과 순위를 정리해줘", "route": "reuse", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 6074.9827079998795, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:25:02.761613", "user_text": "LAL 최근 5경기 결과 알려줘", "route": "sql_required", "sql": null, "rows": null, "latency_ms": 18005.53516599757, "error": "SQL이 생성되지 않았습니다.", "user_id": "developer"}
{"timestamp": "2026-01-06T11:30:56.110944", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "sql_required", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 27211.098125000717, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:40:35.721702", "user_text": "관중 상위 10개 팀의 시즌 승률을 표로 보여줘", "route": "sql_required", "sql": "WITH top_10_teams AS (\n  SELECT team_abbreviation_home AS team_abbreviation, SUM(attendance) AS total_attendance\n  FROM game_info\n  JOIN game ON game_info.game_id = game.game_id\n  GROUP BY team_abbreviation_home\n  ORDER BY total_attendance DESC\n  LIMIT 10\n),\nteam_stats AS (\n  SELECT\n    team_abbreviation_home AS team_abbreviation,\n    COUNT(*) AS games_played,\n    SUM(CASE WHEN wl_home = 'W' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS win_pct,\n    SUM(pts_home - pts_away) * 1.0 / COUNT(*) AS avg_plus_minus,\n    SUM(fgm_home + 0.5 * fg3m_home) * 1.0 / NULLIF(SUM(fga_home),0) AS efg_pct,\n    (SUM(fgm_home) + 0.44 * SUM(ftm_home)) * 1.0 / NULLIF(SUM(fga_home) + 0.44 * SUM(fta_home),0) AS ts_pct\n  FROM game\n  GROUP BY team_abbreviation_home\n)\nSELECT\n  t.team_abbreviation,\n  s.win_pct,\n  s.avg_plus_minus AS plus_minus,\n  s.ts_pct,\n  s.efg_pct\nFROM top_10_teams t\nJOIN team_stats s ON t.team_abbreviation = s.team_abbreviation\nORDER BY s.win_pct DESC\nLIMIT 10", "rows": 10, "latency_ms": 24651.86308400007, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:41:06.804905", "user_text": "2023-24 시즌 팀 득점 상위 10개 보여줘", "route": "sql_required", "sql": "WITH team_games AS (\n  SELECT season_id, team_abbreviation_home AS team_abbreviation, team_name_home AS team_name, pts_home AS pts\n  FROM game\n  WHERE season_id = '22022' AND season_type = 'Regular Season'\n  UNION ALL\n  SELECT season_id, team_abbreviation_away AS team_abbreviation, team_name_away AS team_name, pts_away AS pts\n  FROM game\n  WHERE season_id = '22022' AND season_type = 'Regular Season'\n)\nSELECT team_name,\n       team_abbreviation,\n       '2022-23' AS season_year,\n       AVG(pts) AS pts_pg\nFROM team_games\nGROUP BY team_abbreviation, team_name\nORDER BY pts_pg DESC\nLIMIT 10", "rows": 10, "latency_ms": 23238.80945899873, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:42:04.927135", "user_text": "관중 수 상위 10개 팀의 2022-23 시즌 승률과 리그 순위를 같이 보여줘", "route": "sql_required", "sql": "WITH step1 AS (\nSELECT g.team_id_home AS team_id, td.abbreviation AS team_abbreviation, AVG(gi.attendance) AS avg_attendance\nFROM game g\nJOIN game_info gi ON g.game_id = gi.game_id\nJOIN team_details td ON td.team_id = g.team_id_home\nWHERE g.season_id = '22022'\nGROUP BY g.team_id_home\nORDER BY avg_attendance DESC\nLIMIT 10\n),\nstep2 AS (\nSELECT tic.team_abbreviation, tic.pct AS win_pct\nFROM team_info_common tic\nWHERE tic.season_year = '2022-23'\nAND tic.team_abbreviation IN (SELECT team_abbreviation FROM step1)\n)\nSELECT step1.team_abbreviation, step1.avg_attendance, COALESCE(step2.win_pct, 0) AS win_pct\nFROM step1\nLEFT JOIN step2 ON step1.team_abbreviation = step2.team_abbreviation\nORDER BY step1.avg_attendance DESC\nLIMIT 10", "rows": 10, "latency_ms": 43519.85929100192, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:48:44.524932", "user_text": "접전 경기(5점 이하) 최근 10개 보여줘", "route": "sql_required", "sql": "SELECT game_id, game_date, team_abbreviation_home, team_abbreviation_away, pts_home, pts_away, ABS(pts_home - pts_away) AS point_diff FROM game WHERE ABS(pts_home - pts_away) <= 5 ORDER BY game_date DESC LIMIT 10", "rows": 10, "latency_ms": 22516.40025000961, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:49:48.421110", "user_text": "접전 경기에서 승리한 팀들의 평균 득점과 실점은 어떻게 되는가?", "route": "sql_required", "sql": "WITH step1 AS (\n  SELECT game_id, team_abbreviation_home AS team_abbreviation, pts_home AS points_scored, pts_away AS points_allowed\n  FROM game\n  WHERE season_id = '22022' AND ABS(pts_home - pts_away) <= 5 AND pts_home > pts_away\n  UNION ALL\n  SELECT game_id, team_abbreviation_away AS team_abbreviation, pts_away AS points_scored, pts_home AS points_allowed\n  FROM game\n  WHERE season_id = '22022' AND ABS(pts_home - pts_away) <= 5 AND pts_away > pts_home\n),\nstep2 AS (\n  SELECT team_abbreviation, AVG(points_scored) AS avg_points_scored, AVG(points_allowed) AS avg_points_allowed\n  FROM step1\n  GROUP BY team_abbreviation\n)\nSELECT step1.team_abbreviation, step2.avg_points_scored, step2.avg_points_allowed\nFROM step1\nLEFT JOIN step2 ON step1.team_abbreviation = step2.team_abbreviation\nGROUP BY step1.team_abbreviation\nORDER BY step2.avg_points_scored DESC\nLIMIT 10", "rows": 10, "latency_ms": 36333.72783300001, "error": null, "user_id": "developer"}
{"timestamp": "2026-01-06T11:50:39.929408", "user_text": "LAL과 BOS 최근 맞대결 5경기 결과 알려줘", "route": "sql_required", "sql": "WITH team_games AS (\n  SELECT game_date, team_abbreviation_home AS team_abbreviation, matchup_home AS matchup, wl_home AS wl,\n         pts_home AS pts, pts_away AS opp_pts\n  FROM game\n  UNION ALL\n  SELECT game_date, team_abbreviation_away AS team_abbreviation, matchup_away AS matchup, wl_away AS wl,\n         pts_away AS pts, pts_home AS opp_pts\n  FROM game\n)\nSELECT *\nFROM team_games\nWHERE team_abbreviation = 'LAL'\nORDER BY game_date DESC\nLIMIT 10", "rows": 10, "latency_ms": 19664.828332999605, "error": null, "user_id": "developer"}
